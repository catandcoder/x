<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>清澄秋爽</title>
  
  <subtitle>苹果树下的思索者 书写是对思维的缓存</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.dashen.tech/"/>
  <updated>2022-06-25T08:58:16.189Z</updated>
  <id>http://www.dashen.tech/</id>
  
  <author>
    <name>fliter</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>time.After和select搭配使用时存在的坑</title>
    <link href="http://www.dashen.tech/2024/12/25/time-After%E5%92%8Cselect%E6%90%AD%E9%85%8D%E4%BD%BF%E7%94%A8%E6%97%B6%E5%AD%98%E5%9C%A8%E7%9A%84%E5%9D%91/"/>
    <id>http://www.dashen.tech/2024/12/25/time-After和select搭配使用时存在的坑/</id>
    <published>2024-12-24T16:15:46.000Z</published>
    <updated>2022-06-25T08:58:16.189Z</updated>
    
    <content type="html"><![CDATA[<p>在<a href="https://dashen.tech/2020/03/15/Golang%E4%B8%ADselect%E7%9A%84%E5%9B%9B%E5%A4%A7%E7%94%A8%E6%B3%95/#%E8%B6%85%E6%97%B6%E6%8E%A7%E5%88%B6" target="_blank" rel="noopener">Golang中select的四大用法/#超时控制</a>中，提到select搭配<code>time.After</code>实现超时控制。其实这样写是有问题的。由于每次都会xxxxx 当等待时间较长，比如1分钟，会发生内存泄露</p><font color="#CD6839"><br><br>不知道是谁带的，在Go中用select和time.After做超时控制，近乎于成了事实上的标准，像下面这样的例子网上比比皆是<br><br><br><a href="https://vimsky.com/examples/usage/time-after-function-in-golang-with-examples.html" target="_blank" rel="noopener">Golang time.After()用法及代码示例</a><br><br>在许多大公司代码仓库里，一搜<code>&lt;- time.After</code>关键字有一大堆，而且后面的时间不少都是几分钟。<br><br>用pprof看下不难发现，这是教科书级的错误…每次都初始化，但执行前不会被回收，造成内存暴涨。<br><br>建议有空去搜下，看看是不是代码里这种用法有一大把…<br><br></font><p><br></p><p>可以参考</p><p><a href="https://xiaorui.cc/archives/5745" target="_blank" rel="noopener">峰云-分析golang time.After引起内存暴增OOM问题</a></p><p><a href="https://segmentfault.com/a/1190000024523708" target="_blank" rel="noopener">慎用time.After会造成内存泄漏（golang）</a></p><p>这几篇分析，实际验证一下</p><p><em>after.go：</em></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">_ <span class="string">"net/http/pprof"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  time.After oom 验证demo</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 开启pprof，监听请求</span></span><br><span class="line"><span class="keyword">if</span> err := http.ListenAndServe(<span class="string">":6060"</span>, <span class="literal">nil</span>); err != <span class="literal">nil</span> &#123; <span class="comment">// 也可以写成 127.0.0.1:6060</span></span><br><span class="line">fmt.Printf(<span class="string">"start pprof failed on %s,err%v \n"</span>, <span class="string">"6060"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>, <span class="number">100</span>)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">ch &lt;- <span class="string">"向管道塞入数据"</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> &lt;-ch:</span><br><span class="line"><span class="keyword">case</span> &lt;-time.After(time.Minute * <span class="number">3</span>):</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行这段程序，然后执行</p><p><code>go tool pprof -http=:8081 http://localhost:6060/debug/pprof/heap</code></p><p><img src="/2024/12/25/time-After和select搭配使用时存在的坑/ time-After和select搭配使用时存在的坑/1.png" width="100%" height="100%"></p><p>这行命令可以分成三部分: </p><ul><li><p><code>-http=:8081</code>是指定以web形式，在本地8081端口启动<br>（如果不加<code>-http=:8081</code>参数，则会进入命令行交互，在命令行中再输入<code>web</code>与直接使用<code>-http=:8081</code>参数效果等效）</p></li><li><p><code>http://localhost:6060/debug/pprof/heap</code> 是指定获取profile文件的地址。本地在实时运行的程序可以用这种方式，更多情况下(如在服务器上，没有对外开放用于pprof的端口)，可以先去机器上，用<code>curl http://127.0.0.1:6060/debug/pprof/heap -o heap_cui.out</code>拿到profile文件，再想办法弄到本地，使用<code>go tool pprof --http :9091 heap_cui.out</code>进行分析</p></li></ul><p><img src="/2024/12/25/time-After和select搭配使用时存在的坑/ time-After和select搭配使用时存在的坑/2.png" width="100%" height="100%"></p><p>而且随着时间推移，程序占用的内存会继续增加</p><p><img src="/2024/12/25/time-After和select搭配使用时存在的坑/ time-After和select搭配使用时存在的坑/3.png" width="100%" height="100%"></p><p>从调用图可发现， 程序不断调用time.After，进而导致计时器 <code>time.NerTimer</code> 不断创建和内存申请</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// After waits for the duration to elapse and then sends the current time</span></span><br><span class="line"><span class="comment">// on the returned channel.</span></span><br><span class="line"><span class="comment">// It is equivalent to NewTimer(d).C.</span></span><br><span class="line"><span class="comment">// The underlying Timer is not recovered by the garbage collector</span></span><br><span class="line"><span class="comment">// until the timer fires. If efficiency is a concern, use NewTimer</span></span><br><span class="line"><span class="comment">// instead and call Timer.Stop if the timer is no longer needed.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//After 等待持续时间过去，然后在返回的通道上发送当前时间。</span></span><br><span class="line"><span class="comment">//它相当于 NewTimer(d).C。</span></span><br><span class="line"><span class="comment">//在定时器触发之前，垃圾收集器不会恢复底层定时器。 如果效率是一个问题，请改用 NewTimer 并在不再需要计时器时调用 Timer.Stop。</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">After</span><span class="params">(d Duration)</span> &lt;-<span class="title">chan</span> <span class="title">Time</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> NewTimer(d).C</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在select里面虽然没有执行到time.After，但每次都会初始化，会在时间堆里面，定时任务未到期之前，是不会被gc清理的</p><ul><li><p>在计时器触发之前，垃圾收集器不会回收Timer</p></li><li><p>如果考虑效率，需要使用NewTimer替代</p></li></ul><p>使用NewTimer 或NewTicker替代：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">_ <span class="string">"net/http/pprof"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  time.After oom 验证demo</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 开启pprof，监听请求</span></span><br><span class="line"><span class="keyword">if</span> err := http.ListenAndServe(<span class="string">":6060"</span>, <span class="literal">nil</span>); err != <span class="literal">nil</span> &#123; <span class="comment">// 也可以写成 127.0.0.1:6060</span></span><br><span class="line">fmt.Printf(<span class="string">"start pprof failed on %s,err%v \n"</span>, <span class="string">"6060"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line">ticker := time.NewTicker(time.Minute * <span class="number">3</span>)</span><br><span class="line">    <span class="comment">// 或</span></span><br><span class="line">    <span class="comment">//timer := time.NewTimer(3 * time.Minute)</span></span><br><span class="line">    <span class="comment">//defer timer.Stop()</span></span><br><span class="line">    <span class="comment">// 下方的case &lt;-ticker.C:相应改为case &lt;-timer.C:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>, <span class="number">100</span>)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">ch &lt;- <span class="string">"向管道塞入数据"</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> &lt;-ch:</span><br><span class="line"><span class="keyword">case</span> &lt;-ticker.C:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"结束执行"</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/12/25/time-After和select搭配使用时存在的坑/ time-After和select搭配使用时存在的坑/4.png" width="100%" height="100%"></p><p>这篇<a href="https://eddycjy.com/posts/go/go-tips-timer-memory/" target="_blank" rel="noopener">Go 内存泄露之痛，这篇把 Go timer.After 问题根因讲透了！</a>应该有点问题，应该不是内存孤儿，gc还是会去回收的，只是要在time.After到期之后</p><p>如上是网上大多数技术文章的情况：</p><ul><li><p>昨夜西风凋碧树，独上高楼，望断天涯路: select + time.After实现超时控制</p></li><li><p>衣带渐宽终不悔，为伊消得人憔悴: 这样写有问题，会内存泄露，要用NewTimer 或NewTicker替代time.After</p></li></ul><p>其实针对本例，这些说法都没有切中肯綮</p><p>上面的代码仅仅是有内存泄露的问题吗？</p><p>实际上，即便3分钟后，第2个case也得不到执行 (可以把3min改成2s验证下)</p><p>只要第一个case能不断从channel中取出数据(在此显然可以)，那第二个case就永远得不到执行。这是因为<strong>每次time.After都被重新初始化了，而上面那个case一直满足条件，当然就是第二个case一直得不到执行的样子</strong>， 除非第一个case超过3min没有从channel中拿到数据</p><p>所以其实在此例中NewTimer还是NewTicker，都不是问题本质，这个问题本质，<strong>就是个变量作用域的问题</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">_ <span class="string">"net/http/pprof"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 开启pprof，监听请求</span></span><br><span class="line"><span class="keyword">if</span> err := http.ListenAndServe(<span class="string">":6060"</span>, <span class="literal">nil</span>); err != <span class="literal">nil</span> &#123; <span class="comment">// 也可以写成 127.0.0.1:6060</span></span><br><span class="line">fmt.Printf(<span class="string">"start pprof failed on %s,err%v \n"</span>, <span class="string">"6060"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>, <span class="number">100</span>)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">ch &lt;- <span class="string">"向管道塞入数据"</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line">timeout := time.After(time.Minute * <span class="number">3</span>)</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> &lt;-ch:</span><br><span class="line"><span class="keyword">case</span> &lt;-timeout:</span><br><span class="line">fmt.Println(<span class="string">"到了这里"</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看下，并没有什么内存泄露，3min(可能多一点点)后，如期执行到了第2个case</p><p><img src="/2024/12/25/time-After和select搭配使用时存在的坑/ time-After和select搭配使用时存在的坑/5.png" width="100%" height="100%"></p><p><br></p><p>所以在这个场景下，并不是time.After <em>在计时器触发之前，垃圾收集器不会回收Timer</em>的问题，而是最起码的最被忽略的变量作用域问题..</p><p><br></p><p>改造一下程序,验证一下,<em>在计时器触发之前，垃圾收集器不会回收Timer</em>,但在<em>计时器触发之前，垃圾收集器会回收这些Timer</em>，并不会造成“内存孤儿”</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">_ <span class="string">"net/http/pprof"</span></span><br><span class="line"><span class="string">"sync/atomic"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 开启pprof，监听请求</span></span><br><span class="line"><span class="keyword">if</span> err := http.ListenAndServe(<span class="string">":6060"</span>, <span class="literal">nil</span>); err != <span class="literal">nil</span> &#123; <span class="comment">// 也可以写成 127.0.0.1:6060</span></span><br><span class="line">fmt.Printf(<span class="string">"start pprof failed on %s,err%v \n"</span>, <span class="string">"6060"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line">after()</span><br><span class="line"></span><br><span class="line">fmt.Println(<span class="string">"程序结束"</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">after</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> i <span class="keyword">int32</span></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>, <span class="number">0</span>)</span><br><span class="line">done := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>) <span class="comment">// 设定的时间已到，通知结束循环，不要再往channel里面写数据</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">atomic.AddInt32(&amp;i, <span class="number">1</span>)</span><br><span class="line">ch &lt;- fmt.Sprintf(<span class="string">"%s%d%s"</span>, <span class="string">"向管道第"</span>, i, <span class="string">"次塞入数据"</span>)</span><br><span class="line"><span class="keyword">case</span> exit := &lt;-done:</span><br><span class="line">fmt.Println(<span class="string">"关闭通道"</span>, exit)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">time.Sleep(time.Second)</span><br><span class="line">done &lt;- <span class="string">"去给我通知不要再往ch这个channel里写数据了！"</span></span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> res := &lt;-ch:</span><br><span class="line">fmt.Println(<span class="string">"res:"</span>, res)</span><br><span class="line"><span class="keyword">case</span> &lt;-time.After(<span class="number">2</span> * time.Second):</span><br><span class="line">fmt.Println(<span class="string">"结束接收通道的数据"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/12/25/time-After和select搭配使用时存在的坑/ time-After和select搭配使用时存在的坑/6.png" width="100%" height="100%"></p><p>去掉打印的信息，替换为当前实时的内存信息：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">_ <span class="string">"net/http/pprof"</span></span><br><span class="line"><span class="string">"runtime"</span></span><br><span class="line"><span class="string">"sync/atomic"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 开启pprof，监听请求</span></span><br><span class="line"><span class="keyword">if</span> err := http.ListenAndServe(<span class="string">":6060"</span>, <span class="literal">nil</span>); err != <span class="literal">nil</span> &#123; <span class="comment">// 也可以写成 127.0.0.1:6060</span></span><br><span class="line">fmt.Printf(<span class="string">"start pprof failed on %s,err%v \n"</span>, <span class="string">"6060"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line">after()</span><br><span class="line"></span><br><span class="line">fmt.Println(<span class="string">"程序结束"</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">after</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> ms runtime.MemStats</span><br><span class="line">runtime.ReadMemStats(&amp;ms)</span><br><span class="line">fmt.Println(<span class="string">"before, have"</span>, runtime.NumGoroutine(), <span class="string">"goroutines,"</span>, ms.Alloc, <span class="string">"bytes allocated"</span>, ms.HeapObjects, <span class="string">"heap object"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> i <span class="keyword">int32</span></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>, <span class="number">0</span>)</span><br><span class="line">done := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>) <span class="comment">// 设定的时间已到，通知结束循环，不要再往channel里面写数据</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">atomic.AddInt32(&amp;i, <span class="number">1</span>)</span><br><span class="line">ch &lt;- fmt.Sprintf(<span class="string">"%s%d%s"</span>, <span class="string">"向管道第"</span>, i, <span class="string">"次塞入数据"</span>)</span><br><span class="line"><span class="keyword">case</span> exit := &lt;-done:</span><br><span class="line">fmt.Println(<span class="string">"关闭通道"</span>, exit)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">time.Sleep(time.Second)</span><br><span class="line">done &lt;- <span class="string">"去给我通知不要再往ch这个channel里写数据了！"</span></span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> res := &lt;-ch:</span><br><span class="line">runtime.GC()</span><br><span class="line">runtime.ReadMemStats(&amp;ms)</span><br><span class="line">fmt.Printf(<span class="string">"%s,now have %d goroutines,%d bytes allocated, %d heap object \n"</span>, res, runtime.NumGoroutine(), ms.Alloc, ms.HeapObjects)</span><br><span class="line"><span class="keyword">case</span> &lt;-time.After(<span class="number">2</span> * time.Second):</span><br><span class="line">runtime.GC()</span><br><span class="line">fmt.Println(<span class="string">"当前结束接收通道的数据，准备返程"</span>)</span><br><span class="line">runtime.ReadMemStats(&amp;ms)</span><br><span class="line">fmt.Printf(<span class="string">"now have %d goroutines,%d bytes allocated, %d heap object \n"</span>, runtime.NumGoroutine(), ms.Alloc, ms.HeapObjects)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/12/25/time-After和select搭配使用时存在的坑/ time-After和select搭配使用时存在的坑/7.png" width="100%" height="100%"></p><hr><p><br></p><p>更多参考：</p><p><a href="https://dashen.tech/2012/11/17/Go-time-NewTicker-%E4%B8%8E%E5%AE%9A%E6%97%B6%E5%99%A8/" target="_blank" rel="noopener">Go time.NewTicker()与定时器</a></p><p><a href>tech-talk-time.After不断初始化的</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在&lt;a href=&quot;https://dashen.tech/2020/03/15/Golang%E4%B8%ADselect%E7%9A%84%E5%9B%9B%E5%A4%A7%E7%94%A8%E6%B3%95/#%E8%B6%85%E6%97%B6%E6%8E%A7%
      
    
    </summary>
    
    
      <category term="Go" scheme="http://www.dashen.tech/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>使用govaluate库进行逻辑判断</title>
    <link href="http://www.dashen.tech/2022/03/13/%E4%BD%BF%E7%94%A8govaluate%E5%BA%93%E8%BF%9B%E8%A1%8C%E9%80%BB%E8%BE%91%E5%88%A4%E6%96%AD/"/>
    <id>http://www.dashen.tech/2022/03/13/使用govaluate库进行逻辑判断/</id>
    <published>2022-03-13T13:19:49.000Z</published>
    <updated>2022-04-07T03:21:20.875Z</updated>
    
    <content type="html"><![CDATA[<p>了解了下go生态内的表达式计算库，<a href="https://github.com/Knetic/govaluate" target="_blank" rel="noopener">govaluate</a>评价比较高，目前github有2300多个star</p><p>用这个库，比较容易解决某些场景下复杂规则计算的需求  </p><p>相关使用参考<a href="https://zhuanlan.zhihu.com/p/122561534" target="_blank" rel="noopener">Go 每日一库之 govaluate</a>，以下是对该篇内容的实践与记录</p><p><br></p><h3 id="demo1–基础款"><a href="#demo1–基础款" class="headerlink" title="demo1–基础款"></a>demo1–基础款</h3><p><br></p><p>使用govaluate计算表达式只需要两步：</p><p>调用NewEvaluableExpression()将表达式转为一个表达式对象(一个EvaluableExpression类型的结构体)；</p><p>调用表达式对象的Evaluate方法，传入参数，返回表达式的值。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"github.com/Knetic/govaluate"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">expr, err := govaluate.NewEvaluableExpression(<span class="string">"10 &gt;= 0"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"syntax error:"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">result, err := expr.Evaluate(<span class="literal">nil</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"evaluate error:"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">true</span></span><br></pre></td></tr></table></figure><p>使用govaluate计算<code>10 &gt;= 0</code>的值，该表达式不需要参数，所以传给<strong>Evaluate()</strong>方法nil值。</p><p>当然这个例子并不实用。但有时并不知道需要计算的表达式的所有信息，甚至都不知道表达式的结构，这时govaluate的作用就体现出来了。</p><p><br></p><p>如果govaluate.NewEvaluableExpression()的表达式是不合法的，则err将不为nil，</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"github.com/Knetic/govaluate"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果NewEvaluableExpression中的参数不是合法的逻辑表达式，则err会报  Invalid token: '!&gt;='</span></span><br><span class="line">expr, err := govaluate.NewEvaluableExpression(<span class="string">"10 !&gt;= 0"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"syntax error:"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同时expr为nil</span></span><br><span class="line">fmt.Println(<span class="string">"expr is："</span>, expr)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 此时需做return之类的判断。继续往下执行,调用为nil的expr的Evaluate，自然会panic: runtime error: invalid memory address or nil pointer dereference</span></span><br><span class="line"></span><br><span class="line">result, err := expr.Evaluate(<span class="literal">nil</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"evaluate error:"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">syntax error: Invalid token: <span class="string">'!&gt;='</span></span><br><span class="line">expr is： &lt;<span class="literal">nil</span>&gt;</span><br><span class="line"><span class="built_in">panic</span>: runtime error: invalid memory address or <span class="literal">nil</span> pointer dereference</span><br><span class="line">[signal SIGSEGV: segmentation violation code=<span class="number">0x2</span> addr=<span class="number">0x0</span> pc=<span class="number">0x104d463f0</span>]</span><br><span class="line"></span><br><span class="line">goroutine <span class="number">1</span> [running]:</span><br><span class="line">main.main()</span><br><span class="line">        /Users/fliter/<span class="keyword">go</span>/src/shuang/govaluatee/a.<span class="keyword">go</span>:<span class="number">17</span> +<span class="number">0x160</span></span><br><span class="line">exit status <span class="number">2</span></span><br></pre></td></tr></table></figure><p><br></p><h3 id="demo2–带参数"><a href="#demo2–带参数" class="headerlink" title="demo2–带参数"></a>demo2–带参数</h3><p><br></p><p>支持在表达式中使用参数，调用表达式对象的<code>Evaluate()方法</code>时通过<strong>map[string]interface{}类型</strong>将参数传入运算。</p><p>其中map的键为参数名，值为参数值</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"github.com/Knetic/govaluate"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 省略了err的判断，正常情况需要有，否则可能panic</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">expr, _ := govaluate.NewEvaluableExpression(<span class="string">"foo &gt; 0"</span>)</span><br><span class="line">parameters := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">parameters[<span class="string">"foo"</span>] = <span class="number">-1</span></span><br><span class="line">result, _ := expr.Evaluate(parameters) <span class="comment">// 即 -1 &gt; 0</span></span><br><span class="line">fmt.Println(result) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">expr, _ = govaluate.NewEvaluableExpression(<span class="string">"(requests_made * requests_succeeded / 100) &gt;= 90"</span>)</span><br><span class="line">parameters = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">parameters[<span class="string">"requests_made"</span>] = <span class="number">100</span></span><br><span class="line">parameters[<span class="string">"requests_succeeded"</span>] = <span class="number">80</span></span><br><span class="line">result, _ = expr.Evaluate(parameters) <span class="comment">// 即 80 &gt;= 90</span></span><br><span class="line">fmt.Println(result) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">expr, _ = govaluate.NewEvaluableExpression(<span class="string">"(mem_used / total_mem) * 100"</span>)</span><br><span class="line">parameters = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">parameters[<span class="string">"total_mem"</span>] = <span class="number">1024</span></span><br><span class="line">parameters[<span class="string">"mem_used"</span>] = <span class="number">512</span></span><br><span class="line">result, _ = expr.Evaluate(parameters) <span class="comment">// 即 512/1024 * 100</span></span><br><span class="line">fmt.Println(result) <span class="comment">// 50</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">false</span></span><br><span class="line"><span class="literal">false</span></span><br><span class="line"><span class="number">50</span></span><br></pre></td></tr></table></figure><p><br></p><hr><p><br></p><h3 id="demo3–特殊标识符的处理"><a href="#demo3–特殊标识符的处理" class="headerlink" title="demo3–特殊标识符的处理"></a>demo3–特殊标识符的处理</h3><p><br></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"github.com/Knetic/govaluate"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// demo省略了err的判断，正常情况需要有，否则可能panic</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">expr, err1 := govaluate.NewEvaluableExpression(<span class="string">"response-time &lt; 100"</span>)</span><br><span class="line"><span class="keyword">if</span> err1 != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"err1 is:"</span>, err1)</span><br><span class="line">&#125;</span><br><span class="line">parameters := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">parameters[<span class="string">"response-time"</span>] = <span class="number">80</span></span><br><span class="line"></span><br><span class="line">result, err2 := expr.Evaluate(parameters) </span><br><span class="line"><span class="keyword">if</span> err2 != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"err2 is:"</span>, err2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(result)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">err2 is: No parameter <span class="string">'response'</span> found.</span><br><span class="line">&lt;<span class="literal">nil</span>&gt;</span><br></pre></td></tr></table></figure><p>如果NewEvaluableExpression()中的表达式是如同<code>a+b&gt;100</code>,或<code>x-y&lt;50</code>等情况，又想将<code>a+b</code>作为一个整体参数，通过parameters一次性传入，因为Go 代码中标识符中不能出现<code>-、+、$</code>等符号,故而需要转义处理。</p><p>主要方式有两种：</p><ul><li>将名称用[和]包裹起来，例如[response-time]；</li><li>使用\将紧接着下一个的字符转义。</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"github.com/Knetic/govaluate"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// demo省略了err的判断，正常情况需要有，否则可能panic</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">expr, _ := govaluate.NewEvaluableExpression(<span class="string">"[response-time] &lt; 100"</span>)</span><br><span class="line">parameters := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">parameters[<span class="string">"response-time"</span>] = <span class="number">80</span></span><br><span class="line">result, _ := expr.Evaluate(parameters) <span class="comment">// 80 &lt; 100</span></span><br><span class="line">fmt.Println(result) <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//因为在字符串中\本身就需要转义，所以表达式中要使用\\。或可使用`response\-time` &lt; 100</span></span><br><span class="line"></span><br><span class="line">expr, _ = govaluate.NewEvaluableExpression(<span class="string">"response\\-time &lt; 100"</span>)</span><br><span class="line">parameters = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">parameters[<span class="string">"response-time"</span>] = <span class="number">80</span></span><br><span class="line">result, _ = expr.Evaluate(parameters)</span><br><span class="line">fmt.Println(result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">true</span></span><br><span class="line"><span class="literal">true</span></span><br></pre></td></tr></table></figure><p><br></p><p>而如果将response和time作为两个参数，则无需做处理,如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"github.com/Knetic/govaluate"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// demo省略了err的判断，正常情况需要有，否则可能panic</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">expr, err1 := govaluate.NewEvaluableExpression(<span class="string">"response-time &lt; 100"</span>)</span><br><span class="line"><span class="keyword">if</span> err1 != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"err1 is:"</span>, err1)</span><br><span class="line">&#125;</span><br><span class="line">parameters := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line"><span class="comment">//parameters["response-time"] = 80</span></span><br><span class="line">parameters[<span class="string">"response"</span>] = <span class="number">80</span></span><br><span class="line">parameters[<span class="string">"time"</span>] = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">result, err2 := expr.Evaluate(parameters)</span><br><span class="line"><span class="keyword">if</span> err2 != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"err2 is:"</span>, err2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(result)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">true</span></span><br></pre></td></tr></table></figure><p><br></p><hr><h3 id="demo4–一次“编译”，多次运行"><a href="#demo4–一次“编译”，多次运行" class="headerlink" title="demo4–一次“编译”，多次运行"></a>demo4–一次“编译”，多次运行</h3><p><br></p><p>使用带参数的表达式，可实现一个表达式的一次“编译”，多次运行。只需要调用编译返回的表达式对象的Evaluate()方法即可</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"github.com/Knetic/govaluate"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">expr, _ := govaluate.NewEvaluableExpression(<span class="string">"a + b"</span>)</span><br><span class="line">parameters := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">parameters[<span class="string">"a"</span>] = <span class="number">1</span></span><br><span class="line">parameters[<span class="string">"b"</span>] = <span class="number">2</span></span><br><span class="line">result, _ := expr.Evaluate(parameters)</span><br><span class="line">fmt.Println(result)</span><br><span class="line"></span><br><span class="line">parameters = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">parameters[<span class="string">"a"</span>] = <span class="number">10</span></span><br><span class="line">parameters[<span class="string">"b"</span>] = <span class="number">20</span></span><br><span class="line">result, _ = expr.Evaluate(parameters)</span><br><span class="line">fmt.Println(result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">30</span></span><br></pre></td></tr></table></figure><p><br></p><hr><h3 id="demo5–使用-自定义函数"><a href="#demo5–使用-自定义函数" class="headerlink" title="demo5–使用 自定义函数"></a>demo5–使用 自定义函数</h3><p><br></p><p>如果仅仅只能进行常规的算数和逻辑运算，govaluate的功能则会大打折扣。govaluate还提供了强大的自定义函数功能</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"github.com/Knetic/govaluate"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 所有自定义函数需要预先定义好，存入一个map[string]govaluate.ExpressionFunction变量中，</span></span><br><span class="line">functions := <span class="keyword">map</span>[<span class="keyword">string</span>]govaluate.ExpressionFunction&#123;</span><br><span class="line"><span class="string">"strlen"</span>: <span class="function"><span class="keyword">func</span><span class="params">(args ...<span class="keyword">interface</span>&#123;&#125;)</span> <span class="params">(<span class="keyword">interface</span>&#123;&#125;, error)</span></span> &#123;</span><br><span class="line">length := <span class="built_in">len</span>(args[<span class="number">0</span>].(<span class="keyword">string</span>))</span><br><span class="line"><span class="keyword">return</span> length, <span class="literal">nil</span></span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">exprString := <span class="string">"strlen('shuang_length')"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 然后调用govaluate.NewEvaluableExpressionWithFunctions()生成表达式，在表达式中就可以使用该函数了</span></span><br><span class="line">expr, _ := govaluate.NewEvaluableExpressionWithFunctions(exprString, functions)</span><br><span class="line">result, _ := expr.Evaluate(<span class="literal">nil</span>)</span><br><span class="line">fmt.Println(result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">13</span></span><br></pre></td></tr></table></figure><p><br></p><p>函数可以接受任意数量的参数，且可处理嵌套函数调用的问题。所以能写出类似下面这种复杂的表达式：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqrt(x1 ** y1, x2 ** y2)</span><br><span class="line"></span><br><span class="line">max(someValue, abs(anotherValue), <span class="number">10</span> * lastValue)</span><br></pre></td></tr></table></figure><p><br></p><hr><p><br></p><h3 id="demo6–访问器"><a href="#demo6–访问器" class="headerlink" title="demo6–访问器"></a>demo6–访问器</h3><p><br></p><p>处理结构体时，一般用不到</p><p><br></p><hr><p><br></p><h3 id="demo7–支持的操作和类型"><a href="#demo7–支持的操作和类型" class="headerlink" title="demo7–支持的操作和类型"></a>demo7–支持的操作和类型</h3><p><br></p><p>govaluate支持的操作和类型与 Go 语言有些不同：一方面govaluate中的类型和操作不如 Go 丰富，另一方面govaluate也对一些操作进行了扩展。</p><h4 id="算数、比较和逻辑运算："><a href="#算数、比较和逻辑运算：" class="headerlink" title="算数、比较和逻辑运算："></a>算数、比较和逻辑运算：</h4><ul><li><p><code>+</code> <code>-</code> <code>*</code> <code>/</code> <code>&amp;</code> <code>|</code> <code>^</code> <code>**</code> <code>%</code> <code>&gt;&gt;</code> <code>&lt;&lt;</code>   ：加减乘除，按位与，按位或，异或，乘方，取模，左移和右移；</p></li><li><p><code>&gt;</code> <code>&gt;=</code> <code>&lt;</code> <code>&lt;</code> <code>==</code> <code>=!</code> <code>==~</code> <code>!~</code>,其中<code>=~</code>为正则匹配，<code>!~</code>为正则不匹配；</p></li><li><p><code>||</code> <code>&amp;&amp;</code>：逻辑或和逻辑与。</p></li><li></li></ul><h4 id="常量："><a href="#常量：" class="headerlink" title="常量："></a>常量：</h4><ul><li>数字常量，govaluate中将数字都作为 64 位浮点数处理；</li><li>字符串常量，注意在govaluate中，字符串用单引号’；</li><li>日期时间常量，格式与字符串相同，govaluate会尝试自动解析字符串是否是日期，只支持 RFC3339、ISO8601等有限的格式；</li><li>布尔常量：true、false。</li></ul><h4 id="其他："><a href="#其他：" class="headerlink" title="其他："></a>其他：</h4><ul><li>圆括号可以改变计算优先级；</li><li>数组定义在()中，每个元素之间用,分隔，可以支持任意的元素类型，如(1, 2, ‘foo’)。实际上在govaluate中数组是用[]interface{}来表示的；</li><li>三目运算符：? :</li></ul><p><br></p><p>在下面代码中，govaluate会先将2014-01-02和2014-01-01 23:59:59转为time.Time类型，然后再比较大小：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"github.com/Knetic/govaluate"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">expr, _ := govaluate.NewEvaluableExpression(<span class="string">"'2014-01-02' &gt; '2014-01-01 23:59:59'"</span>)</span><br><span class="line">result, _ := expr.Evaluate(<span class="literal">nil</span>)</span><br><span class="line">fmt.Println(result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">true</span></span><br></pre></td></tr></table></figure><p><br></p><hr><p><br></p><h3 id="demo8–错误处理"><a href="#demo8–错误处理" class="headerlink" title="demo8–错误处理"></a>demo8–错误处理</h3><p><br></p><p>在创建表达式对象和表达式求值这两个操作中都可能产生错误:在生成表达式对象时，如果表达式有语法错误，则返回错误;表达式求值时，如果传入的参数不合法，或者某些参数缺失，或者访问结构体中不存在的字段都会报错。</p><p><br></p><p><a href="https://github.com/cuishuang/shuang/tree/master/govaluatee" target="_blank" rel="noopener">demo部分代码</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;了解了下go生态内的表达式计算库，&lt;a href=&quot;https://github.com/Knetic/govaluate&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;govaluate&lt;/a&gt;评价比较高，目前github有2300多个star&lt;/p&gt;

      
    
    </summary>
    
    
      <category term="Go" scheme="http://www.dashen.tech/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>向前兼容与向后兼容</title>
    <link href="http://www.dashen.tech/2022/02/03/%E5%90%91%E5%89%8D%E5%85%BC%E5%AE%B9%E4%B8%8E%E5%90%91%E5%90%8E%E5%85%BC%E5%AE%B9/"/>
    <id>http://www.dashen.tech/2022/02/03/向前兼容与向后兼容/</id>
    <published>2022-02-03T12:26:46.000Z</published>
    <updated>2022-02-10T13:00:13.000Z</updated>
    
    <content type="html"><![CDATA[<p>2012年3月发布了Go 1.0,随着 Go 第一个版本发布的还有一份兼容性说明文档。该文档说明，Go 的未来版本会确保<strong>向后兼容性</strong>，不会破坏现有程序。</p><p>即用10年前Go 1.0写的代码，用10年后的Go 1.18版本，依然可以正常运行。即<em>较高版本的程序能正常处理较低版本程序的数据(代码)</em></p><p>反之则不然，如之前遇到过的<a href="https://dashen.tech/2021/05/30/gvm-%E7%81%B5%E6%B4%BB%E7%9A%84Go%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/#%E7%BC%98%E8%B5%B7" target="_blank" rel="noopener">这个问题</a>：在Mac上用<em>Go 1.16</em>可正常编译&amp;运行的代码，在cvm服务器上Go 1.11版本，则编译不通过；</p><p>再如<a href="https://dashen.tech/2022/02/01/%E9%83%A8%E7%BD%B2Spring-Boot%E9%A1%B9%E7%9B%AE/" target="_blank" rel="noopener">部署Spring Boot项目</a>时遇到的，在Mac上用Java 17开发并打的jar包，在cvm服务器上，用Java 8运行会报错</p><p><br></p><p>一般会认为向前兼容是向之前的版本兼容，这理解其实是错误的。</p><p>注意要把「前」「后」分别理解成「前进」和「后退」，不可以理解成「从前」和「以后」</p><p>线上项目开发中，向后(后退)兼容非常重要; 向后兼容就是新版本的Go/Java，可以保证之前用老版本写的程序依然可以正常使用</p><p><br></p><p>前 forward 未来拓展。</p><p>后 backward 兼容以前。</p><p><br></p><ul><li><p>向前兼容（Forward Compatibility）：指老版本的软／硬件可以使用或运行新版本的软／硬件产生的数据。“Forward”一词在这里有“未来”的意思，其实翻译成“向未来”更明确一些，汉语中“向前”是指“从前”还是“之后”是有歧义的。是旧版本对新版本的兼容 （即向前 到底是<em>以前</em>还是<em>前面</em>？实际是<em>前面</em>）</p></li><li><p>向上兼容（Upward Compatibility）：与向前兼容相同。</p></li></ul><p><br></p><ul><li><p>向后兼容（Backward Compatibility）：指新的版本的软／硬件可以使用或运行老版本的软／硬件产生的数据。是新版本对旧版本的兼容</p></li><li><p>向下兼容（Downward Compatibility）：与向后兼容相同。</p></li></ul><p><br></p><p><img src="/2022/02/03/向前兼容与向后兼容/0.png" width="80%" height="100%"></p><p><br></p><p><a href="https://www.zhihu.com/question/47239021" target="_blank" rel="noopener">软件的「向前兼容」和「向后兼容」如何区分？</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;2012年3月发布了Go 1.0,随着 Go 第一个版本发布的还有一份兼容性说明文档。该文档说明，Go 的未来版本会确保&lt;strong&gt;向后兼容性&lt;/strong&gt;，不会破坏现有程序。&lt;/p&gt;
&lt;p&gt;即用10年前Go 1.0写的代码，用10年后的Go 1.18版本，依然可以
      
    
    </summary>
    
    
      <category term="杂谈" scheme="http://www.dashen.tech/tags/%E6%9D%82%E8%B0%88/"/>
    
  </entry>
  
  <entry>
    <title>部署Spring Boot项目</title>
    <link href="http://www.dashen.tech/2022/02/01/%E9%83%A8%E7%BD%B2Spring-Boot%E9%A1%B9%E7%9B%AE/"/>
    <id>http://www.dashen.tech/2022/02/01/部署Spring-Boot项目/</id>
    <published>2022-02-01T15:43:05.000Z</published>
    <updated>2022-02-10T12:18:03.000Z</updated>
    
    <content type="html"><![CDATA[<h4 id="上传jar包"><a href="#上传jar包" class="headerlink" title="上传jar包 "></a><font color="orange">上传jar包 </font></h4><p><br></p><p>之前在<a href="https://dashen.tech/2022/02/01/%E6%96%B0%E5%BB%BASpring-Boot%E9%A1%B9%E7%9B%AE/" target="_blank" rel="noopener">新建Spring Boot项目</a>使用<code>mvn install</code>的方式，已经构建出jar包。</p><p>通过scp或rz/sz，将该jar包上传到服务器</p><p><img src="/2022/02/01/部署Spring-Boot项目/0.png" width="80%" height="100%"></p><p><br></p><p>执行<code>java -jar hello-0.0.1-SNAPSHOT.jar</code>,发生如下报错：</p><p><img src="/2022/02/01/部署Spring-Boot项目/1.png" width="80%" height="100%"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread <span class="string">"main"</span> java.lang.UnsupportedClassVersionError: tech/dashen/hello/<span class="function">HelloApplication has been compiled by a more recent version of the Java <span class="title">Runtime</span> <span class="params">(class file version <span class="number">55.0</span>)</span>, <span class="keyword">this</span> version of the Java Runtime only recognizes class file versions up to 52.0</span></span><br><span class="line"><span class="function">at java.lang.ClassLoader.<span class="title">defineClass1</span><span class="params">(Native Method)</span></span></span><br><span class="line"><span class="function">at java.lang.ClassLoader.<span class="title">defineClass</span><span class="params">(ClassLoader.java:<span class="number">763</span>)</span></span></span><br><span class="line"><span class="function">at java.security.SecureClassLoader.<span class="title">defineClass</span><span class="params">(SecureClassLoader.java:<span class="number">142</span>)</span></span></span><br><span class="line"><span class="function">at java.net.URLClassLoader.<span class="title">defineClass</span><span class="params">(URLClassLoader.java:<span class="number">468</span>)</span></span></span><br><span class="line"><span class="function">at java.net.URLClassLoader.access$100<span class="params">(URLClassLoader.java:<span class="number">74</span>)</span></span></span><br><span class="line"><span class="function">at java.net.URLClassLoader$1.<span class="title">run</span><span class="params">(URLClassLoader.java:<span class="number">369</span>)</span></span></span><br><span class="line"><span class="function">at java.net.URLClassLoader$1.<span class="title">run</span><span class="params">(URLClassLoader.java:<span class="number">363</span>)</span></span></span><br><span class="line"><span class="function">at java.security.AccessController.<span class="title">doPrivileged</span><span class="params">(Native Method)</span></span></span><br><span class="line"><span class="function">at java.net.URLClassLoader.<span class="title">findClass</span><span class="params">(URLClassLoader.java:<span class="number">362</span>)</span></span></span><br><span class="line"><span class="function">at java.lang.ClassLoader.<span class="title">loadClass</span><span class="params">(ClassLoader.java:<span class="number">424</span>)</span></span></span><br><span class="line"><span class="function">at org.springframework.boot.loader.LaunchedURLClassLoader.<span class="title">loadClass</span><span class="params">(LaunchedURLClassLoader.java:<span class="number">151</span>)</span></span></span><br><span class="line"><span class="function">at java.lang.ClassLoader.<span class="title">loadClass</span><span class="params">(ClassLoader.java:<span class="number">357</span>)</span></span></span><br><span class="line"><span class="function">at java.lang.Class.<span class="title">forName0</span><span class="params">(Native Method)</span></span></span><br><span class="line"><span class="function">at java.lang.Class.<span class="title">forName</span><span class="params">(Class.java:<span class="number">348</span>)</span></span></span><br><span class="line"><span class="function">at org.springframework.boot.loader.MainMethodRunner.<span class="title">run</span><span class="params">(MainMethodRunner.java:<span class="number">46</span>)</span></span></span><br><span class="line"><span class="function">at org.springframework.boot.loader.Launcher.<span class="title">launch</span><span class="params">(Launcher.java:<span class="number">108</span>)</span></span></span><br><span class="line"><span class="function">at org.springframework.boot.loader.Launcher.<span class="title">launch</span><span class="params">(Launcher.java:<span class="number">58</span>)</span></span></span><br><span class="line"><span class="function">at org.springframework.boot.loader.JarLauncher.<span class="title">main</span><span class="params">(JarLauncher.java:<span class="number">88</span>)</span></span></span><br></pre></td></tr></table></figure><p><br></p><p>这是由于<strong>编译环境</strong>与<strong>运行环境</strong>不一致导致:</p><p>本机执行 java -version</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openjdk version <span class="string">"17.0.2"</span> <span class="number">2022</span>-<span class="number">01</span>-<span class="number">18</span></span><br><span class="line"><span class="function">OpenJDK Runtime <span class="title">Environment</span> <span class="params">(build <span class="number">17.0</span><span class="number">.2</span>+<span class="number">8</span><span class="number">-86</span>)</span></span></span><br><span class="line"><span class="function">OpenJDK 64-Bit Server <span class="title">VM</span> <span class="params">(build <span class="number">17.0</span><span class="number">.2</span>+<span class="number">8</span><span class="number">-86</span>, mixed mode, sharing)</span></span></span><br></pre></td></tr></table></figure><p>服务器上执行 java -version</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java version <span class="string">"1.8.0_211"</span></span><br><span class="line">Java(TM) <span class="function">SE Runtime <span class="title">Environment</span> <span class="params">(build <span class="number">1.8</span><span class="number">.0</span>_211-b12)</span></span></span><br><span class="line"><span class="function">Java <span class="title">HotSpot</span><span class="params">(TM)</span> 64-Bit Server <span class="title">VM</span> <span class="params">(build <span class="number">25.211</span>-b12, mixed mode)</span></span></span><br></pre></td></tr></table></figure><p><br></p><h4 id="服务器-安装-更新Java版本"><a href="#服务器-安装-更新Java版本" class="headerlink" title="服务器 安装/更新Java版本 "></a><font color="orange">服务器 安装/更新Java版本 </font></h4><p><br></p><p>通过<code>cat .bashrc</code>查看之前Java的配置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">java</span></span><br><span class="line">export JAVA_HOME=/usr/local/java/jdk1.8.0_211</span><br><span class="line">export JRE_HOME=$&#123;JAVA_HOME&#125;/jre</span><br><span class="line">export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib</span><br><span class="line">export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH</span><br></pre></td></tr></table></figure><p>切换到<code>/usr/local/java</code>下：</p><p><img src="/2022/02/01/部署Spring-Boot项目/old.png" width="80%" height="100%"></p><p>可发现之前是使用直接下载&amp;编译的方式安装</p><p>决定这次依然不使用apt-get的方式。  </p><p>在 <a href="https://www.oracle.com/java/technologies/downloads/#jdk17-linux" target="_blank" rel="noopener">此处</a> 找到对应平台的Java 17，复制下载地址</p><p><img src="/2022/02/01/部署Spring-Boot项目/download.png" width="80%" height="100%"></p><p>使用<code>wget + 下载地址</code>下载到当前目录，</p><p><img src="/2022/02/01/部署Spring-Boot项目/wget.png" width="80%" height="100%"></p><p><code>sudo tar -zxvf jdk-17_linux-x64_bin.tar.gz</code>,解压出<code>jdk-17.0.2</code>文件夹</p><p><br></p><p>修改<code>.bashrc</code>中Java的路径：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">java</span></span><br><span class="line">export JAVA_HOME=/usr/local/java/jdk-17.0.2</span><br><span class="line">export JRE_HOME=$&#123;JAVA_HOME&#125;/jre</span><br><span class="line">export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib</span><br><span class="line">export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH</span><br></pre></td></tr></table></figure><p><img src="/2022/02/01/部署Spring-Boot项目/ok.png" width="80%" height="100%"></p><p><br></p><p>再去之前的目录下执行<code>java -jar hello-0.0.1-SNAPSHOT.jar</code>命令</p><p><img src="/2022/02/01/部署Spring-Boot项目/2.png" width="80%" height="100%"></p><p><br></p><p><img src="/2022/02/01/部署Spring-Boot项目/3.png" width="80%" height="100%"></p><p><br></p><p>可参考<a href="https://blog.csdn.net/qq_22638399/article/details/81506448" target="_blank" rel="noopener">此</a>，<code>nohup java -jar hello-0.0.1-SNAPSHOT.jar &gt;temp.txt &amp;</code>,让进程在后台运行。并会把日志文件输入到指定的temp.txt中</p><p><br></p><h4 id="服务器-放开8080端口"><a href="#服务器-放开8080端口" class="headerlink" title="服务器 放开8080端口 "></a><font color="orange">服务器 放开8080端口 </font></h4><p><br></p><p>参考<a href="https://www.txyfwq.com/anquanzu/8080duankou.html" target="_blank" rel="noopener">腾讯云服务器安全组设置开放8080端口</a>：</p><p><img src="/2022/02/01/部署Spring-Boot项目/4.png" width="80%" height="100%"></p><p><br></p><p>再请求服务器公网ip:8080/cui,如预期</p><p><img src="/2022/02/01/部署Spring-Boot项目/5.png" width="80%" height="100%"></p><p><br></p><hr><p><br></p><h4 id="关于Java的版本"><a href="#关于Java的版本" class="headerlink" title="关于Java的版本 "></a><font color="orange">关于Java的版本 </font></h4><p><br></p><p>依据 <a href="https://blog.csdn.net/qq_44895681/article/details/105365655" target="_blank" rel="noopener">一文搞懂JDK8与Java1.8的区别</a>,</p><p>从JDK1.5/JDK5开始，命名方式由之前的1.x，改成了x</p><p>故而DK1.8/JDK8是新旧命令方式导致的同一个东西的不同称谓。</p><p>即  <strong>Java8、JDK8、JDK1.8都是同一个东西</strong></p><p><img src="/2022/02/01/部署Spring-Boot项目/history.png" width="80%" height="100%"></p><p><br></p><p>当前最新的版本是 Java 17</p><p><a href="https://zh.wikipedia.org/wiki/Java%E7%89%88%E6%9C%AC%E6%AD%B7%E5%8F%B2" target="_blank" rel="noopener">Java版本历史</a></p><p><img src="/2022/02/01/部署Spring-Boot项目/new.png" width="80%" height="100%"></p><p><br></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;上传jar包&quot;&gt;&lt;a href=&quot;#上传jar包&quot; class=&quot;headerlink&quot; title=&quot;上传jar包 &quot;&gt;&lt;/a&gt;&lt;font color=&quot;orange&quot;&gt;上传jar包 &lt;/font&gt;&lt;/h4&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;之前在&lt;a href=&quot;
      
    
    </summary>
    
    
      <category term="Java" scheme="http://www.dashen.tech/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>新建Spring Boot项目</title>
    <link href="http://www.dashen.tech/2022/02/01/%E6%96%B0%E5%BB%BASpring-Boot%E9%A1%B9%E7%9B%AE/"/>
    <id>http://www.dashen.tech/2022/02/01/新建Spring-Boot项目/</id>
    <published>2022-02-01T14:33:38.000Z</published>
    <updated>2022-02-10T11:41:17.000Z</updated>
    
    <content type="html"><![CDATA[<p>使用IDEA 来创建:</p><p><br></p><h4 id="文件-新建-项目"><a href="#文件-新建-项目" class="headerlink" title=" 文件-新建-项目 "></a><font color="orange"> 文件-新建-项目 </font></h4><p><br></p><p><img src="/2022/02/01/新建Spring-Boot项目/0.png" width="80%" height="100%"></p><p>填写项目元数据</p><p><br></p><h4 id="选择依赖项"><a href="#选择依赖项" class="headerlink" title=" 选择依赖项 "></a><font color="orange"> 选择依赖项 </font></h4><p><br></p><p><img src="/2022/02/01/新建Spring-Boot项目/1.png" width="80%" height="100%"></p><p><br></p><p>此处可以先选 <em>web-spring web</em></p><p><br></p><p>关于这些依赖项，更多可参考：<br><a href="https://blog.csdn.net/gooku1314/article/details/102545490" target="_blank" rel="noopener">IDEA创建Spring boot项目时各依赖的说明（Developer Tools篇）</a></p><p><br></p><h4 id="项目结构介绍"><a href="#项目结构介绍" class="headerlink" title=" 项目结构介绍 "></a><font color="orange"> 项目结构介绍 </font></h4><p><br></p><p><img src="/2022/02/01/新建Spring-Boot项目/2.png" width="80%" height="100%"></p><p><br></p><p>展开项目，此时会有一个以 <strong>项目名+Application</strong> 命名的java类，里面有main方法，这就是程序入口，run它就类似启动tomcat，表示项目启动了；</p><p><img src="/2022/02/01/新建Spring-Boot项目/4.png" width="80%" height="100%"></p><p>同时在<em>resource</em>目录下有个<strong>application.properties</strong>，这里存放配置文件，spring-boot启动时会来加载该文件</p><p><img src="/2022/02/01/新建Spring-Boot项目/6.png" width="80%" height="100%"></p><p><br></p><h4 id="新建ShuangController类-并运行"><a href="#新建ShuangController类-并运行" class="headerlink" title=" 新建ShuangController类 并运行 "></a><font color="orange"> 新建ShuangController类 并运行 </font></h4><p><br></p><p><img src="/2022/02/01/新建Spring-Boot项目/3.png" width="80%" height="100%"></p><p><br></p><p>新建ShuangController类，代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tech.dashen.hello;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShuangController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"cui"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">shuangSpringBoot</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"fliter use springboot"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p><p>访问 <a href="http://127.0.0.1:8080/cui" target="_blank" rel="noopener">http://127.0.0.1:8080/cui</a>，可见到如下输出：</p><p><img src="/2022/02/01/新建Spring-Boot项目/5.png" width="80%" height="100%"></p><p><br></p><h4 id="更多运行方式"><a href="#更多运行方式" class="headerlink" title=" 更多运行方式 "></a><font color="orange"> 更多运行方式 </font></h4><p><br></p><p>除去IDE的run，还可以在项目根目录下执行 <code>mvn spring-boot:run</code></p><p><img src="/2022/02/01/新建Spring-Boot项目/7.png" width="80%" height="100%"></p><p><br></p><p>或通过mvn install 生成jar后运行：</p><p>在项目根目录下执行<code>mvn install</code>,</p><p>之后会在<em>target</em>文件夹下生成一个新的<code>hello-0.0.1-SNAPSHOT.jar</code>包，</p><p>执行<code>java -jar hello-0.0.1-SNAPSHOT.jar</code></p><p><img src="/2022/02/01/新建Spring-Boot项目/8.png" width="80%" height="100%"></p><p><br></p><p><a href="https://blog.csdn.net/my__Sun_/article/details/72866329" target="_blank" rel="noopener">springboot的三种启动方式</a></p><p><br></p><hr><p><br></p><p>更多参考：</p><p><a href="https://blog.csdn.net/ght886/article/details/91367067" target="_blank" rel="noopener">【Spring Boot】IDEA 创建Spring Boot项目（详细步骤）</a></p><p><br></p><p>更多创建Spring Boot的方式，可参考:</p><p><a href="https://www.google.com.hk/search?q=%E5%88%9B%E5%BB%BASpring+boot%E6%96%B9%E5%BC%8F&amp;newwindow=1&amp;sxsrf=APq-WBtX_Efc4gztqGQRHC071PkDNVVnDg%3A1644476184517&amp;ei=GLcEYrePH-2l2roPwJyzwAY&amp;ved=0ahUKEwi3-8aWx_T1AhXtklYBHUDODGgQ4dUDCA4&amp;uact=5&amp;oq=%E5%88%9B%E5%BB%BASpring+boot%E6%96%B9%E5%BC%8F&amp;gs_lcp=Cgdnd3Mtd2l6EAMyCQghEAoQoAEQKjIHCCEQChCgATIHCCEQChCgATIHCCEQChCgATIHCCEQChCgAToGCAAQChAqOgUIABCABDoECAAQCjoECAAQDToICAAQDRAKEB46CAgAEA0QBRAeSgQIQRgASgQIRhgAUABYhBhghRloAHAAeACAAccBiAHSCJIBAzMuNZgBAKABAcABAQ&amp;sclient=gws-wiz" target="_blank" rel="noopener">创建Spring boot方式</a></p><p><a href="http://soiiy.com/java/15345.html" target="_blank" rel="noopener">创建 SpringBoot 项目的两种方式</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;使用IDEA 来创建:&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;h4 id=&quot;文件-新建-项目&quot;&gt;&lt;a href=&quot;#文件-新建-项目&quot; class=&quot;headerlink&quot; title=&quot; 文件-新建-项目 &quot;&gt;&lt;/a&gt;&lt;font color=&quot;orange&quot;&gt; 文件-新建-项
      
    
    </summary>
    
    
      <category term="Java" scheme="http://www.dashen.tech/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>探究新版本新多出的协程</title>
    <link href="http://www.dashen.tech/2022/01/29/%E6%8E%A2%E7%A9%B6%E6%96%B0%E7%89%88%E6%9C%AC%E6%96%B0%E5%A4%9A%E5%87%BA%E7%9A%84%E5%8D%8F%E7%A8%8B/"/>
    <id>http://www.dashen.tech/2022/01/29/探究新版本新多出的协程/</id>
    <published>2022-01-29T12:18:34.000Z</published>
    <updated>2022-01-28T07:53:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>拉取Go 1.11镜像并启动</p><p><img src="/2022/01/29/探究新版本新多出的协程/0.png" width="100%" height="50%"></p><p><code>docker run -it  --name golang-1.11  golang:1.11.6</code></p><font size="1"><br><br>安装vim<br><br><img src="/2022/01/29/探究新版本新多出的协程/1.png" width="100%" height="50%"><br><br><br></font><p>不带参数执行,4个协程:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">os.Args: [/tmp/<span class="keyword">go</span>-build834710657/b001/exe/explore]</span><br><span class="line"><span class="built_in">len</span>(os.Args): <span class="number">1</span></span><br><span class="line"><span class="built_in">panic</span>: before timers</span><br><span class="line"></span><br><span class="line">goroutine <span class="number">1</span> [running]:</span><br><span class="line"><span class="built_in">panic</span>(<span class="number">0xb0160</span>, <span class="number">0xe5550</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/<span class="built_in">panic</span>.<span class="keyword">go</span>:<span class="number">556</span> +<span class="number">0x2c4</span> fp=<span class="number">0x400006ef10</span> sp=<span class="number">0x400006ee80</span> pc=<span class="number">0x34a14</span></span><br><span class="line">main.main()</span><br><span class="line">/<span class="keyword">go</span>/explore.<span class="keyword">go</span>:<span class="number">19</span> +<span class="number">0x1e0</span> fp=<span class="number">0x400006ef90</span> sp=<span class="number">0x400006ef10</span> pc=<span class="number">0x91c30</span></span><br><span class="line">runtime.main()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">201</span> +<span class="number">0x204</span> fp=<span class="number">0x400006efd0</span> sp=<span class="number">0x400006ef90</span> pc=<span class="number">0x364b4</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1114</span> +<span class="number">0x4</span> fp=<span class="number">0x400006efd0</span> sp=<span class="number">0x400006efd0</span> pc=<span class="number">0x5c1b4</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">2</span> [runnable]:</span><br><span class="line">runtime.forcegchelper()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">243</span> fp=<span class="number">0x400002cfd0</span> sp=<span class="number">0x400002cfd0</span> pc=<span class="number">0x36670</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1114</span> +<span class="number">0x4</span> fp=<span class="number">0x400002cfd0</span> sp=<span class="number">0x400002cfd0</span> pc=<span class="number">0x5c1b4</span></span><br><span class="line">created by runtime.init<span class="number">.3</span></span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">240</span> +<span class="number">0x28</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">3</span> [GC sweep wait]:</span><br><span class="line">runtime.gopark(<span class="number">0xd82b8</span>, <span class="number">0x173f80</span>, <span class="number">0x140c</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">302</span> +<span class="number">0xcc</span> fp=<span class="number">0x400002d780</span> sp=<span class="number">0x400002d760</span> pc=<span class="number">0x3687c</span></span><br><span class="line">runtime.goparkunlock(<span class="number">0x173f80</span>, <span class="number">0xe140c</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">308</span> +<span class="number">0x44</span> fp=<span class="number">0x400002d7b0</span> sp=<span class="number">0x400002d780</span> pc=<span class="number">0x36914</span></span><br><span class="line">runtime.bgsweep(<span class="number">0x400004c000</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgcsweep.<span class="keyword">go</span>:<span class="number">52</span> +<span class="number">0x90</span> fp=<span class="number">0x400002d7d0</span> sp=<span class="number">0x400002d7b0</span> pc=<span class="number">0x2acf0</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1114</span> +<span class="number">0x4</span> fp=<span class="number">0x400002d7d0</span> sp=<span class="number">0x400002d7d0</span> pc=<span class="number">0x5c1b4</span></span><br><span class="line">created by runtime.gcenable</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgc.<span class="keyword">go</span>:<span class="number">216</span> +<span class="number">0x4c</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">4</span> [runnable]:</span><br><span class="line">runtime.runfinq()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mfinal.<span class="keyword">go</span>:<span class="number">161</span> fp=<span class="number">0x400002dfd0</span> sp=<span class="number">0x400002dfd0</span> pc=<span class="number">0x22780</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1114</span> +<span class="number">0x4</span> fp=<span class="number">0x400002dfd0</span> sp=<span class="number">0x400002dfd0</span> pc=<span class="number">0x5c1b4</span></span><br><span class="line">created by runtime.createfing</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mfinal.<span class="keyword">go</span>:<span class="number">156</span> +<span class="number">0x6c</span></span><br><span class="line">exit status <span class="number">2</span></span><br></pre></td></tr></table></figure><p><br></p><p>带参数执行,5个协程:</p><p><img src="/2022/01/29/探究新版本新多出的协程/2.png" width="100%" height="50%"></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">os.Args: [/tmp/<span class="keyword">go</span>-build120473768/b001/exe/explore <span class="number">-111</span>]</span><br><span class="line"><span class="built_in">len</span>(os.Args): <span class="number">2</span></span><br><span class="line"><span class="built_in">panic</span>: after timers</span><br><span class="line"></span><br><span class="line">goroutine <span class="number">1</span> [running]:</span><br><span class="line"><span class="built_in">panic</span>(<span class="number">0xb0160</span>, <span class="number">0xe5560</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/<span class="built_in">panic</span>.<span class="keyword">go</span>:<span class="number">556</span> +<span class="number">0x2c4</span> fp=<span class="number">0x4000092f10</span> sp=<span class="number">0x4000092e80</span> pc=<span class="number">0x34a14</span></span><br><span class="line">main.main()</span><br><span class="line">/<span class="keyword">go</span>/explore.<span class="keyword">go</span>:<span class="number">28</span> +<span class="number">0x1c0</span> fp=<span class="number">0x4000092f90</span> sp=<span class="number">0x4000092f10</span> pc=<span class="number">0x91c10</span></span><br><span class="line">runtime.main()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">201</span> +<span class="number">0x204</span> fp=<span class="number">0x4000092fd0</span> sp=<span class="number">0x4000092f90</span> pc=<span class="number">0x364b4</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1114</span> +<span class="number">0x4</span> fp=<span class="number">0x4000092fd0</span> sp=<span class="number">0x4000092fd0</span> pc=<span class="number">0x5c1b4</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">2</span> [force gc (idle)]:</span><br><span class="line">runtime.gopark(<span class="number">0xd82b8</span>, <span class="number">0x173e80</span>, <span class="number">0x1410</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">302</span> +<span class="number">0xcc</span> fp=<span class="number">0x400002af70</span> sp=<span class="number">0x400002af50</span> pc=<span class="number">0x3687c</span></span><br><span class="line">runtime.goparkunlock(<span class="number">0x173e80</span>, <span class="number">0x1410</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">308</span> +<span class="number">0x44</span> fp=<span class="number">0x400002afa0</span> sp=<span class="number">0x400002af70</span> pc=<span class="number">0x36914</span></span><br><span class="line">runtime.forcegchelper()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">251</span> +<span class="number">0xac</span> fp=<span class="number">0x400002afd0</span> sp=<span class="number">0x400002afa0</span> pc=<span class="number">0x3671c</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1114</span> +<span class="number">0x4</span> fp=<span class="number">0x400002afd0</span> sp=<span class="number">0x400002afd0</span> pc=<span class="number">0x5c1b4</span></span><br><span class="line">created by runtime.init<span class="number">.3</span></span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">240</span> +<span class="number">0x28</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">3</span> [GC sweep wait]:</span><br><span class="line">runtime.gopark(<span class="number">0xd82b8</span>, <span class="number">0x173f80</span>, <span class="number">0x140c</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">302</span> +<span class="number">0xcc</span> fp=<span class="number">0x400002b780</span> sp=<span class="number">0x400002b760</span> pc=<span class="number">0x3687c</span></span><br><span class="line">runtime.goparkunlock(<span class="number">0x173f80</span>, <span class="number">0xe140c</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">308</span> +<span class="number">0x44</span> fp=<span class="number">0x400002b7b0</span> sp=<span class="number">0x400002b780</span> pc=<span class="number">0x36914</span></span><br><span class="line">runtime.bgsweep(<span class="number">0x400004c000</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgcsweep.<span class="keyword">go</span>:<span class="number">52</span> +<span class="number">0x90</span> fp=<span class="number">0x400002b7d0</span> sp=<span class="number">0x400002b7b0</span> pc=<span class="number">0x2acf0</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1114</span> +<span class="number">0x4</span> fp=<span class="number">0x400002b7d0</span> sp=<span class="number">0x400002b7d0</span> pc=<span class="number">0x5c1b4</span></span><br><span class="line">created by runtime.gcenable</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgc.<span class="keyword">go</span>:<span class="number">216</span> +<span class="number">0x4c</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">17</span> [runnable]:</span><br><span class="line">runtime.runfinq()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mfinal.<span class="keyword">go</span>:<span class="number">161</span> fp=<span class="number">0x40000267d0</span> sp=<span class="number">0x40000267d0</span> pc=<span class="number">0x22780</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1114</span> +<span class="number">0x4</span> fp=<span class="number">0x40000267d0</span> sp=<span class="number">0x40000267d0</span> pc=<span class="number">0x5c1b4</span></span><br><span class="line">created by runtime.createfing</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mfinal.<span class="keyword">go</span>:<span class="number">156</span> +<span class="number">0x6c</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">18</span> [runnable]:</span><br><span class="line">runtime.timerproc(<span class="number">0x176be0</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/time.<span class="keyword">go</span>:<span class="number">224</span> fp=<span class="number">0x400002a7d0</span> sp=<span class="number">0x400002a7d0</span> pc=<span class="number">0x4edc0</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1114</span> +<span class="number">0x4</span> fp=<span class="number">0x400002a7d0</span> sp=<span class="number">0x400002a7d0</span> pc=<span class="number">0x5c1b4</span></span><br><span class="line">created by runtime.(*timersBucket).addtimerLocked</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/time.<span class="keyword">go</span>:<span class="number">170</span> +<span class="number">0xf4</span></span><br><span class="line">exit status <span class="number">2</span></span><br></pre></td></tr></table></figure><p><br></p><p>go 1.13上：</p><p><img src="/2022/01/29/探究新版本新多出的协程/3.png" width="100%" height="50%"></p><blockquote><p>go version:</p></blockquote><p><code>go version go1.13.15 linux/arm64</code></p><p><br></p><p>不带参数，5个协程：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">os.Args: [/tmp/<span class="keyword">go</span>-build765375592/b001/exe/explore]</span><br><span class="line"><span class="built_in">len</span>(os.Args): <span class="number">1</span></span><br><span class="line"><span class="built_in">panic</span>: before timers</span><br><span class="line"></span><br><span class="line">goroutine <span class="number">1</span> [running]:</span><br><span class="line"><span class="built_in">panic</span>(<span class="number">0xb1c40</span>, <span class="number">0xef970</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/<span class="built_in">panic</span>.<span class="keyword">go</span>:<span class="number">722</span> +<span class="number">0x2d0</span> fp=<span class="number">0x4000052eb0</span> sp=<span class="number">0x4000052e20</span> pc=<span class="number">0x38870</span></span><br><span class="line">main.main()</span><br><span class="line">/<span class="keyword">go</span>/explore.<span class="keyword">go</span>:<span class="number">19</span> +<span class="number">0x238</span> fp=<span class="number">0x4000052f50</span> sp=<span class="number">0x4000052eb0</span> pc=<span class="number">0x9fc58</span></span><br><span class="line">runtime.main()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">203</span> +<span class="number">0x214</span> fp=<span class="number">0x4000052fd0</span> sp=<span class="number">0x4000052f50</span> pc=<span class="number">0x3a464</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1128</span> +<span class="number">0x4</span> fp=<span class="number">0x4000052fd0</span> sp=<span class="number">0x4000052fd0</span> pc=<span class="number">0x61e94</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">2</span> [force gc (idle)]:</span><br><span class="line">runtime.gopark(<span class="number">0xde210</span>, <span class="number">0x1848f0</span>, <span class="number">0x1411</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x400002cfa0</span> sp=<span class="number">0x400002cf80</span> pc=<span class="number">0x3a840</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.forcegchelper()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">253</span> +<span class="number">0xc0</span> fp=<span class="number">0x400002cfd0</span> sp=<span class="number">0x400002cfa0</span> pc=<span class="number">0x3a6f0</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1128</span> +<span class="number">0x4</span> fp=<span class="number">0x400002cfd0</span> sp=<span class="number">0x400002cfd0</span> pc=<span class="number">0x61e94</span></span><br><span class="line">created by runtime.init<span class="number">.4</span></span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">242</span> +<span class="number">0x30</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">3</span> [GC sweep wait]:</span><br><span class="line">runtime.gopark(<span class="number">0xde210</span>, <span class="number">0x184a20</span>, <span class="number">0x140c</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x400002d7a0</span> sp=<span class="number">0x400002d780</span> pc=<span class="number">0x3a840</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.bgsweep(<span class="number">0x400004a000</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgcsweep.<span class="keyword">go</span>:<span class="number">70</span> +<span class="number">0xa8</span> fp=<span class="number">0x400002d7d0</span> sp=<span class="number">0x400002d7a0</span> pc=<span class="number">0x2e2f8</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1128</span> +<span class="number">0x4</span> fp=<span class="number">0x400002d7d0</span> sp=<span class="number">0x400002d7d0</span> pc=<span class="number">0x61e94</span></span><br><span class="line">created by runtime.gcenable</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgc.<span class="keyword">go</span>:<span class="number">210</span> +<span class="number">0x54</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">4</span> [GC scavenge wait]:</span><br><span class="line">runtime.gopark(<span class="number">0xde210</span>, <span class="number">0x184b00</span>, <span class="number">0x140d</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x400002df30</span> sp=<span class="number">0x400002df10</span> pc=<span class="number">0x3a840</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.bgscavenge(<span class="number">0x400004a000</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgcscavenge.<span class="keyword">go</span>:<span class="number">299</span> +<span class="number">0xe4</span> fp=<span class="number">0x400002dfd0</span> sp=<span class="number">0x400002df30</span> pc=<span class="number">0x2da04</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1128</span> +<span class="number">0x4</span> fp=<span class="number">0x400002dfd0</span> sp=<span class="number">0x400002dfd0</span> pc=<span class="number">0x61e94</span></span><br><span class="line">created by runtime.gcenable</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgc.<span class="keyword">go</span>:<span class="number">211</span> +<span class="number">0x74</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">17</span> [runnable]:</span><br><span class="line">runtime.runfinq()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mfinal.<span class="keyword">go</span>:<span class="number">161</span> fp=<span class="number">0x40000287d0</span> sp=<span class="number">0x40000287d0</span> pc=<span class="number">0x24310</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1128</span> +<span class="number">0x4</span> fp=<span class="number">0x40000287d0</span> sp=<span class="number">0x40000287d0</span> pc=<span class="number">0x61e94</span></span><br><span class="line">created by runtime.createfing</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mfinal.<span class="keyword">go</span>:<span class="number">156</span> +<span class="number">0x78</span></span><br><span class="line">exit status <span class="number">2</span></span><br></pre></td></tr></table></figure><p>带参数，6个协程：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">os.Args: [/tmp/<span class="keyword">go</span>-build274885587/b001/exe/explore <span class="number">-123</span>]</span><br><span class="line"><span class="built_in">len</span>(os.Args): <span class="number">2</span></span><br><span class="line"><span class="built_in">panic</span>: after timers</span><br><span class="line"></span><br><span class="line">goroutine <span class="number">1</span> [running]:</span><br><span class="line"><span class="built_in">panic</span>(<span class="number">0xb1c40</span>, <span class="number">0xef980</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/<span class="built_in">panic</span>.<span class="keyword">go</span>:<span class="number">722</span> +<span class="number">0x2d0</span> fp=<span class="number">0x4000052eb0</span> sp=<span class="number">0x4000052e20</span> pc=<span class="number">0x38870</span></span><br><span class="line">main.main()</span><br><span class="line">/<span class="keyword">go</span>/explore.<span class="keyword">go</span>:<span class="number">28</span> +<span class="number">0x21c</span> fp=<span class="number">0x4000052f50</span> sp=<span class="number">0x4000052eb0</span> pc=<span class="number">0x9fc3c</span></span><br><span class="line">runtime.main()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">203</span> +<span class="number">0x214</span> fp=<span class="number">0x4000052fd0</span> sp=<span class="number">0x4000052f50</span> pc=<span class="number">0x3a464</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1128</span> +<span class="number">0x4</span> fp=<span class="number">0x4000052fd0</span> sp=<span class="number">0x4000052fd0</span> pc=<span class="number">0x61e94</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">2</span> [force gc (idle)]:</span><br><span class="line">runtime.gopark(<span class="number">0xde210</span>, <span class="number">0x1848f0</span>, <span class="number">0x1411</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x400002afa0</span> sp=<span class="number">0x400002af80</span> pc=<span class="number">0x3a840</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.forcegchelper()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">253</span> +<span class="number">0xc0</span> fp=<span class="number">0x400002afd0</span> sp=<span class="number">0x400002afa0</span> pc=<span class="number">0x3a6f0</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1128</span> +<span class="number">0x4</span> fp=<span class="number">0x400002afd0</span> sp=<span class="number">0x400002afd0</span> pc=<span class="number">0x61e94</span></span><br><span class="line">created by runtime.init<span class="number">.4</span></span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">242</span> +<span class="number">0x30</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">3</span> [GC sweep wait]:</span><br><span class="line">runtime.gopark(<span class="number">0xde210</span>, <span class="number">0x184a20</span>, <span class="number">0x140c</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x400002b7a0</span> sp=<span class="number">0x400002b780</span> pc=<span class="number">0x3a840</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.bgsweep(<span class="number">0x400004a000</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgcsweep.<span class="keyword">go</span>:<span class="number">70</span> +<span class="number">0xa8</span> fp=<span class="number">0x400002b7d0</span> sp=<span class="number">0x400002b7a0</span> pc=<span class="number">0x2e2f8</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1128</span> +<span class="number">0x4</span> fp=<span class="number">0x400002b7d0</span> sp=<span class="number">0x400002b7d0</span> pc=<span class="number">0x61e94</span></span><br><span class="line">created by runtime.gcenable</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgc.<span class="keyword">go</span>:<span class="number">210</span> +<span class="number">0x54</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">4</span> [GC scavenge wait]:</span><br><span class="line">runtime.gopark(<span class="number">0xde210</span>, <span class="number">0x184b00</span>, <span class="number">0x140d</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x400002bf30</span> sp=<span class="number">0x400002bf10</span> pc=<span class="number">0x3a840</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.bgscavenge(<span class="number">0x400004a000</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgcscavenge.<span class="keyword">go</span>:<span class="number">299</span> +<span class="number">0xe4</span> fp=<span class="number">0x400002bfd0</span> sp=<span class="number">0x400002bf30</span> pc=<span class="number">0x2da04</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1128</span> +<span class="number">0x4</span> fp=<span class="number">0x400002bfd0</span> sp=<span class="number">0x400002bfd0</span> pc=<span class="number">0x61e94</span></span><br><span class="line">created by runtime.gcenable</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgc.<span class="keyword">go</span>:<span class="number">211</span> +<span class="number">0x74</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">5</span> [finalizer wait]:</span><br><span class="line">runtime.gopark(<span class="number">0xde210</span>, <span class="number">0x19fde8</span>, <span class="number">0x1410</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x400002a730</span> sp=<span class="number">0x400002a710</span> pc=<span class="number">0x3a840</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.runfinq()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mfinal.<span class="keyword">go</span>:<span class="number">175</span> +<span class="number">0xbc</span> fp=<span class="number">0x400002a7d0</span> sp=<span class="number">0x400002a730</span> pc=<span class="number">0x243cc</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1128</span> +<span class="number">0x4</span> fp=<span class="number">0x400002a7d0</span> sp=<span class="number">0x400002a7d0</span> pc=<span class="number">0x61e94</span></span><br><span class="line">created by runtime.createfing</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mfinal.<span class="keyword">go</span>:<span class="number">156</span> +<span class="number">0x78</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">6</span> [syscall]:</span><br><span class="line">runtime.notetsleepg(<span class="number">0x187680</span>, <span class="number">0x12a031252</span>, <span class="number">0x0</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/lock_futex.<span class="keyword">go</span>:<span class="number">227</span> +<span class="number">0x30</span> fp=<span class="number">0x400002c750</span> sp=<span class="number">0x400002c720</span> pc=<span class="number">0x196a0</span></span><br><span class="line">runtime.timerproc(<span class="number">0x187660</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/time.<span class="keyword">go</span>:<span class="number">311</span> +<span class="number">0x2a4</span> fp=<span class="number">0x400002c7d0</span> sp=<span class="number">0x400002c750</span> pc=<span class="number">0x54054</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1128</span> +<span class="number">0x4</span> fp=<span class="number">0x400002c7d0</span> sp=<span class="number">0x400002c7d0</span> pc=<span class="number">0x61e94</span></span><br><span class="line">created by runtime.(*timersBucket).addtimerLocked</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/time.<span class="keyword">go</span>:<span class="number">169</span> +<span class="number">0x110</span></span><br><span class="line">exit status <span class="number">2</span></span><br></pre></td></tr></table></figure><p><br></p><p>go 1.14</p><blockquote><p>go version<br><code>go version go1.14.15 linux/arm64</code></p></blockquote><p>不带参数，5个协程</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">os.Args: [/tmp/<span class="keyword">go</span>-build251948969/b001/exe/explore]</span><br><span class="line"><span class="built_in">len</span>(os.Args): <span class="number">1</span></span><br><span class="line"><span class="built_in">panic</span>: before timers</span><br><span class="line"></span><br><span class="line">goroutine <span class="number">1</span> [running]:</span><br><span class="line"><span class="built_in">panic</span>(<span class="number">0xbe380</span>, <span class="number">0xfb230</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/<span class="built_in">panic</span>.<span class="keyword">go</span>:<span class="number">1064</span> +<span class="number">0x420</span> fp=<span class="number">0x400004eed0</span> sp=<span class="number">0x400004ee10</span> pc=<span class="number">0x3d0e0</span></span><br><span class="line">main.main()</span><br><span class="line">/<span class="keyword">go</span>/explore.<span class="keyword">go</span>:<span class="number">19</span> +<span class="number">0x238</span> fp=<span class="number">0x400004ef70</span> sp=<span class="number">0x400004eed0</span> pc=<span class="number">0xa4c48</span></span><br><span class="line">runtime.main()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">203</span> +<span class="number">0x20c</span> fp=<span class="number">0x400004efd0</span> sp=<span class="number">0x400004ef70</span> pc=<span class="number">0x3f97c</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1148</span> +<span class="number">0x4</span> fp=<span class="number">0x400004efd0</span> sp=<span class="number">0x400004efd0</span> pc=<span class="number">0x69c14</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">2</span> [force gc (idle)]:</span><br><span class="line">runtime.gopark(<span class="number">0xe7700</span>, <span class="number">0x195960</span>, <span class="number">0x1411</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x4000028fa0</span> sp=<span class="number">0x4000028f80</span> pc=<span class="number">0x3fd50</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.forcegchelper()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">253</span> +<span class="number">0xc0</span> fp=<span class="number">0x4000028fd0</span> sp=<span class="number">0x4000028fa0</span> pc=<span class="number">0x3fc00</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1148</span> +<span class="number">0x4</span> fp=<span class="number">0x4000028fd0</span> sp=<span class="number">0x4000028fd0</span> pc=<span class="number">0x69c14</span></span><br><span class="line">created by runtime.init<span class="number">.5</span></span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">242</span> +<span class="number">0x30</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">3</span> [GC sweep wait]:</span><br><span class="line">runtime.gopark(<span class="number">0xe7700</span>, <span class="number">0x195aa0</span>, <span class="number">0x140c</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x40000297a0</span> sp=<span class="number">0x4000029780</span> pc=<span class="number">0x3fd50</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.bgsweep(<span class="number">0x4000046000</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgcsweep.<span class="keyword">go</span>:<span class="number">70</span> +<span class="number">0xa8</span> fp=<span class="number">0x40000297d0</span> sp=<span class="number">0x40000297a0</span> pc=<span class="number">0x2e408</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1148</span> +<span class="number">0x4</span> fp=<span class="number">0x40000297d0</span> sp=<span class="number">0x40000297d0</span> pc=<span class="number">0x69c14</span></span><br><span class="line">created by runtime.gcenable</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgc.<span class="keyword">go</span>:<span class="number">214</span> +<span class="number">0x54</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">4</span> [GC scavenge wait]:</span><br><span class="line">runtime.gopark(<span class="number">0xe7700</span>, <span class="number">0x195a60</span>, <span class="number">0x140d</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x4000029f70</span> sp=<span class="number">0x4000029f50</span> pc=<span class="number">0x3fd50</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.bgscavenge(<span class="number">0x4000046000</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgcscavenge.<span class="keyword">go</span>:<span class="number">237</span> +<span class="number">0xe4</span> fp=<span class="number">0x4000029fd0</span> sp=<span class="number">0x4000029f70</span> pc=<span class="number">0x2cc24</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1148</span> +<span class="number">0x4</span> fp=<span class="number">0x4000029fd0</span> sp=<span class="number">0x4000029fd0</span> pc=<span class="number">0x69c14</span></span><br><span class="line">created by runtime.gcenable</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgc.<span class="keyword">go</span>:<span class="number">215</span> +<span class="number">0x74</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">17</span> [finalizer wait]:</span><br><span class="line">runtime.gopark(<span class="number">0xe7700</span>, <span class="number">0x1bef70</span>, <span class="number">0x1410</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x4000024730</span> sp=<span class="number">0x4000024710</span> pc=<span class="number">0x3fd50</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.runfinq()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mfinal.<span class="keyword">go</span>:<span class="number">175</span> +<span class="number">0xbc</span> fp=<span class="number">0x40000247d0</span> sp=<span class="number">0x4000024730</span> pc=<span class="number">0x244dc</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1148</span> +<span class="number">0x4</span> fp=<span class="number">0x40000247d0</span> sp=<span class="number">0x40000247d0</span> pc=<span class="number">0x69c14</span></span><br><span class="line">created by runtime.createfing</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mfinal.<span class="keyword">go</span>:<span class="number">156</span> +<span class="number">0x78</span></span><br><span class="line">exit status <span class="number">2</span></span><br></pre></td></tr></table></figure><p>带参数，也是5个协程</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">os.Args: [/tmp/<span class="keyword">go</span>-build768739727/b001/exe/explore <span class="number">-123</span>]</span><br><span class="line"><span class="built_in">len</span>(os.Args): <span class="number">2</span></span><br><span class="line"><span class="built_in">panic</span>: after timers</span><br><span class="line"></span><br><span class="line">goroutine <span class="number">1</span> [running]:</span><br><span class="line"><span class="built_in">panic</span>(<span class="number">0xbe380</span>, <span class="number">0xfb240</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/<span class="built_in">panic</span>.<span class="keyword">go</span>:<span class="number">1064</span> +<span class="number">0x420</span> fp=<span class="number">0x400004eed0</span> sp=<span class="number">0x400004ee10</span> pc=<span class="number">0x3d0e0</span></span><br><span class="line">main.main()</span><br><span class="line">/<span class="keyword">go</span>/explore.<span class="keyword">go</span>:<span class="number">28</span> +<span class="number">0x21c</span> fp=<span class="number">0x400004ef70</span> sp=<span class="number">0x400004eed0</span> pc=<span class="number">0xa4c2c</span></span><br><span class="line">runtime.main()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">203</span> +<span class="number">0x20c</span> fp=<span class="number">0x400004efd0</span> sp=<span class="number">0x400004ef70</span> pc=<span class="number">0x3f97c</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1148</span> +<span class="number">0x4</span> fp=<span class="number">0x400004efd0</span> sp=<span class="number">0x400004efd0</span> pc=<span class="number">0x69c14</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">2</span> [force gc (idle)]:</span><br><span class="line">runtime.gopark(<span class="number">0xe7700</span>, <span class="number">0x195960</span>, <span class="number">0x1411</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x4000026fa0</span> sp=<span class="number">0x4000026f80</span> pc=<span class="number">0x3fd50</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.forcegchelper()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">253</span> +<span class="number">0xc0</span> fp=<span class="number">0x4000026fd0</span> sp=<span class="number">0x4000026fa0</span> pc=<span class="number">0x3fc00</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1148</span> +<span class="number">0x4</span> fp=<span class="number">0x4000026fd0</span> sp=<span class="number">0x4000026fd0</span> pc=<span class="number">0x69c14</span></span><br><span class="line">created by runtime.init<span class="number">.5</span></span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">242</span> +<span class="number">0x30</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">3</span> [GC sweep wait]:</span><br><span class="line">runtime.gopark(<span class="number">0xe7700</span>, <span class="number">0x195aa0</span>, <span class="number">0x140c</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x40000277a0</span> sp=<span class="number">0x4000027780</span> pc=<span class="number">0x3fd50</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.bgsweep(<span class="number">0x4000046000</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgcsweep.<span class="keyword">go</span>:<span class="number">70</span> +<span class="number">0xa8</span> fp=<span class="number">0x40000277d0</span> sp=<span class="number">0x40000277a0</span> pc=<span class="number">0x2e408</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1148</span> +<span class="number">0x4</span> fp=<span class="number">0x40000277d0</span> sp=<span class="number">0x40000277d0</span> pc=<span class="number">0x69c14</span></span><br><span class="line">created by runtime.gcenable</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgc.<span class="keyword">go</span>:<span class="number">214</span> +<span class="number">0x54</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">4</span> [GC scavenge wait]:</span><br><span class="line">runtime.gopark(<span class="number">0xe7700</span>, <span class="number">0x195a60</span>, <span class="number">0x140d</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x4000027f70</span> sp=<span class="number">0x4000027f50</span> pc=<span class="number">0x3fd50</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.bgscavenge(<span class="number">0x4000046000</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgcscavenge.<span class="keyword">go</span>:<span class="number">237</span> +<span class="number">0xe4</span> fp=<span class="number">0x4000027fd0</span> sp=<span class="number">0x4000027f70</span> pc=<span class="number">0x2cc24</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1148</span> +<span class="number">0x4</span> fp=<span class="number">0x4000027fd0</span> sp=<span class="number">0x4000027fd0</span> pc=<span class="number">0x69c14</span></span><br><span class="line">created by runtime.gcenable</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mgc.<span class="keyword">go</span>:<span class="number">215</span> +<span class="number">0x74</span></span><br><span class="line"></span><br><span class="line">goroutine <span class="number">5</span> [finalizer wait]:</span><br><span class="line">runtime.gopark(<span class="number">0xe7700</span>, <span class="number">0x1bef70</span>, <span class="number">0x4000041410</span>, <span class="number">0x1</span>)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">304</span> +<span class="number">0xd0</span> fp=<span class="number">0x4000026730</span> sp=<span class="number">0x4000026710</span> pc=<span class="number">0x3fd50</span></span><br><span class="line">runtime.goparkunlock(...)</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/proc.<span class="keyword">go</span>:<span class="number">310</span></span><br><span class="line">runtime.runfinq()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mfinal.<span class="keyword">go</span>:<span class="number">175</span> +<span class="number">0xbc</span> fp=<span class="number">0x40000267d0</span> sp=<span class="number">0x4000026730</span> pc=<span class="number">0x244dc</span></span><br><span class="line">runtime.goexit()</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/asm_arm64.s:<span class="number">1148</span> +<span class="number">0x4</span> fp=<span class="number">0x40000267d0</span> sp=<span class="number">0x40000267d0</span> pc=<span class="number">0x69c14</span></span><br><span class="line">created by runtime.createfing</span><br><span class="line">/usr/local/<span class="keyword">go</span>/src/runtime/mfinal.<span class="keyword">go</span>:<span class="number">156</span> +<span class="number">0x78</span></span><br><span class="line">exit status <span class="number">2</span></span><br></pre></td></tr></table></figure><p><br></p><p>分了两个步骤：</p><p>一个改动发生在1.11到1.13之间，不考虑定时器，同一段代码，协程会多一个。初步猜测是scavenge<br>另一个是同一段代码，如果有定时器，go1.14会比go1.13及之前的少一个协程，少的是addtimerLocked</p><p>输出的信息中，有表明这个goroutine被谁created<br>‘</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;拉取Go 1.11镜像并启动&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2022/01/29/探究新版本新多出的协程/0.png&quot; width=&quot;100%&quot; height=&quot;50%&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;docker run -it  --name golang-1.11
      
    
    </summary>
    
    
      <category term="Go" scheme="http://www.dashen.tech/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>Rust时间和日期</title>
    <link href="http://www.dashen.tech/2022/01/08/Rust%E6%97%B6%E9%97%B4%E5%92%8C%E6%97%A5%E6%9C%9F/"/>
    <id>http://www.dashen.tech/2022/01/08/Rust时间和日期/</id>
    <published>2022-01-08T14:56:26.000Z</published>
    <updated>2022-01-08T16:14:45.000Z</updated>
    
    <content type="html"><![CDATA[<p>以下内容来自<a href></a></p><p>Rust的官方库<em>std::time::</em>不太好用，<a href="https://crates.io/crates/chrono" target="_blank" rel="noopener">chrono库</a>用的更多</p><p>Cargo.toml:</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[package]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">"time-ex"</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">"0.1.0"</span></span><br><span class="line"><span class="attr">edition</span> = <span class="string">"2018"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html</span></span><br><span class="line"></span><br><span class="line"><span class="section">[dependencies]</span></span><br><span class="line"><span class="attr">chrono</span> = <span class="string">"0.4.19"</span></span><br></pre></td></tr></table></figure><p><br></p><p>main.rs:</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> chrono::prelude::*;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取当前零时区的时间，以及当前所在时区的时间</span></span><br><span class="line">    <span class="keyword">let</span> utc: DateTime&lt;Utc&gt; = Utc::now();</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"零时区的时间为：&#123;:?&#125;"</span>, utc);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> local: DateTime&lt;Local&gt; = Local::now();</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"当前时区的时间为： &#123;:?&#125;"</span>, local)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2022/01/08/Rust时间和日期/0.png" width="80%" height="100%"></p><p><br></p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> chrono::prelude::*;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//格式化string</span></span><br><span class="line">    <span class="keyword">let</span> date_time = Utc.ymd(<span class="number">1993</span>, <span class="number">2</span>, <span class="number">17</span>).and_hms(<span class="number">5</span>, <span class="number">10</span>, <span class="number">23</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, date_time.format(<span class="string">"%Y-%m-%d %H:%M:%S"</span>).to_string());</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">"&#123;&#125;"</span>, date_time.format(<span class="string">"%Y年%m月%d日: %H小时%M分钟%S秒"</span>).to_string());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2022/01/08/Rust时间和日期/1.png" width="80%" height="100%"></p><p><br></p><p>从某个日期开始的下一个周五是几号？</p><p>如从2022.01.09号开始，下一个周五是几号(2022.01.14号)</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;以下内容来自&lt;a href&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Rust的官方库&lt;em&gt;std::time::&lt;/em&gt;不太好用，&lt;a href=&quot;https://crates.io/crates/chrono&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;chron
      
    
    </summary>
    
    
      <category term="Rust" scheme="http://www.dashen.tech/tags/Rust/"/>
    
  </entry>
  
  <entry>
    <title>OBS推流</title>
    <link href="http://www.dashen.tech/2021/12/14/OBS%E6%8E%A8%E6%B5%81/"/>
    <id>http://www.dashen.tech/2021/12/14/OBS推流/</id>
    <published>2021-12-14T12:00:58.000Z</published>
    <updated>2021-12-25T14:31:18.000Z</updated>
    
    <content type="html"><![CDATA[<p>为深入理解rtmp，推流，互动直播，录制，特意尝试了下使用OBS来推流到(各大)直播平台。。</p><p><br></p><p>以斗鱼为例，申请<a href="https://mp.douyu.com/live/main" target="_blank" rel="noopener">成为主播后</a>，会得到<strong>rtmp地址</strong>和<strong>直播码</strong>，</p><p><img src="/2021/12/14/OBS推流/0.png" width="80%" height="50%"></p><p>下载OBS</p><p><img src="/2021/12/14/OBS推流/1.png" width="80%" height="50%"></p><p>右下角，设置-推流-自定义:</p><p><img src="/2021/12/14/OBS推流/2.png" width="80%" height="50%"></p><p><br></p><p>接着设置来源,即想要在直播平台上显示的东西</p><p>点击加号，选择 <em>显示器采集</em>， （之前版本坑叫<em>显示捕获</em>），这样整个屏幕都会被推到直播平台</p><p>点击右侧<em>开始推流</em>，就会将选定的”来源“（此处即显示器屏幕），推流到斗鱼的房间</p><p><img src="/2021/12/14/OBS推流/3.png" width="80%" height="50%"></p><p>使用<em>窗口采集</em>，则只会推这个窗口的信息</p><p><img src="/2021/12/14/OBS推流/4.png" width="80%" height="50%"></p><p><br></p><p><img src="/2021/12/14/OBS推流/5.jpeg" width="80%" height="50%"></p><p><br></p><p>还需要再解决下窗口显示不全的问题</p><p><br></p><p>更多参考：</p><p><a href="https://www.bilibili.com/read/cv5380911/" target="_blank" rel="noopener">OBS推流直播快速上手教程</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;为深入理解rtmp，推流，互动直播，录制，特意尝试了下使用OBS来推流到(各大)直播平台。。&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;以斗鱼为例，申请&lt;a href=&quot;https://mp.douyu.com/live/main&quot; target=&quot;_blank&quot; rel=&quot;n
      
    
    </summary>
    
    
      <category term="Tools" scheme="http://www.dashen.tech/tags/Tools/"/>
    
  </entry>
  
  <entry>
    <title>二进制分析工具</title>
    <link href="http://www.dashen.tech/2021/12/14/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/"/>
    <id>http://www.dashen.tech/2021/12/14/二进制分析工具/</id>
    <published>2021-12-14T01:58:49.000Z</published>
    <updated>2022-05-05T12:12:16.003Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.google.com.hk/search?q=ar%2C+nm%2C+objdump&amp;oq=ar%2C+nm%2C+objdump&amp;aqs=chrome..69i57j69i61.160j0j1&amp;sourceid=chrome&amp;ie=UTF-8" target="_blank" rel="noopener">https://www.google.com.hk/search?q=ar%2C+nm%2C+objdump&amp;oq=ar%2C+nm%2C+objdump&amp;aqs=chrome..69i57j69i61.160j0j1&amp;sourceid=chrome&amp;ie=UTF-8</a></p><p><a href="https://blog.csdn.net/princess9/article/details/6785108" target="_blank" rel="noopener">https://blog.csdn.net/princess9/article/details/6785108</a></p><p>nm</p><p><a href="https://blog.csdn.net/K346K346/article/details/89088542" target="_blank" rel="noopener">https://blog.csdn.net/K346K346/article/details/89088542</a></p><p><a href="https://www.jianshu.com/p/a86bd1b8e4a5" target="_blank" rel="noopener">https://www.jianshu.com/p/a86bd1b8e4a5</a></p><p><a href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/nm.html" target="_blank" rel="noopener">https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/nm.html</a></p><hr><p><a href="https://blog.csdn.net/weixin_36094492/article/details/112657647" target="_blank" rel="noopener">https://blog.csdn.net/weixin_36094492/article/details/112657647</a></p><p><a href="https://www.google.com.hk/search?q=go+tool+nm%E5%91%BD%E4%BB%A4&amp;oq=go+tool+nm%E5%91%BD%E4%BB%A4&amp;aqs=chrome..69i57j69i64l2j69i60.187j0j4&amp;sourceid=chrome&amp;ie=UTF-8" target="_blank" rel="noopener">https://www.google.com.hk/search?q=go+tool+nm%E5%91%BD%E4%BB%A4&amp;oq=go+tool+nm%E5%91%BD%E4%BB%A4&amp;aqs=chrome..69i57j69i64l2j69i60.187j0j4&amp;sourceid=chrome&amp;ie=UTF-8</a></p><p><a href="https://segmentfault.com/a/1190000040043628" target="_blank" rel="noopener">https://segmentfault.com/a/1190000040043628</a></p><p> 好用的<a href="https://github.com/wader/fq" target="_blank" rel="noopener">二进制分析工具</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://www.google.com.hk/search?q=ar%2C+nm%2C+objdump&amp;amp;oq=ar%2C+nm%2C+objdump&amp;amp;aqs=chrome..69i57j69i61.160j0j1&amp;amp;source
      
    
    </summary>
    
    
      <category term="Tools" scheme="http://www.dashen.tech/tags/Tools/"/>
    
  </entry>
  
  <entry>
    <title>协程调度顺序</title>
    <link href="http://www.dashen.tech/2021/12/12/%E5%8D%8F%E7%A8%8B%E8%B0%83%E5%BA%A6%E9%A1%BA%E5%BA%8F/"/>
    <id>http://www.dashen.tech/2021/12/12/协程调度顺序/</id>
    <published>2021-12-12T15:37:29.000Z</published>
    <updated>2021-12-17T15:20:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>本文是对<a href="https://www.bilibili.com/video/BV19b4y1i74w" target="_blank" rel="noopener">卷卷面试题</a>的学习与记录</p><p><br></p><p>go 关键字会被编译器转化为对<em>runtime.newproc</em>函数的调用。该函数的主要逻辑：先切换到系统栈，然后调用<em>newproc1</em>函数，分配并初始化一个新的g，再通过<em>runqput</em>把新的g添加到当前P的本地runq中。</p><p><img src="/2021/12/12/协程调度顺序/0.png" width="100%" height="100%"></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"runtime"</span></span><br><span class="line"><span class="string">"sync"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 任一时刻，只允许一个M执行Go代码； 就像单核CPU上的多线程那样</span></span><br><span class="line">runtime.GOMAXPROCS(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line"></span><br><span class="line">wg.Add(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(n <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line"><span class="built_in">println</span>(n)</span><br><span class="line">wg.Done()</span><br><span class="line">&#125;(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(n <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line"><span class="built_in">println</span>(n)</span><br><span class="line">wg.Done()</span><br><span class="line">&#125;(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(n <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line"><span class="built_in">println</span>(n)</span><br><span class="line">wg.Done()</span><br><span class="line">&#125;(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">wg.Wait()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure><p><br></p><p>之所以如此，是因为 P不仅有一个本地runq，还有一个runnext字段，用来保存下次要运行的g。 newproc1中调用runqput时会用到这个runnext</p><p><img src="/2021/12/12/协程调度顺序/1.png" width="100%" height="100%"><br><img src="/2021/12/12/协程调度顺序/2.png" width="100%" height="100%"><br><img src="/2021/12/12/协程调度顺序/3.png" width="100%" height="100%"><br><img src="/2021/12/12/协程调度顺序/4.png" width="100%" height="100%"><br><img src="/2021/12/12/协程调度顺序/5.png" width="100%" height="100%"></p><p>调度goroutine执行时，通过runqget获取待执行的g。runqget也会对runnext特殊处理：<strong>优先调度runnext这里记录的g，再按顺序调度本地runq中记录的g</strong></p><p>所以是3-1-2</p><p><img src="/2021/12/12/协程调度顺序/6.png" width="100%" height="100%"></p><p><br></p><p>如果创建更多的goroutine，结果也如此吗？</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"runtime"</span></span><br><span class="line"><span class="string">"sync"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 任一时刻，只允许一个M执行Go代码； 就像单核CPU上的多线程那样</span></span><br><span class="line">runtime.GOMAXPROCS(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">280</span>; i++ &#123;</span><br><span class="line">wg.Add(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(n <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line"><span class="built_in">println</span>(n)</span><br><span class="line">wg.Done()</span><br><span class="line">&#125;(i)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">wg.Wait()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4个goroutine输出的是 4,1,2,3<br>5个goroutine输出的是 5,1,2,3,4</p><p>直到257个gorutine，都是这样的规律, 即  <em>N,1,2,….,(N-1)</em></p><p><br></p><p>当多于257个goutine时，</p><p><img src="/2021/12/12/协程调度顺序/7.png" width="100%" height="100%"></p><p>第258号goutine会把257号挤走，但本地runq已满，所以第257号goroutine，会和本地runq中前一半的g，一同进入到全局runq中，</p><p><img src="/2021/12/12/协程调度顺序/8.png" width="100%" height="100%"></p><p>先从本地runq中获取待执行的g，没有的话，再从全局runq获取。还没有的话，就去其他P那里steal一部分(一半)，</p><p><img src="/2021/12/12/协程调度顺序/9.png" width="100%" height="100%"></p><p>所以可能会以为，先执行258号，而后是129，130…,256。最后才是全局队列中的1，2，…128，257</p><p>实际并非如此…</p><p>实际执行会发现，第1号，2号goroutine，会穿插在258，129，….258之间被执行。</p><p>这个问题与runq的排队逻辑无关，属于调度逻辑的范畴</p><p><img src="/2021/12/12/协程调度顺序/10.png" width="100%" height="100%"></p><p>runtime.schedule，每隔61个schedtick，就会优先尝试从<strong>全局runq</strong>中获取goroutine，这是为了避免在每个P的本地runq都很繁忙时，全局runq中的goroutine迟迟得不到调度的情况。</p><p><br></p><ul><li><p>本地runq的排队逻辑(runnext)</p></li><li><p>全局runq，每隔61个schedtick会优先从全局runq中拿一个goroutine去执行</p></li></ul><p><br></p><p>更多阅读</p><p><a href="https://qcrao.com/2021/05/24/confusing-goroutine-running-orders/" target="_blank" rel="noopener">迷惑的 goroutine 执行顺序</a></p><p><a href="https://qcrao.com/2021/05/20/go-schedule-under-the-hood/" target="_blank" rel="noopener">Go 调度的本质</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;本文是对&lt;a href=&quot;https://www.bilibili.com/video/BV19b4y1i74w&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;卷卷面试题&lt;/a&gt;的学习与记录&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;go 关键字会被编译器转化
      
    
    </summary>
    
      <category term="runtime" scheme="http://www.dashen.tech/categories/runtime/"/>
    
    
      <category term="Go" scheme="http://www.dashen.tech/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>Go内存管理之内存分配</title>
    <link href="http://www.dashen.tech/2021/11/24/Go%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E4%B9%8B%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/"/>
    <id>http://www.dashen.tech/2021/11/24/Go内存管理之内存分配/</id>
    <published>2021-11-24T12:01:36.000Z</published>
    <updated>2021-12-20T01:54:44.000Z</updated>
    
    <content type="html"><![CDATA[<p>相关博文 <a href="https://dashen.tech/2019/06/28/golang%E4%B8%ADslice%E6%89%A9%E5%AE%B9%E4%B8%80%E5%AE%9A%E6%98%AFdouble%E6%88%961-25%E5%80%8D%E5%90%97/" target="_blank" rel="noopener">golang中slice扩容一定是double或1.25倍吗</a></p><p><a href="https://dashen.tech/2014/04/01/Go%E5%86%85%E5%AD%98%E8%AF%A6%E8%A7%A3/" target="_blank" rel="noopener">Go内存详解</a></p><p><br></p><p>较好博文：</p><p><a href="https://zhuanlan.zhihu.com/p/59125443" target="_blank" rel="noopener">图解Go语言内存分配</a></p><p><a href="https://zhuanlan.zhihu.com/p/266496735" target="_blank" rel="noopener">Go内存管理三部曲[1]- 内存分配</a></p><p><a href="https://draveness.me/golang/docs/part3-runtime/ch07-memory/golang-memory-allocator/" target="_blank" rel="noopener">https://draveness.me/golang/docs/part3-runtime/ch07-memory/golang-memory-allocator/</a></p><p><a href="https://blog.csdn.net/qq_31720329/article/details/121772876" target="_blank" rel="noopener">go 内存管理 设计与实现 图解</a></p><p>本篇是对以上内容的学习与记录：</p><blockquote><p>Go运行时的内存分配算法主要源自 Google 为 C 语言开发的TCMalloc算法，全称Thread-Caching Malloc。核心思想就是把内存分为多级管理，从而降低锁的粒度。它将可用的堆内存采用二级分配的方式进行管理：每个线程都会自行维护一个独立的内存池，进行内存分配时优先从该内存池中分配，当内存池不足时才会向全局内存池申请，以避免不同线程对全局内存池的频繁竞争。</p></blockquote><p><br></p><p>Go在程序启动时 先向操作系统申请一块内存，并将其分配到三个区域：</p><ul><li>arena区域(512GB，64位操作系统)，即堆区，Go动态分配的内存都在该区域，其将内存分割成8KB大小的页，一些页组合起来称为mspan</li></ul><ul><li><p>bitmap区域(16GB)，标识arena区域哪些地址保存了对象，并用4bit标志位表示对象是否包含指针、GC标记信息。bitmap中一个byte大小的内存对应arena区域中4个指针大小（指针大小为 8B ）的内存，所以bitmap区域的大小是512GB/(4*8B)=16GB</p></li><li><p>spans区域(512MB)：存放mspan（arena分割的页组合起来的内存管理基本单元）的指针，每个指针对应一页，所以spans区域的大小就是512GB/8KB*8B=512MB。(除以8KB是计算arena区域的页数，而最后乘以8是计算spans区域所有指针的大小。创建mspan的时候，按页填充对应的spans区域，在回收object时，根据地址很容易就能找到它所属的mspan)</p></li></ul><p>mspan 是Go内存管理的基本单元，mspan是由一片连续的8KB的页组成的大块内存。这里的页和操作系统本身的页不是一回事，它一般是操作系统页大小的几倍。即mspan是一个包含起始地址、mspan规格、页的数量等内容的<strong>双端链表</strong></p><p>细微的对象切割</p><p>极致的多级缓存</p><p>精准的位图管理</p><p>更多：</p><p><a href="https://github.com/coldnight/go-memory-allocator-visual-guide" target="_blank" rel="noopener">Go 内存分配器可视化指南</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;相关博文 &lt;a href=&quot;https://dashen.tech/2019/06/28/golang%E4%B8%ADslice%E6%89%A9%E5%AE%B9%E4%B8%80%E5%AE%9A%E6%98%AFdouble%E6%88%961-25%E5%80%8
      
    
    </summary>
    
      <category term="runtime" scheme="http://www.dashen.tech/categories/runtime/"/>
    
    
      <category term="Todo" scheme="http://www.dashen.tech/tags/Todo/"/>
    
  </entry>
  
  <entry>
    <title>Go内存优化</title>
    <link href="http://www.dashen.tech/2021/11/17/Go%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96/"/>
    <id>http://www.dashen.tech/2021/11/17/Go内存优化/</id>
    <published>2021-11-17T05:47:32.000Z</published>
    <updated>2021-11-17T05:47:48.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://wudaijun.com/2019/09/go-performance-optimization/" target="_blank" rel="noopener">https://wudaijun.com/2019/09/go-performance-optimization/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://wudaijun.com/2019/09/go-performance-optimization/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://wudaijun.com/2019/09/go-perfor
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>关于零号协程</title>
    <link href="http://www.dashen.tech/2021/11/09/%E5%85%B3%E4%BA%8E%E9%9B%B6%E5%8F%B7%E5%8D%8F%E7%A8%8B/"/>
    <id>http://www.dashen.tech/2021/11/09/关于零号协程/</id>
    <published>2021-11-09T05:45:55.000Z</published>
    <updated>2021-12-17T15:11:02.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://mp.weixin.qq.com/s?__biz=Mzg2NTA2NzQ2Nw==&amp;mid=2247483873&amp;idx=1&amp;sn=724560a071a4ca6b620837d05e29a54e" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=Mzg2NTA2NzQ2Nw==&amp;mid=2247483873&amp;idx=1&amp;sn=724560a071a4ca6b620837d05e29a54e</a></p><p><a href="https://zhuanlan.zhihu.com/p/344842279" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/344842279</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=Mzg2NTA2NzQ2Nw==&amp;amp;mid=2247483873&amp;amp;idx=1&amp;amp;sn=724560a071a4ca6b620837d05e29a54e&quot; target=&quot;
      
    
    </summary>
    
      <category term="runtime" scheme="http://www.dashen.tech/categories/runtime/"/>
    
    
      <category term="Todo" scheme="http://www.dashen.tech/tags/Todo/"/>
    
      <category term="Go" scheme="http://www.dashen.tech/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>统计某月有几篇博文</title>
    <link href="http://www.dashen.tech/2021/10/11/%E7%BB%9F%E8%AE%A1%E6%9F%90%E6%9C%88%E6%9C%89%E5%87%A0%E7%AF%87%E5%8D%9A%E6%96%87/"/>
    <id>http://www.dashen.tech/2021/10/11/统计某月有几篇博文/</id>
    <published>2021-10-11T15:24:31.000Z</published>
    <updated>2021-12-13T15:51:16.000Z</updated>
    
    <content type="html"><![CDATA[<p>有插件可以将各个月份博文的数量统计并附在其后，不太喜欢这种展示方式(认为展示出的参差数据，破坏和谐一致的感觉)，自己动手，只统计不展示</p><p><img src="/2021/10/11/统计某月有几篇博文/0.png" width="50%" height="100%"></p><p><br></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"io/ioutil"</span></span><br><span class="line"><span class="string">"regexp"</span></span><br><span class="line"><span class="string">"strings"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> m = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">basePath := <span class="string">"/Users/fliter/blog/source/_posts/"</span></span><br><span class="line"><span class="comment">// 获取某目录下的所有文件; 也可以用 files, _ := filepath.Glob("*")</span></span><br><span class="line">files, _ := ioutil.ReadDir(basePath)</span><br><span class="line"><span class="keyword">for</span> _, f := <span class="keyword">range</span> files &#123;</span><br><span class="line"><span class="keyword">if</span> strings.Contains(f.Name(), <span class="string">".md"</span>) &#123;</span><br><span class="line"><span class="comment">//fmt.Println(f.Name())</span></span><br><span class="line">deal(basePath + f.Name())</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(m)</span><br><span class="line"></span><br><span class="line">fmt.Println()</span><br><span class="line">fmt.Println(<span class="string">"下面迭代时会乱序："</span>)</span><br><span class="line">fmt.Println()</span><br><span class="line"><span class="keyword">for</span> k, v := <span class="keyword">range</span> m &#123;</span><br><span class="line">fmt.Printf(<span class="string">"%s月有%d篇博文\n"</span>, k, v)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">deal</span><span class="params">(filePath <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//fmt.Println(filePath) // /Users/fliter/blog/source/_posts/16777619与FNV哈希算法.md</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// read the whole file at once</span></span><br><span class="line">b, err := ioutil.ReadFile(filePath)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="built_in">panic</span>(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">s := <span class="keyword">string</span>(b)</span><br><span class="line"><span class="comment">//fmt.Println(s)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 进行正则匹配</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// go - 如何获得两个已知单词之间的字符串？ https://www.coder.work/article/212986</span></span><br><span class="line"><span class="comment">// 或者可以预先将换行符及空格等全部清除掉</span></span><br><span class="line">re := regexp.MustCompile(<span class="string">`date: (.*?)</span></span><br><span class="line"><span class="string">tags:`</span>)</span><br><span class="line"></span><br><span class="line">date := re.FindStringSubmatch(s)[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">//fmt.Println(date) // 2021-08-09 22:30:47</span></span><br><span class="line">t, _ := time.Parse(<span class="string">"2006-01-02 15:04:05"</span>, date)</span><br><span class="line">month := time.Unix(t.Unix(), <span class="number">0</span>).Format(<span class="string">"2006-01"</span>)</span><br><span class="line"><span class="comment">//fmt.Println(month) // 2021-08</span></span><br><span class="line"></span><br><span class="line">m[month] = m[month] + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//os.Exit(11)</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/10/11/统计某月有几篇博文/1.png" width="50%" height="100%"></p><p>执行结果如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">map</span>[<span class="number">1093</span><span class="number">-02</span>:<span class="number">23</span> <span class="number">2010</span><span class="number">-03</span>:<span class="number">9</span> <span class="number">2011</span><span class="number">-04</span>:<span class="number">1</span> <span class="number">2012</span><span class="number">-01</span>:<span class="number">2</span> <span class="number">2012</span><span class="number">-11</span>:<span class="number">8</span> <span class="number">2012</span><span class="number">-12</span>:<span class="number">2</span> <span class="number">2013</span><span class="number">-04</span>:<span class="number">5</span> <span class="number">2014</span><span class="number">-03</span>:<span class="number">4</span> <span class="number">2014</span><span class="number">-04</span>:<span class="number">1</span> <span class="number">2015</span><span class="number">-01</span>:<span class="number">2</span> <span class="number">2015</span><span class="number">-02</span>:<span class="number">3</span> <span class="number">2015</span><span class="number">-03</span>:<span class="number">143</span> <span class="number">2015</span><span class="number">-04</span>:<span class="number">3</span> <span class="number">2015</span><span class="number">-05</span>:<span class="number">1</span> <span class="number">2015</span><span class="number">-06</span>:<span class="number">3</span> <span class="number">2015</span><span class="number">-07</span>:<span class="number">2</span> <span class="number">2015</span><span class="number">-08</span>:<span class="number">6</span> <span class="number">2015</span><span class="number">-09</span>:<span class="number">7</span> <span class="number">2015</span><span class="number">-10</span>:<span class="number">7</span> <span class="number">2015</span><span class="number">-11</span>:<span class="number">25</span> <span class="number">2015</span><span class="number">-12</span>:<span class="number">5</span> <span class="number">2016</span><span class="number">-02</span>:<span class="number">3</span> <span class="number">2016</span><span class="number">-03</span>:<span class="number">8</span> <span class="number">2016</span><span class="number">-04</span>:<span class="number">9</span> <span class="number">2016</span><span class="number">-05</span>:<span class="number">4</span> <span class="number">2016</span><span class="number">-06</span>:<span class="number">8</span> <span class="number">2016</span><span class="number">-07</span>:<span class="number">5</span> <span class="number">2016</span><span class="number">-08</span>:<span class="number">4</span> <span class="number">2016</span><span class="number">-09</span>:<span class="number">2</span> <span class="number">2016</span><span class="number">-10</span>:<span class="number">11</span> <span class="number">2016</span><span class="number">-11</span>:<span class="number">6</span> <span class="number">2016</span><span class="number">-12</span>:<span class="number">4</span> <span class="number">2017</span><span class="number">-01</span>:<span class="number">3</span> <span class="number">2017</span><span class="number">-02</span>:<span class="number">9</span> <span class="number">2017</span><span class="number">-03</span>:<span class="number">9</span> <span class="number">2017</span><span class="number">-04</span>:<span class="number">7</span> <span class="number">2017</span><span class="number">-05</span>:<span class="number">10</span> <span class="number">2017</span><span class="number">-06</span>:<span class="number">8</span> <span class="number">2017</span><span class="number">-07</span>:<span class="number">11</span> <span class="number">2017</span><span class="number">-08</span>:<span class="number">6</span> <span class="number">2017</span><span class="number">-09</span>:<span class="number">6</span> <span class="number">2017</span><span class="number">-10</span>:<span class="number">9</span> <span class="number">2017</span><span class="number">-11</span>:<span class="number">4</span> <span class="number">2017</span><span class="number">-12</span>:<span class="number">5</span> <span class="number">2018</span><span class="number">-01</span>:<span class="number">6</span> <span class="number">2018</span><span class="number">-02</span>:<span class="number">7</span> <span class="number">2018</span><span class="number">-03</span>:<span class="number">8</span> <span class="number">2018</span><span class="number">-04</span>:<span class="number">8</span> <span class="number">2018</span><span class="number">-05</span>:<span class="number">8</span> <span class="number">2018</span><span class="number">-06</span>:<span class="number">6</span> <span class="number">2018</span><span class="number">-07</span>:<span class="number">11</span> <span class="number">2018</span><span class="number">-08</span>:<span class="number">10</span> <span class="number">2018</span><span class="number">-09</span>:<span class="number">6</span> <span class="number">2018</span><span class="number">-10</span>:<span class="number">9</span> <span class="number">2018</span><span class="number">-11</span>:<span class="number">6</span> <span class="number">2018</span><span class="number">-12</span>:<span class="number">5</span> <span class="number">2019</span><span class="number">-01</span>:<span class="number">7</span> <span class="number">2019</span><span class="number">-02</span>:<span class="number">10</span> <span class="number">2019</span><span class="number">-03</span>:<span class="number">11</span> <span class="number">2019</span><span class="number">-04</span>:<span class="number">12</span> <span class="number">2019</span><span class="number">-05</span>:<span class="number">8</span> <span class="number">2019</span><span class="number">-06</span>:<span class="number">9</span> <span class="number">2019</span><span class="number">-07</span>:<span class="number">14</span> <span class="number">2019</span><span class="number">-08</span>:<span class="number">9</span> <span class="number">2019</span><span class="number">-09</span>:<span class="number">8</span> <span class="number">2019</span><span class="number">-10</span>:<span class="number">12</span> <span class="number">2019</span><span class="number">-11</span>:<span class="number">9</span> <span class="number">2019</span><span class="number">-12</span>:<span class="number">8</span> <span class="number">2020</span><span class="number">-01</span>:<span class="number">9</span> <span class="number">2020</span><span class="number">-02</span>:<span class="number">9</span> <span class="number">2020</span><span class="number">-03</span>:<span class="number">11</span> <span class="number">2020</span><span class="number">-04</span>:<span class="number">10</span> <span class="number">2020</span><span class="number">-05</span>:<span class="number">13</span> <span class="number">2020</span><span class="number">-06</span>:<span class="number">14</span> <span class="number">2020</span><span class="number">-07</span>:<span class="number">10</span> <span class="number">2020</span><span class="number">-08</span>:<span class="number">7</span> <span class="number">2020</span><span class="number">-09</span>:<span class="number">10</span> <span class="number">2020</span><span class="number">-10</span>:<span class="number">10</span> <span class="number">2020</span><span class="number">-11</span>:<span class="number">11</span> <span class="number">2020</span><span class="number">-12</span>:<span class="number">6</span> <span class="number">2021</span><span class="number">-01</span>:<span class="number">10</span> <span class="number">2021</span><span class="number">-02</span>:<span class="number">8</span> <span class="number">2021</span><span class="number">-03</span>:<span class="number">7</span> <span class="number">2021</span><span class="number">-04</span>:<span class="number">8</span> <span class="number">2021</span><span class="number">-05</span>:<span class="number">8</span> <span class="number">2021</span><span class="number">-06</span>:<span class="number">8</span> <span class="number">2021</span><span class="number">-07</span>:<span class="number">8</span> <span class="number">2021</span><span class="number">-08</span>:<span class="number">4</span> <span class="number">2021</span><span class="number">-09</span>:<span class="number">17</span> <span class="number">2021</span><span class="number">-10</span>:<span class="number">1</span> <span class="number">2021</span><span class="number">-11</span>:<span class="number">3</span> <span class="number">2021</span><span class="number">-12</span>:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">下面迭代时会乱序：</span><br><span class="line"></span><br><span class="line"><span class="number">2015</span><span class="number">-09</span>月有<span class="number">7</span>篇博文</span><br><span class="line"><span class="number">2017</span><span class="number">-11</span>月有<span class="number">4</span>篇博文</span><br><span class="line"><span class="number">2015</span><span class="number">-06</span>月有<span class="number">3</span>篇博文</span><br><span class="line"><span class="number">2020</span><span class="number">-04</span>月有<span class="number">10</span>篇博文</span><br><span class="line"><span class="number">2018</span><span class="number">-11</span>月有<span class="number">6</span>篇博文</span><br><span class="line"><span class="number">2020</span><span class="number">-03</span>月有<span class="number">11</span>篇博文</span><br><span class="line"><span class="number">2019</span><span class="number">-04</span>月有<span class="number">12</span>篇博文</span><br><span class="line"><span class="number">2019</span><span class="number">-03</span>月有<span class="number">11</span>篇博文</span><br><span class="line"><span class="number">2017</span><span class="number">-09</span>月有<span class="number">6</span>篇博文</span><br><span class="line"><span class="number">2015</span><span class="number">-01</span>月有<span class="number">2</span>篇博文</span><br><span class="line"><span class="number">2015</span><span class="number">-08</span>月有<span class="number">6</span>篇博文</span><br><span class="line"><span class="number">2021</span><span class="number">-02</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2021</span><span class="number">-12</span>月有<span class="number">2</span>篇博文</span><br><span class="line"><span class="number">2016</span><span class="number">-04</span>月有<span class="number">9</span>篇博文</span><br><span class="line"><span class="number">2017</span><span class="number">-04</span>月有<span class="number">7</span>篇博文</span><br><span class="line"><span class="number">1093</span><span class="number">-02</span>月有<span class="number">23</span>篇博文</span><br><span class="line"><span class="number">2013</span><span class="number">-04</span>月有<span class="number">5</span>篇博文</span><br><span class="line"><span class="number">2019</span><span class="number">-08</span>月有<span class="number">9</span>篇博文</span><br><span class="line"><span class="number">2018</span><span class="number">-03</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2020</span><span class="number">-08</span>月有<span class="number">7</span>篇博文</span><br><span class="line"><span class="number">2017</span><span class="number">-01</span>月有<span class="number">3</span>篇博文</span><br><span class="line"><span class="number">2015</span><span class="number">-02</span>月有<span class="number">3</span>篇博文</span><br><span class="line"><span class="number">2020</span><span class="number">-11</span>月有<span class="number">11</span>篇博文</span><br><span class="line"><span class="number">2019</span><span class="number">-11</span>月有<span class="number">9</span>篇博文</span><br><span class="line"><span class="number">2016</span><span class="number">-11</span>月有<span class="number">6</span>篇博文</span><br><span class="line"><span class="number">2011</span><span class="number">-04</span>月有<span class="number">1</span>篇博文</span><br><span class="line"><span class="number">2021</span><span class="number">-11</span>月有<span class="number">3</span>篇博文</span><br><span class="line"><span class="number">2018</span><span class="number">-06</span>月有<span class="number">6</span>篇博文</span><br><span class="line"><span class="number">2016</span><span class="number">-09</span>月有<span class="number">2</span>篇博文</span><br><span class="line"><span class="number">2015</span><span class="number">-11</span>月有<span class="number">25</span>篇博文</span><br><span class="line"><span class="number">2021</span><span class="number">-10</span>月有<span class="number">1</span>篇博文</span><br><span class="line"><span class="number">2019</span><span class="number">-12</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2017</span><span class="number">-07</span>月有<span class="number">11</span>篇博文</span><br><span class="line"><span class="number">2017</span><span class="number">-12</span>月有<span class="number">5</span>篇博文</span><br><span class="line"><span class="number">2020</span><span class="number">-06</span>月有<span class="number">14</span>篇博文</span><br><span class="line"><span class="number">2020</span><span class="number">-12</span>月有<span class="number">6</span>篇博文</span><br><span class="line"><span class="number">2019</span><span class="number">-06</span>月有<span class="number">9</span>篇博文</span><br><span class="line"><span class="number">2021</span><span class="number">-07</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2016</span><span class="number">-03</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2015</span><span class="number">-05</span>月有<span class="number">1</span>篇博文</span><br><span class="line"><span class="number">2021</span><span class="number">-04</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2018</span><span class="number">-09</span>月有<span class="number">6</span>篇博文</span><br><span class="line"><span class="number">2016</span><span class="number">-07</span>月有<span class="number">5</span>篇博文</span><br><span class="line"><span class="number">2021</span><span class="number">-08</span>月有<span class="number">4</span>篇博文</span><br><span class="line"><span class="number">2021</span><span class="number">-06</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2021</span><span class="number">-09</span>月有<span class="number">17</span>篇博文</span><br><span class="line"><span class="number">2012</span><span class="number">-12</span>月有<span class="number">2</span>篇博文</span><br><span class="line"><span class="number">2018</span><span class="number">-07</span>月有<span class="number">11</span>篇博文</span><br><span class="line"><span class="number">2018</span><span class="number">-04</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2020</span><span class="number">-02</span>月有<span class="number">9</span>篇博文</span><br><span class="line"><span class="number">2019</span><span class="number">-02</span>月有<span class="number">10</span>篇博文</span><br><span class="line"><span class="number">2010</span><span class="number">-03</span>月有<span class="number">9</span>篇博文</span><br><span class="line"><span class="number">2020</span><span class="number">-05</span>月有<span class="number">13</span>篇博文</span><br><span class="line"><span class="number">2015</span><span class="number">-07</span>月有<span class="number">2</span>篇博文</span><br><span class="line"><span class="number">2012</span><span class="number">-01</span>月有<span class="number">2</span>篇博文</span><br><span class="line"><span class="number">2019</span><span class="number">-05</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2016</span><span class="number">-02</span>月有<span class="number">3</span>篇博文</span><br><span class="line"><span class="number">2017</span><span class="number">-10</span>月有<span class="number">9</span>篇博文</span><br><span class="line"><span class="number">2021</span><span class="number">-03</span>月有<span class="number">7</span>篇博文</span><br><span class="line"><span class="number">2018</span><span class="number">-08</span>月有<span class="number">10</span>篇博文</span><br><span class="line"><span class="number">2016</span><span class="number">-08</span>月有<span class="number">4</span>篇博文</span><br><span class="line"><span class="number">2019</span><span class="number">-10</span>月有<span class="number">12</span>篇博文</span><br><span class="line"><span class="number">2020</span><span class="number">-10</span>月有<span class="number">10</span>篇博文</span><br><span class="line"><span class="number">2016</span><span class="number">-05</span>月有<span class="number">4</span>篇博文</span><br><span class="line"><span class="number">2017</span><span class="number">-08</span>月有<span class="number">6</span>篇博文</span><br><span class="line"><span class="number">2018</span><span class="number">-05</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2015</span><span class="number">-03</span>月有<span class="number">143</span>篇博文</span><br><span class="line"><span class="number">2015</span><span class="number">-04</span>月有<span class="number">3</span>篇博文</span><br><span class="line"><span class="number">2018</span><span class="number">-10</span>月有<span class="number">9</span>篇博文</span><br><span class="line"><span class="number">2021</span><span class="number">-01</span>月有<span class="number">10</span>篇博文</span><br><span class="line"><span class="number">2018</span><span class="number">-01</span>月有<span class="number">6</span>篇博文</span><br><span class="line"><span class="number">2014</span><span class="number">-03</span>月有<span class="number">4</span>篇博文</span><br><span class="line"><span class="number">2020</span><span class="number">-07</span>月有<span class="number">10</span>篇博文</span><br><span class="line"><span class="number">2017</span><span class="number">-03</span>月有<span class="number">9</span>篇博文</span><br><span class="line"><span class="number">2019</span><span class="number">-07</span>月有<span class="number">14</span>篇博文</span><br><span class="line"><span class="number">2014</span><span class="number">-04</span>月有<span class="number">1</span>篇博文</span><br><span class="line"><span class="number">2017</span><span class="number">-06</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2016</span><span class="number">-06</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2017</span><span class="number">-05</span>月有<span class="number">10</span>篇博文</span><br><span class="line"><span class="number">2017</span><span class="number">-02</span>月有<span class="number">9</span>篇博文</span><br><span class="line"><span class="number">2015</span><span class="number">-10</span>月有<span class="number">7</span>篇博文</span><br><span class="line"><span class="number">2012</span><span class="number">-11</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2021</span><span class="number">-05</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2018</span><span class="number">-02</span>月有<span class="number">7</span>篇博文</span><br><span class="line"><span class="number">2016</span><span class="number">-10</span>月有<span class="number">11</span>篇博文</span><br><span class="line"><span class="number">2020</span><span class="number">-01</span>月有<span class="number">9</span>篇博文</span><br><span class="line"><span class="number">2019</span><span class="number">-09</span>月有<span class="number">8</span>篇博文</span><br><span class="line"><span class="number">2015</span><span class="number">-12</span>月有<span class="number">5</span>篇博文</span><br><span class="line"><span class="number">2019</span><span class="number">-01</span>月有<span class="number">7</span>篇博文</span><br><span class="line"><span class="number">2020</span><span class="number">-09</span>月有<span class="number">10</span>篇博文</span><br><span class="line"><span class="number">2016</span><span class="number">-12</span>月有<span class="number">4</span>篇博文</span><br><span class="line"><span class="number">2018</span><span class="number">-12</span>月有<span class="number">5</span>篇博文</span><br></pre></td></tr></table></figure><p><br></p><p>几处可改进点：</p><ul><li><p>并发执行deal(),同时需使用sync.map</p></li><li><p>将乱序的map改成按序输出</p></li><li><p>可以将路径及处理的文件类型(此处为*.md),以及匹配的文本(此处为date:和tag:之间的内容), 做成参数形式传递,从而使该方法更通用</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;有插件可以将各个月份博文的数量统计并附在其后，不太喜欢这种展示方式(认为展示出的参差数据，破坏和谐一致的感觉)，自己动手，只统计不展示&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2021/10/11/统计某月有几篇博文/0.png&quot; width=&quot;50%&quot; height=&quot;100
      
    
    </summary>
    
    
      <category term="Tools" scheme="http://www.dashen.tech/tags/Tools/"/>
    
  </entry>
  
  <entry>
    <title>调试Go源代码</title>
    <link href="http://www.dashen.tech/2021/10/11/%E8%B0%83%E8%AF%95Go%E6%BA%90%E4%BB%A3%E7%A0%81/"/>
    <id>http://www.dashen.tech/2021/10/11/调试Go源代码/</id>
    <published>2021-10-11T13:16:38.000Z</published>
    <updated>2021-12-21T13:28:25.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="编译源码方式安装新版本Go"><a href="#编译源码方式安装新版本Go" class="headerlink" title="编译源码方式安装新版本Go"></a>编译源码方式安装新版本Go</h3><p><br></p><p>通过源代码编译安装<em><a href="https://github.com/golang/go/tags" target="_blank" rel="noopener">go1.18beta1</a></em>,</p><p><img src="/2021/10/11/调试Go源代码/0.png" width="90%" height="50%"></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/golang/go.git</span><br><span class="line"><span class="built_in">cd</span> go</span><br><span class="line">git reset --hard becaeea</span><br><span class="line"><span class="built_in">cd</span> src</span><br><span class="line">vim all.bash</span><br></pre></td></tr></table></figure><p><strong>all.bash</strong>内容如下：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"><span class="comment"># Copyright 2009 The Go Authors. All rights reserved.</span></span><br><span class="line"><span class="comment"># Use of this source code is governed by a BSD-style</span></span><br><span class="line"><span class="comment"># license that can be found in the LICENSE file.</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line"><span class="keyword">if</span> [ ! -f make.bash ]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'all.bash must be run from $GOROOT/src'</span> 1&gt;&amp;2</span><br><span class="line"><span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">OLDPATH=<span class="string">"<span class="variable">$PATH</span>"</span></span><br><span class="line">. ./make.bash <span class="string">"<span class="variable">$@</span>"</span> --no-banner</span><br><span class="line">bash run.bash --no-rebuild</span><br><span class="line">PATH=<span class="string">"<span class="variable">$OLDPATH</span>"</span></span><br><span class="line"><span class="variable">$GOTOOLDIR</span>/dist banner  <span class="comment"># print build info</span></span><br></pre></td></tr></table></figure><p>注释掉<code>bash run.bash --no-rebuild</code>这一行，这样每次构建时, 不需要重新跑一遍测试脚本，每次都要大概耗时5分钟</p><p><img src="/2021/10/11/调试Go源代码/3.png" width="90%" height="50%"></p><p><br></p><p>将<strong>make.bash</strong>的<code>./cmd/dist/dist bootstrap -a $vflag $GO_DISTFLAGS &quot;$@&quot;</code>替换为<code>./cmd/dist/dist bootstrap -a -v</code>, 默认 <code>-v</code> 标记不打开, 这样就看不到进度和错误提示</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">% vim make.bash</span><br><span class="line"><span class="comment"># 未替换之前的行</span></span><br><span class="line"><span class="comment"># ./cmd/dist/dist bootstrap -a $vflag $GO_DISTFLAGS "$@"</span></span><br><span class="line"><span class="comment"># 替换之后的行, -a 表示所有模块, -v 会输出任何错误提示</span></span><br><span class="line">./cmd/dist/dist bootstrap -a -v</span><br><span class="line"><span class="comment"># 如果只更改了某个包下的文件, 并不需要重新构建整个项目, 可只指定某一个目录</span></span><br><span class="line"><span class="comment"># ./cmd/dist/dist install  -v "runtime"</span></span><br></pre></td></tr></table></figure><p><br></p><details><br><summary><b>执行编译脚本 <code>./all.bash</code>:</b></summary><br><br><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br></pre></td><td class="code"><pre><span class="line">Building Go cmd/dist using /usr/local/<span class="keyword">go</span>. (go1<span class="number">.16</span><span class="number">.7</span> darwin/arm64)</span><br><span class="line">Building Go toolchain1 using /usr/local/<span class="keyword">go</span>.</span><br><span class="line">math/bits</span><br><span class="line">bootstrap/internal/goexperiment</span><br><span class="line">bootstrap/math/bits</span><br><span class="line">bootstrap/internal/unsafeheader</span><br><span class="line">bootstrap/internal/goversion</span><br><span class="line">bootstrap/internal/race</span><br><span class="line">bootstrap/cmd/compile/internal/test</span><br><span class="line">bootstrap/sort</span><br><span class="line">math</span><br><span class="line">bootstrap/container/heap</span><br><span class="line">math/rand</span><br><span class="line">bootstrap/strconv</span><br><span class="line">strconv</span><br><span class="line">io/ioutil</span><br><span class="line">os/exec</span><br><span class="line">reflect</span><br><span class="line">crypto</span><br><span class="line">regexp/syntax</span><br><span class="line">regexp</span><br><span class="line">encoding/binary</span><br><span class="line">fmt</span><br><span class="line">bootstrap/cmd/internal/sys</span><br><span class="line">encoding/base64</span><br><span class="line">crypto/sha256</span><br><span class="line">crypto/sha1</span><br><span class="line">crypto/md5</span><br><span class="line">flag</span><br><span class="line">bootstrap/cmd/internal/edit</span><br><span class="line">bootstrap/cmd/internal/pkgpath</span><br><span class="line">bootstrap/cmd/internal/bio</span><br><span class="line">bootstrap/cmd/internal/src</span><br><span class="line">bootstrap/internal/buildcfg</span><br><span class="line">bootstrap/debug/dwarf</span><br><span class="line">bootstrap/compress/flate</span><br><span class="line"><span class="keyword">go</span>/token</span><br><span class="line">encoding/json</span><br><span class="line">bootstrap/math/big</span><br><span class="line">net/url</span><br><span class="line">bootstrap/cmd/internal/quoted</span><br><span class="line">bootstrap/cmd/internal/objabi</span><br><span class="line">bootstrap/cmd/internal/gcprog</span><br><span class="line"><span class="keyword">go</span>/scanner</span><br><span class="line">bootstrap/cmd/compile/internal/syntax</span><br><span class="line">bootstrap/cmd/internal/dwarf</span><br><span class="line">text/template/parse</span><br><span class="line">bootstrap/cmd/internal/goobj</span><br><span class="line">bootstrap/cmd/asm/internal/flags</span><br><span class="line">bootstrap/compress/zlib</span><br><span class="line">bootstrap/cmd/asm/internal/lex</span><br><span class="line">bootstrap/cmd/internal/obj</span><br><span class="line"><span class="keyword">go</span>/ast</span><br><span class="line">bootstrap/cmd/internal/archive</span><br><span class="line">compress/flate</span><br><span class="line">bootstrap/debug/elf</span><br><span class="line">bootstrap/debug/macho</span><br><span class="line">bootstrap/debug/pe</span><br><span class="line">bootstrap/internal/xcoff</span><br><span class="line">compress/gzip</span><br><span class="line">bootstrap/cmd/internal/codesign</span><br><span class="line"><span class="keyword">go</span>/parser</span><br><span class="line"><span class="keyword">go</span>/printer</span><br><span class="line"><span class="keyword">go</span>/doc</span><br><span class="line">bootstrap/cmd/internal/obj/arm</span><br><span class="line">bootstrap/cmd/internal/obj/arm64</span><br><span class="line">bootstrap/cmd/internal/obj/mips</span><br><span class="line">bootstrap/cmd/internal/obj/ppc64</span><br><span class="line">bootstrap/cmd/internal/obj/riscv</span><br><span class="line">bootstrap/cmd/internal/obj/s390x</span><br><span class="line">bootstrap/cmd/internal/obj/wasm</span><br><span class="line">bootstrap/cmd/internal/obj/x86</span><br><span class="line">bootstrap/cmd/cgo</span><br><span class="line">bootstrap/cmd/compile/internal/base</span><br><span class="line">bootstrap/<span class="keyword">go</span>/constant</span><br><span class="line">bootstrap/cmd/compile/internal/logopt</span><br><span class="line">bootstrap/cmd/compile/internal/bitvec</span><br><span class="line"><span class="keyword">go</span>/build</span><br><span class="line">runtime/pprof</span><br><span class="line">bootstrap/cmd/link/internal/sym</span><br><span class="line">bootstrap/cmd/compile/internal/types</span><br><span class="line">bootstrap/cmd/compile/internal/types2</span><br><span class="line">bootstrap/cmd/link/internal/loader</span><br><span class="line">bootstrap/cmd/link/internal/dwtest</span><br><span class="line">bootstrap/cmd/link/internal/benchmark</span><br><span class="line">bootstrap/cmd/asm/internal/arch</span><br><span class="line">bootstrap/cmd/compile/internal/typebits</span><br><span class="line">bootstrap/cmd/compile/internal/ir</span><br><span class="line">bootstrap/cmd/link/internal/loadelf</span><br><span class="line">bootstrap/cmd/link/internal/loadpe</span><br><span class="line">bootstrap/cmd/link/internal/loadmacho</span><br><span class="line">bootstrap/cmd/asm/internal/asm</span><br><span class="line">bootstrap/cmd/link/internal/loadxcoff</span><br><span class="line">bootstrap/cmd/link/internal/ld</span><br><span class="line">bootstrap/cmd/asm</span><br><span class="line">bootstrap/cmd/compile/internal/objw</span><br><span class="line">bootstrap/cmd/compile/internal/abi</span><br><span class="line">bootstrap/cmd/compile/internal/deadcode</span><br><span class="line">bootstrap/cmd/compile/internal/typecheck</span><br><span class="line">bootstrap/cmd/compile/internal/importer</span><br><span class="line">bootstrap/cmd/link/internal/amd64</span><br><span class="line">bootstrap/cmd/link/internal/arm</span><br><span class="line">bootstrap/cmd/link/internal/arm64</span><br><span class="line">bootstrap/cmd/link/internal/riscv64</span><br><span class="line">bootstrap/cmd/link/internal/mips</span><br><span class="line">bootstrap/cmd/link/internal/ppc64</span><br><span class="line">bootstrap/cmd/link/internal/mips64</span><br><span class="line">bootstrap/cmd/link/internal/s390x</span><br><span class="line">bootstrap/cmd/link/internal/wasm</span><br><span class="line">bootstrap/cmd/link/internal/x86</span><br><span class="line">bootstrap/cmd/link</span><br><span class="line">bootstrap/cmd/compile/internal/inline</span><br><span class="line">bootstrap/cmd/compile/internal/devirtualize</span><br><span class="line">bootstrap/cmd/compile/internal/staticdata</span><br><span class="line">bootstrap/cmd/compile/internal/escape</span><br><span class="line">bootstrap/cmd/compile/internal/reflectdata</span><br><span class="line">bootstrap/cmd/compile/internal/staticinit</span><br><span class="line">bootstrap/cmd/compile/internal/ssa</span><br><span class="line">bootstrap/cmd/compile/internal/pkginit</span><br><span class="line">bootstrap/cmd/compile/internal/liveness</span><br><span class="line">bootstrap/cmd/compile/internal/ssagen</span><br><span class="line">bootstrap/cmd/compile/internal/amd64</span><br><span class="line">bootstrap/cmd/compile/internal/mips</span><br><span class="line">bootstrap/cmd/compile/internal/ppc64</span><br><span class="line">bootstrap/cmd/compile/internal/arm64</span><br><span class="line">bootstrap/cmd/compile/internal/dwarfgen</span><br><span class="line">bootstrap/cmd/compile/internal/arm</span><br><span class="line">bootstrap/cmd/compile/internal/mips64</span><br><span class="line">bootstrap/cmd/compile/internal/walk</span><br><span class="line">bootstrap/cmd/compile/internal/riscv64</span><br><span class="line">bootstrap/cmd/compile/internal/s390x</span><br><span class="line">bootstrap/cmd/compile/internal/wasm</span><br><span class="line">bootstrap/cmd/compile/internal/x86</span><br><span class="line">bootstrap/cmd/compile/internal/noder</span><br><span class="line">bootstrap/cmd/compile/internal/gc</span><br><span class="line">bootstrap/cmd/compile</span><br><span class="line"></span><br><span class="line">Building Go bootstrap cmd/<span class="keyword">go</span> (go_bootstrap) using Go toolchain1.</span><br><span class="line">runtime</span><br><span class="line">internal/abi</span><br><span class="line">runtime/internal/math</span><br><span class="line">runtime/internal/sys</span><br><span class="line">internal/goexperiment</span><br><span class="line">internal/cpu</span><br><span class="line">runtime/internal/atomic</span><br><span class="line">internal/goos</span><br><span class="line">internal/goarch</span><br><span class="line">internal/bytealg</span><br><span class="line">cmd/<span class="keyword">go</span></span><br><span class="line">cmd/<span class="keyword">go</span>/internal/run</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/fmtcmd</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/tool</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/trace</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modget</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/envcmd</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/clean</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/version</span><br><span class="line">errors</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/help</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/lockedfile</span><br><span class="line">os/signal</span><br><span class="line">cmd/internal/traceviewer</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/str</span><br><span class="line">debug/buildinfo</span><br><span class="line">unicode</span><br><span class="line">regexp</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/workcmd</span><br><span class="line">internal/reflectlite</span><br><span class="line">fmt</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/lockedfile/internal/filelock</span><br><span class="line">internal/xcoff</span><br><span class="line">context</span><br><span class="line">syscall</span><br><span class="line">internal/unsafeheader</span><br><span class="line">debug/dwarf</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/test</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/bug</span><br><span class="line">strings</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/get</span><br><span class="line">bufio</span><br><span class="line">io/fs</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/search</span><br><span class="line">os</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/work</span><br><span class="line">strconv</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modfetch</span><br><span class="line">log</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/generate</span><br><span class="line">internal/execabs</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modload</span><br><span class="line">sync/atomic</span><br><span class="line">cmd/vendor/golang.org/x/mod/modfile</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modcmd</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/cache</span><br><span class="line">text/template</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/doc</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/list</span><br><span class="line">encoding/json</span><br><span class="line">unicode/utf8</span><br><span class="line">io</span><br><span class="line"><span class="keyword">go</span>/build</span><br><span class="line">cmd/internal/quoted</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/fsys</span><br><span class="line">sort</span><br><span class="line">bytes</span><br><span class="line">sync</span><br><span class="line">path/filepath</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/web</span><br><span class="line">net/url</span><br><span class="line">reflect</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/fix</span><br><span class="line">internal/buildcfg</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/vcs</span><br><span class="line">debug/elf</span><br><span class="line">os/exec</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/base</span><br><span class="line">debug/macho</span><br><span class="line">runtime/debug</span><br><span class="line">encoding/hex</span><br><span class="line"><span class="keyword">go</span>/token</span><br><span class="line">debug/pe</span><br><span class="line"><span class="keyword">go</span>/parser</span><br><span class="line">crypto/sha256</span><br><span class="line">hash</span><br><span class="line">encoding/binary</span><br><span class="line">cmd/vendor/golang.org/x/mod/sumdb/dirhash</span><br><span class="line">encoding/base64</span><br><span class="line">archive/zip</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/vet</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/cfg</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/load</span><br><span class="line">cmd/internal/sys</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/cmdflag</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/par</span><br><span class="line">math</span><br><span class="line">internal/cfg</span><br><span class="line">cmd/vendor/golang.org/x/mod/semver</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/imports</span><br><span class="line">cmd/vendor/golang.org/x/mod/module</span><br><span class="line"><span class="keyword">go</span>/scanner</span><br><span class="line"><span class="keyword">go</span>/internal/typeparams</span><br><span class="line"><span class="keyword">go</span>/ast</span><br><span class="line"><span class="keyword">go</span>/build/constraint</span><br><span class="line">unicode/utf16</span><br><span class="line">internal/goversion</span><br><span class="line">encoding</span><br><span class="line"><span class="keyword">go</span>/doc</span><br><span class="line">internal/goroot</span><br><span class="line">io/ioutil</span><br><span class="line">internal/syscall/execenv</span><br><span class="line">flag</span><br><span class="line">path</span><br><span class="line">time</span><br><span class="line">internal/fmtsort</span><br><span class="line">encoding/xml</span><br><span class="line">internal/singleflight</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modinfo</span><br><span class="line">internal/lazytemplate</span><br><span class="line">math/bits</span><br><span class="line">crypto</span><br><span class="line">math/rand</span><br><span class="line">hash/crc32</span><br><span class="line">compress/flate</span><br><span class="line">cmd/vendor/golang.org/x/xerrors</span><br><span class="line">internal/lazyregexp</span><br><span class="line">internal/race</span><br><span class="line">internal/oserror</span><br><span class="line">cmd/vendor/golang.org/x/mod/internal/lazyregexp</span><br><span class="line">cmd/vendor/golang.org/x/xerrors/internal</span><br><span class="line">regexp/syntax</span><br><span class="line">text/template/parse</span><br><span class="line">internal/itoa</span><br><span class="line">cmd/internal/test2json</span><br><span class="line">compress/zlib</span><br><span class="line">hash/adler32</span><br><span class="line">cmd/internal/pkgpath</span><br><span class="line">crypto/sha1</span><br><span class="line">cmd/internal/buildid</span><br><span class="line">cmd/vendor/golang.org/x/mod/zip</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/robustio</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modfetch/codehost</span><br><span class="line">cmd/internal/codesign</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/mvs</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modconv</span><br><span class="line">container/heap</span><br><span class="line">cmd/internal/objabi</span><br><span class="line">internal/poll</span><br><span class="line">internal/testlog</span><br><span class="line">internal/syscall/unix</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Building Go toolchain2 using go_bootstrap and Go toolchain1.</span><br><span class="line">internal/race</span><br><span class="line">internal/unsafeheader</span><br><span class="line">internal/goarch</span><br><span class="line">internal/goexperiment</span><br><span class="line">internal/goos</span><br><span class="line">unicode</span><br><span class="line">internal/cpu</span><br><span class="line">sync/atomic</span><br><span class="line">unicode/utf8</span><br><span class="line">internal/abi</span><br><span class="line">runtime/internal/math</span><br><span class="line">internal/itoa</span><br><span class="line">runtime/internal/sys</span><br><span class="line">math/bits</span><br><span class="line">encoding</span><br><span class="line">unicode/utf16</span><br><span class="line">internal/goversion</span><br><span class="line">internal/bytealg</span><br><span class="line">runtime/internal/atomic</span><br><span class="line">math</span><br><span class="line">runtime</span><br><span class="line">internal/reflectlite</span><br><span class="line">sync</span><br><span class="line">internal/testlog</span><br><span class="line">math/rand</span><br><span class="line">errors</span><br><span class="line">sort</span><br><span class="line">internal/oserror</span><br><span class="line">path</span><br><span class="line">io</span><br><span class="line">strconv</span><br><span class="line">container/heap</span><br><span class="line">syscall</span><br><span class="line">bytes</span><br><span class="line">hash</span><br><span class="line">text/tabwriter</span><br><span class="line">strings</span><br><span class="line">hash/adler32</span><br><span class="line">hash/crc32</span><br><span class="line">reflect</span><br><span class="line">crypto</span><br><span class="line">bufio</span><br><span class="line"><span class="keyword">go</span>/build/constraint</span><br><span class="line">regexp/syntax</span><br><span class="line">html</span><br><span class="line">internal/syscall/execenv</span><br><span class="line">internal/syscall/unix</span><br><span class="line">time</span><br><span class="line">regexp</span><br><span class="line">context</span><br><span class="line">internal/poll</span><br><span class="line">io/fs</span><br><span class="line">os</span><br><span class="line">internal/fmtsort</span><br><span class="line">encoding/binary</span><br><span class="line">cmd/internal/sys</span><br><span class="line">crypto/sha1</span><br><span class="line">encoding/base64</span><br><span class="line">crypto/md5</span><br><span class="line">crypto/sha256</span><br><span class="line">io/ioutil</span><br><span class="line">fmt</span><br><span class="line">path/filepath</span><br><span class="line">internal/lazyregexp</span><br><span class="line">os/exec</span><br><span class="line">log</span><br><span class="line">internal/execabs</span><br><span class="line">flag</span><br><span class="line">internal/buildcfg</span><br><span class="line">cmd/internal/edit</span><br><span class="line">cmd/internal/src</span><br><span class="line">text/scanner</span><br><span class="line">debug/dwarf</span><br><span class="line">cmd/internal/pkgpath</span><br><span class="line">compress/flate</span><br><span class="line">cmd/internal/bio</span><br><span class="line"><span class="keyword">go</span>/token</span><br><span class="line">encoding/json</span><br><span class="line">runtime/debug</span><br><span class="line">math/big</span><br><span class="line">net/url</span><br><span class="line"><span class="keyword">go</span>/scanner</span><br><span class="line">cmd/internal/gcprog</span><br><span class="line">encoding/hex</span><br><span class="line"><span class="keyword">go</span>/ast</span><br><span class="line">cmd/compile/internal/syntax</span><br><span class="line">cmd/internal/objabi</span><br><span class="line">cmd/internal/quoted</span><br><span class="line">compress/zlib</span><br><span class="line">text/template/parse</span><br><span class="line">internal/goroot</span><br><span class="line">cmd/internal/dwarf</span><br><span class="line">cmd/internal/goobj</span><br><span class="line">cmd/asm/internal/flags</span><br><span class="line">cmd/internal/obj</span><br><span class="line">cmd/asm/internal/lex</span><br><span class="line"><span class="keyword">go</span>/internal/typeparams</span><br><span class="line"><span class="keyword">go</span>/parser</span><br><span class="line"><span class="keyword">go</span>/printer</span><br><span class="line">cmd/internal/archive</span><br><span class="line">compress/gzip</span><br><span class="line">runtime/pprof</span><br><span class="line">text/template</span><br><span class="line">debug/elf</span><br><span class="line">debug/macho</span><br><span class="line">debug/pe</span><br><span class="line">internal/xcoff</span><br><span class="line"><span class="keyword">go</span>/constant</span><br><span class="line">runtime/trace</span><br><span class="line">cmd/link/internal/benchmark</span><br><span class="line">cmd/internal/codesign</span><br><span class="line">cmd/cgo</span><br><span class="line">cmd/internal/obj/arm</span><br><span class="line">cmd/internal/obj/mips</span><br><span class="line">cmd/internal/obj/riscv</span><br><span class="line">cmd/internal/obj/ppc64</span><br><span class="line">cmd/internal/obj/arm64</span><br><span class="line">cmd/internal/obj/s390x</span><br><span class="line">cmd/internal/obj/wasm</span><br><span class="line">cmd/internal/obj/x86</span><br><span class="line">cmd/compile/internal/base</span><br><span class="line">cmd/compile/internal/logopt</span><br><span class="line">cmd/compile/internal/types2</span><br><span class="line">cmd/compile/internal/types</span><br><span class="line">cmd/compile/internal/bitvec</span><br><span class="line"><span class="keyword">go</span>/doc</span><br><span class="line"><span class="keyword">go</span>/build</span><br><span class="line">cmd/compile/internal/ir</span><br><span class="line">cmd/compile/internal/typebits</span><br><span class="line">cmd/link/internal/sym</span><br><span class="line">cmd/link/internal/loader</span><br><span class="line">cmd/asm/internal/arch</span><br><span class="line">cmd/link/internal/loadelf</span><br><span class="line">cmd/link/internal/loadpe</span><br><span class="line">cmd/link/internal/loadmacho</span><br><span class="line">cmd/link/internal/loadxcoff</span><br><span class="line">cmd/asm/internal/asm</span><br><span class="line">cmd/link/internal/ld</span><br><span class="line">cmd/asm</span><br><span class="line">cmd/compile/internal/objw</span><br><span class="line">cmd/compile/internal/deadcode</span><br><span class="line">cmd/compile/internal/abi</span><br><span class="line">cmd/compile/internal/typecheck</span><br><span class="line">cmd/compile/internal/importer</span><br><span class="line">cmd/link/internal/mips</span><br><span class="line">cmd/link/internal/mips64</span><br><span class="line">cmd/link/internal/arm</span><br><span class="line">cmd/link/internal/arm64</span><br><span class="line">cmd/link/internal/amd64</span><br><span class="line">cmd/link/internal/ppc64</span><br><span class="line">cmd/compile/internal/escape</span><br><span class="line">cmd/compile/internal/inline</span><br><span class="line">cmd/compile/internal/staticdata</span><br><span class="line">cmd/compile/internal/devirtualize</span><br><span class="line">cmd/link/internal/riscv64</span><br><span class="line">cmd/link/internal/s390x</span><br><span class="line">cmd/link/internal/wasm</span><br><span class="line">cmd/link/internal/x86</span><br><span class="line">cmd/link</span><br><span class="line">cmd/compile/internal/reflectdata</span><br><span class="line">cmd/compile/internal/staticinit</span><br><span class="line">cmd/compile/internal/ssa</span><br><span class="line">cmd/compile/internal/pkginit</span><br><span class="line">cmd/compile/internal/liveness</span><br><span class="line">cmd/compile/internal/ssagen</span><br><span class="line">cmd/compile/internal/mips</span><br><span class="line">cmd/compile/internal/amd64</span><br><span class="line">cmd/compile/internal/arm</span><br><span class="line">cmd/compile/internal/mips64</span><br><span class="line">cmd/compile/internal/arm64</span><br><span class="line">cmd/compile/internal/dwarfgen</span><br><span class="line">cmd/compile/internal/ppc64</span><br><span class="line">cmd/compile/internal/walk</span><br><span class="line">cmd/compile/internal/riscv64</span><br><span class="line">cmd/compile/internal/s390x</span><br><span class="line">cmd/compile/internal/wasm</span><br><span class="line">cmd/compile/internal/noder</span><br><span class="line">cmd/compile/internal/x86</span><br><span class="line">cmd/compile/internal/gc</span><br><span class="line">cmd/compile</span><br><span class="line"></span><br><span class="line">Building Go toolchain3 using go_bootstrap and Go toolchain2.</span><br><span class="line">internal/unsafeheader</span><br><span class="line">internal/goos</span><br><span class="line">internal/goarch</span><br><span class="line">unicode</span><br><span class="line">internal/race</span><br><span class="line">internal/goexperiment</span><br><span class="line">unicode/utf8</span><br><span class="line">internal/itoa</span><br><span class="line">runtime/internal/math</span><br><span class="line">runtime/internal/sys</span><br><span class="line">math/bits</span><br><span class="line">encoding</span><br><span class="line">unicode/utf16</span><br><span class="line">internal/goversion</span><br><span class="line">sync/atomic</span><br><span class="line">internal/abi</span><br><span class="line">internal/cpu</span><br><span class="line">math</span><br><span class="line">runtime/internal/atomic</span><br><span class="line">internal/bytealg</span><br><span class="line">runtime</span><br><span class="line">sync</span><br><span class="line">internal/reflectlite</span><br><span class="line">internal/testlog</span><br><span class="line">math/rand</span><br><span class="line">errors</span><br><span class="line">sort</span><br><span class="line">internal/oserror</span><br><span class="line">path</span><br><span class="line">io</span><br><span class="line">strconv</span><br><span class="line">container/heap</span><br><span class="line">syscall</span><br><span class="line">text/tabwriter</span><br><span class="line">bytes</span><br><span class="line">hash</span><br><span class="line">strings</span><br><span class="line">hash/adler32</span><br><span class="line">hash/crc32</span><br><span class="line">reflect</span><br><span class="line">crypto</span><br><span class="line"><span class="keyword">go</span>/build/constraint</span><br><span class="line">bufio</span><br><span class="line">html</span><br><span class="line">regexp/syntax</span><br><span class="line">internal/syscall/unix</span><br><span class="line">time</span><br><span class="line">internal/syscall/execenv</span><br><span class="line">regexp</span><br><span class="line">context</span><br><span class="line">internal/poll</span><br><span class="line">io/fs</span><br><span class="line">os</span><br><span class="line">internal/fmtsort</span><br><span class="line">encoding/binary</span><br><span class="line">internal/lazyregexp</span><br><span class="line">fmt</span><br><span class="line">path/filepath</span><br><span class="line">io/ioutil</span><br><span class="line">crypto/sha1</span><br><span class="line">crypto/md5</span><br><span class="line">encoding/base64</span><br><span class="line">cmd/internal/sys</span><br><span class="line">crypto/sha256</span><br><span class="line">os/exec</span><br><span class="line">log</span><br><span class="line">flag</span><br><span class="line">cmd/internal/src</span><br><span class="line">text/scanner</span><br><span class="line">cmd/internal/edit</span><br><span class="line">internal/buildcfg</span><br><span class="line">debug/dwarf</span><br><span class="line">internal/execabs</span><br><span class="line">compress/flate</span><br><span class="line"><span class="keyword">go</span>/token</span><br><span class="line">cmd/internal/bio</span><br><span class="line">encoding/json</span><br><span class="line">cmd/internal/pkgpath</span><br><span class="line">cmd/internal/objabi</span><br><span class="line">cmd/internal/quoted</span><br><span class="line"><span class="keyword">go</span>/scanner</span><br><span class="line">runtime/debug</span><br><span class="line">math/big</span><br><span class="line">cmd/internal/dwarf</span><br><span class="line">cmd/asm/internal/flags</span><br><span class="line">cmd/internal/goobj</span><br><span class="line">cmd/asm/internal/lex</span><br><span class="line"><span class="keyword">go</span>/ast</span><br><span class="line">net/url</span><br><span class="line">cmd/internal/gcprog</span><br><span class="line">encoding/hex</span><br><span class="line">cmd/compile/internal/syntax</span><br><span class="line">text/template/parse</span><br><span class="line">cmd/internal/obj</span><br><span class="line">compress/zlib</span><br><span class="line">internal/goroot</span><br><span class="line"><span class="keyword">go</span>/internal/typeparams</span><br><span class="line"><span class="keyword">go</span>/printer</span><br><span class="line"><span class="keyword">go</span>/parser</span><br><span class="line">debug/elf</span><br><span class="line">debug/macho</span><br><span class="line">debug/pe</span><br><span class="line">internal/xcoff</span><br><span class="line">cmd/internal/archive</span><br><span class="line">compress/gzip</span><br><span class="line">runtime/trace</span><br><span class="line">runtime/pprof</span><br><span class="line">cmd/internal/codesign</span><br><span class="line">text/template</span><br><span class="line">cmd/internal/obj/arm</span><br><span class="line">cmd/internal/obj/arm64</span><br><span class="line">cmd/internal/obj/mips</span><br><span class="line">cmd/internal/obj/ppc64</span><br><span class="line">cmd/internal/obj/riscv</span><br><span class="line">cmd/internal/obj/s390x</span><br><span class="line">cmd/internal/obj/wasm</span><br><span class="line">cmd/internal/obj/x86</span><br><span class="line">cmd/cgo</span><br><span class="line">cmd/compile/internal/base</span><br><span class="line"><span class="keyword">go</span>/constant</span><br><span class="line">cmd/compile/internal/logopt</span><br><span class="line"><span class="keyword">go</span>/doc</span><br><span class="line">cmd/compile/internal/types2</span><br><span class="line">cmd/compile/internal/types</span><br><span class="line">cmd/compile/internal/bitvec</span><br><span class="line"><span class="keyword">go</span>/build</span><br><span class="line">cmd/link/internal/benchmark</span><br><span class="line">cmd/link/internal/sym</span><br><span class="line">cmd/compile/internal/ir</span><br><span class="line">cmd/compile/internal/typebits</span><br><span class="line">cmd/link/internal/loader</span><br><span class="line">cmd/link/internal/loadelf</span><br><span class="line">cmd/link/internal/loadxcoff</span><br><span class="line">cmd/link/internal/loadpe</span><br><span class="line">cmd/link/internal/loadmacho</span><br><span class="line">cmd/asm/internal/arch</span><br><span class="line">cmd/link/internal/ld</span><br><span class="line">cmd/asm/internal/asm</span><br><span class="line">cmd/asm</span><br><span class="line">cmd/compile/internal/deadcode</span><br><span class="line">cmd/compile/internal/abi</span><br><span class="line">cmd/compile/internal/typecheck</span><br><span class="line">cmd/compile/internal/objw</span><br><span class="line">cmd/compile/internal/importer</span><br><span class="line">cmd/link/internal/arm64</span><br><span class="line">cmd/link/internal/arm</span><br><span class="line">cmd/link/internal/mips</span><br><span class="line">cmd/link/internal/mips64</span><br><span class="line">cmd/link/internal/amd64</span><br><span class="line">cmd/link/internal/ppc64</span><br><span class="line">cmd/link/internal/riscv64</span><br><span class="line">cmd/link/internal/s390x</span><br><span class="line">cmd/link/internal/wasm</span><br><span class="line">cmd/link/internal/x86</span><br><span class="line">cmd/link</span><br><span class="line">cmd/compile/internal/escape</span><br><span class="line">cmd/compile/internal/inline</span><br><span class="line">cmd/compile/internal/devirtualize</span><br><span class="line">cmd/compile/internal/staticdata</span><br><span class="line">cmd/compile/internal/reflectdata</span><br><span class="line">cmd/compile/internal/staticinit</span><br><span class="line">cmd/compile/internal/ssa</span><br><span class="line">cmd/compile/internal/pkginit</span><br><span class="line">cmd/compile/internal/liveness</span><br><span class="line">cmd/compile/internal/ssagen</span><br><span class="line">cmd/compile/internal/mips</span><br><span class="line">cmd/compile/internal/arm64</span><br><span class="line">cmd/compile/internal/dwarfgen</span><br><span class="line">cmd/compile/internal/arm</span><br><span class="line">cmd/compile/internal/amd64</span><br><span class="line">cmd/compile/internal/mips64</span><br><span class="line">cmd/compile/internal/ppc64</span><br><span class="line">cmd/compile/internal/walk</span><br><span class="line">cmd/compile/internal/riscv64</span><br><span class="line">cmd/compile/internal/s390x</span><br><span class="line">cmd/compile/internal/wasm</span><br><span class="line">cmd/compile/internal/x86</span><br><span class="line">cmd/compile/internal/noder</span><br><span class="line">cmd/compile/internal/gc</span><br><span class="line">cmd/compile</span><br><span class="line"></span><br><span class="line">Building packages and commands <span class="keyword">for</span> darwin/arm64.</span><br><span class="line">container/list</span><br><span class="line">constraints</span><br><span class="line">container/ring</span><br><span class="line">crypto/internal/subtle</span><br><span class="line">crypto/subtle</span><br><span class="line">vendor/golang.org/x/crypto/cryptobyte/asn1</span><br><span class="line">internal/nettrace</span><br><span class="line">compress/bzip2</span><br><span class="line">debug/plan9obj</span><br><span class="line">debug/gosym</span><br><span class="line">cmd/vendor/golang.org/x/arch/ppc64/ppc64asm</span><br><span class="line">cmd/vendor/golang.org/x/arch/arm/armasm</span><br><span class="line">cmd/vendor/golang.org/x/arch/arm64/arm64asm</span><br><span class="line">cmd/vendor/golang.org/x/arch/x86/x86asm</span><br><span class="line">archive/zip</span><br><span class="line">compress/lzw</span><br><span class="line">crypto/cipher</span><br><span class="line">crypto/internal/randutil</span><br><span class="line">crypto/dsa</span><br><span class="line">crypto/aes</span><br><span class="line">crypto/des</span><br><span class="line">crypto/sha512</span><br><span class="line">crypto/elliptic/internal/fiat</span><br><span class="line">encoding/asn1</span><br><span class="line">crypto/rand</span><br><span class="line">crypto/ed25519/internal/edwards25519/field</span><br><span class="line">crypto/hmac</span><br><span class="line">crypto/rc4</span><br><span class="line">vendor/golang.org/x/crypto/cryptobyte</span><br><span class="line">crypto/ed25519/internal/edwards25519</span><br><span class="line">crypto/rsa</span><br><span class="line">crypto/x509/internal/macos</span><br><span class="line">crypto/ed25519</span><br><span class="line">crypto/x509/pkix</span><br><span class="line">encoding/pem</span><br><span class="line">internal/godebug</span><br><span class="line">vendor/golang.org/x/net/dns/dnsmessage</span><br><span class="line">vendor/golang.org/x/net/route</span><br><span class="line">internal/intern</span><br><span class="line">internal/singleflight</span><br><span class="line">vendor/golang.org/x/crypto/internal/subtle</span><br><span class="line">vendor/golang.org/x/crypto/internal/poly1305</span><br><span class="line">vendor/golang.org/x/crypto/chacha20</span><br><span class="line">net/netip</span><br><span class="line">vendor/golang.org/x/crypto/curve25519/internal/field</span><br><span class="line">runtime/cgo</span><br><span class="line">vendor/golang.org/x/crypto/chacha20poly1305</span><br><span class="line">vendor/golang.org/x/crypto/hkdf</span><br><span class="line">database/sql/driver</span><br><span class="line">embed</span><br><span class="line">vendor/golang.org/x/crypto/curve25519</span><br><span class="line">cmd/internal/objfile</span><br><span class="line">debug/buildinfo</span><br><span class="line">database/sql</span><br><span class="line">crypto/elliptic/internal/nistec</span><br><span class="line">encoding/ascii85</span><br><span class="line">encoding/base32</span><br><span class="line">encoding/csv</span><br><span class="line">encoding/gob</span><br><span class="line">encoding/xml</span><br><span class="line">vendor/golang.org/x/text/transform</span><br><span class="line">crypto/elliptic</span><br><span class="line">vendor/golang.org/x/text/unicode/bidi</span><br><span class="line">cmd/addr2line</span><br><span class="line">vendor/golang.org/x/text/unicode/norm</span><br><span class="line">vendor/golang.org/x/text/secure/bidirule</span><br><span class="line">vendor/golang.org/x/net/http2/hpack</span><br><span class="line">mime</span><br><span class="line">mime/quotedprintable</span><br><span class="line">net/http/internal</span><br><span class="line">net/http/internal/ascii</span><br><span class="line"><span class="keyword">go</span>/format</span><br><span class="line"><span class="keyword">go</span>/types</span><br><span class="line">hash/crc64</span><br><span class="line">hash/fnv</span><br><span class="line">hash/maphash</span><br><span class="line">html/template</span><br><span class="line">image/color</span><br><span class="line">index/suffixarray</span><br><span class="line">internal/cfg</span><br><span class="line">internal/fuzz</span><br><span class="line">image</span><br><span class="line">image/color/palette</span><br><span class="line">internal/lazytemplate</span><br><span class="line">internal/obscuretestdata</span><br><span class="line">image/internal/imageutil</span><br><span class="line">internal/profile</span><br><span class="line">image/draw</span><br><span class="line">os/user</span><br><span class="line">net</span><br><span class="line">image/gif</span><br><span class="line">vendor/golang.org/x/net/idna</span><br><span class="line">image/jpeg</span><br><span class="line">image/png</span><br><span class="line">internal/sysinfo</span><br><span class="line">testing</span><br><span class="line">internal/trace</span><br><span class="line">math/cmplx</span><br><span class="line">net/http/internal/testcert</span><br><span class="line">net/internal/socktest</span><br><span class="line">os/exec/internal/fdtest</span><br><span class="line">os/signal</span><br><span class="line">os/signal/internal/pty</span><br><span class="line">plugin</span><br><span class="line">reflect/internal/example1</span><br><span class="line">reflect/internal/example2</span><br><span class="line">runtime/metrics</span><br><span class="line">runtime/race</span><br><span class="line">testing/iotest</span><br><span class="line">internal/testenv</span><br><span class="line">testing/fstest</span><br><span class="line">testing/internal/testdeps</span><br><span class="line">testing/quick</span><br><span class="line">time/tzdata</span><br><span class="line">vendor/golang.org/x/sys/cpu</span><br><span class="line">cmd/internal/buildid</span><br><span class="line">cmd/buildid</span><br><span class="line">cmd/compile/internal/test</span><br><span class="line">cmd/internal/browser</span><br><span class="line">cmd/vendor/golang.org/x/tools/cover</span><br><span class="line">cmd/dist</span><br><span class="line">cmd/vendor/golang.org/x/mod/semver</span><br><span class="line">cmd/cover</span><br><span class="line">cmd/doc</span><br><span class="line">cmd/internal/diff</span><br><span class="line">cmd/fix</span><br><span class="line">archive/tar</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/str</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/fsys</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/lockedfile/internal/filelock</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/cfg</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/lockedfile</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/par</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/base</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/imports</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/robustio</span><br><span class="line">cmd/internal/traceviewer</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/cache</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/search</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/trace</span><br><span class="line">cmd/vendor/golang.org/x/mod/internal/lazyregexp</span><br><span class="line">cmd/vendor/golang.org/x/xerrors/internal</span><br><span class="line">cmd/vendor/golang.org/x/crypto/ed25519</span><br><span class="line">cmd/vendor/golang.org/x/mod/sumdb/tlog</span><br><span class="line">cmd/vendor/golang.org/x/xerrors</span><br><span class="line">cmd/vendor/golang.org/x/mod/sumdb/dirhash</span><br><span class="line">crypto/ecdsa</span><br><span class="line">cmd/vendor/golang.org/x/mod/sumdb/note</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modinfo</span><br><span class="line">cmd/vendor/golang.org/x/mod/module</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/doc</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/cmdflag</span><br><span class="line">cmd/internal/test2json</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/tool</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/version</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/test/internal/genflags</span><br><span class="line">cmd/vendor/golang.org/x/sync/semaphore</span><br><span class="line">cmd/vendor/golang.org/x/mod/zip</span><br><span class="line">cmd/vendor/golang.org/x/mod/modfile</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/mvs</span><br><span class="line">cmd/gofmt</span><br><span class="line">cmd/link/internal/dwtest</span><br><span class="line">cmd/nm</span><br><span class="line">cmd/objdump</span><br><span class="line">cmd/pack</span><br><span class="line">cmd/vendor/github.com/google/pprof/internal/elfexec</span><br><span class="line">cmd/vendor/github.com/google/pprof/profile</span><br><span class="line">cmd/vendor/github.com/ianlancetaylor/demangle</span><br><span class="line">cmd/vendor/github.com/google/pprof/third_party/d3</span><br><span class="line">cmd/vendor/github.com/google/pprof/third_party/d3flamegraph</span><br><span class="line">cmd/vendor/github.com/google/pprof/third_party/svgpan</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modconv</span><br><span class="line">cmd/vendor/golang.org/x/sys/internal/unsafeheader</span><br><span class="line">cmd/test2json</span><br><span class="line">cmd/vendor/golang.org/x/sys/unix</span><br><span class="line">cmd/vendor/golang.org/x/crypto/ed25519/internal/edwards25519</span><br><span class="line">cmd/vendor/golang.org/x/tools/internal/lsp/fuzzy</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/cfg</span><br><span class="line">cmd/vendor/golang.org/x/tools/txtar</span><br><span class="line">vendor/golang.org/x/net/http/httpproxy</span><br><span class="line">log/syslog</span><br><span class="line">net/textproto</span><br><span class="line">crypto/x509</span><br><span class="line">vendor/golang.org/x/net/nettest</span><br><span class="line">vendor/golang.org/x/net/http/httpguts</span><br><span class="line">mime/multipart</span><br><span class="line">net/mail</span><br><span class="line">cmd/vendor/golang.org/x/term</span><br><span class="line">cmd/vendor/github.com/google/pprof/internal/measurement</span><br><span class="line">cmd/vendor/github.com/google/pprof/internal/graph</span><br><span class="line">crypto/tls</span><br><span class="line"><span class="keyword">go</span>/internal/srcimporter</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/internal/analysisutil</span><br><span class="line">cmd/vendor/golang.org/x/tools/internal/typeparams</span><br><span class="line"><span class="keyword">go</span>/internal/gccgoimporter</span><br><span class="line">cmd/api</span><br><span class="line"><span class="keyword">go</span>/internal/gcimporter</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/ast/astutil</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/ast/inspector</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/types/objectpath</span><br><span class="line"><span class="keyword">go</span>/importer</span><br><span class="line">cmd/vendor/golang.org/x/tools/internal/analysisinternal</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/types/typeutil</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/internal/analysisflags</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/buildtag</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/inspect</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/internal/facts</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/asmdecl</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/cgocall</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/framepointer</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/assign</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/atomic</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/bools</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/composite</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/copylock</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/ctrlflow</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/errorsas</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/httpresponse</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/ifaceassert</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/loopclosure</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/nilfunc</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/printf</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/lostcancel</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/shift</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/sigchanyzer</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/stdmethods</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/stringintconv</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/structtag</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/testinggoroutine</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/tests</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/unmarshal</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/unreachable</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/unsafeptr</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/passes/unusedresult</span><br><span class="line">cmd/vendor/golang.org/x/tools/<span class="keyword">go</span>/analysis/unitchecker</span><br><span class="line">cmd/vet</span><br><span class="line">net/http/httptrace</span><br><span class="line">net/smtp</span><br><span class="line">net/http</span><br><span class="line">expvar</span><br><span class="line">net/http/cgi</span><br><span class="line">net/http/httptest</span><br><span class="line">net/http/cookiejar</span><br><span class="line">net/http/pprof</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/auth</span><br><span class="line">net/rpc</span><br><span class="line">net/http/httputil</span><br><span class="line">cmd/vendor/golang.org/x/mod/sumdb</span><br><span class="line">cmd/vendor/github.com/google/pprof/internal/plugin</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/web</span><br><span class="line">cmd/trace</span><br><span class="line">net/http/fcgi</span><br><span class="line">net/rpc/jsonrpc</span><br><span class="line">cmd/vendor/github.com/google/pprof/internal/binutils</span><br><span class="line">cmd/vendor/github.com/google/pprof/internal/report</span><br><span class="line">cmd/vendor/github.com/google/pprof/internal/symbolz</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modfetch/codehost</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/vcs</span><br><span class="line">cmd/vendor/github.com/google/pprof/internal/transport</span><br><span class="line">cmd/vendor/github.com/google/pprof/internal/symbolizer</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modfetch</span><br><span class="line">cmd/vendor/github.com/google/pprof/internal/driver</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modload</span><br><span class="line">cmd/vendor/github.com/google/pprof/driver</span><br><span class="line">cmd/pprof</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/workcmd</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/help</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/load</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/fmtcmd</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modcmd</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/work</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/envcmd</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/fix</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/generate</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/run</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/modget</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/clean</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/get</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/list</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/test</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/vet</span><br><span class="line">cmd/<span class="keyword">go</span>/internal/bug</span><br><span class="line">cmd/<span class="keyword">go</span></span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">Installed Go <span class="keyword">for</span> darwin/arm64 in /Users/fliter/source_lab/<span class="keyword">go</span></span><br><span class="line">Installed commands in /Users/fliter/source_lab/<span class="keyword">go</span>/bin</span><br><span class="line">---</span><br><span class="line">Installed Go <span class="keyword">for</span> darwin/arm64 in /Users/fliter/source_lab/<span class="keyword">go</span></span><br><span class="line">Installed commands in /Users/fliter/source_lab/<span class="keyword">go</span>/bin</span><br><span class="line">*** You need to add /Users/fliter/source_lab/<span class="keyword">go</span>/bin to your PATH.</span><br></pre></td></tr></table></figure><br><br></details><p><br></p><p>这时在bin目录下，就有刚刚编译好的二进制文件。</p><p><img src="/2021/10/11/调试Go源代码/1.png" width="90%" height="50%"></p><p>将该目录起一个别名(如go_dev)加到 <code>~/.zshrc</code>中：<code>alias go_dev=/Users/fliter/source_lab/go/bin/go</code></p><p>并执行<code>source .zshrc</code></p><p><br></p><p>执行 <code>go_dev version</code>:</p><p><img src="/2021/10/11/调试Go源代码/2.png" width="90%" height="50%"></p><p><br></p><hr><p><br></p><h3 id="调试源码"><a href="#调试源码" class="headerlink" title="调试源码"></a>调试源码</h3><p><br></p><h4 id="修改runtime-map-go"><a href="#修改runtime-map-go" class="headerlink" title="修改runtime/map.go"></a>修改runtime/map.go</h4><p><br></p><p>在<a href>src/runtime/map.go</a> func makemap(t <em>maptype, hint int, h </em>hmap) *hmap {}第一行插入新代码 <code>println(&quot;fliter debug source code&quot;)</code> </p><p>(之所以不用fmt.Println，是因为会有循环引用，即runtime包和fmt包相互引用)</p><p><br></p><p>执行<code>./all.bash</code>重新编译源码 </p><p>(因为只改了runtime包，并不需要重新构建整个项目,所以可在make.bash中 通过<code>./cmd/dist/dist install  -v &quot;runtime&quot;</code> 仅指定runtime目录)</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>, <span class="number">10</span>)</span><br><span class="line">m[<span class="number">1</span>] = <span class="string">"cuishuang"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">println</span>(m[<span class="number">1</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码正常执行该输出<code>cuishuang</code></p><p>而使用go_dev run 如上代码：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line"># runtime/internal/sys</span><br><span class="line">compile: cannot use concurrent backend compilation with provided flags; invoked as [/usr/local/<span class="keyword">go</span>/pkg/tool/darwin_arm64/compile -o $WORK/b008/_pkg_.a -trimpath $WORK/b008=&gt; -p runtime/internal/sys -std -+ -complete -buildid M2oPX2HiuTsx5AMULRO_/M2oPX2HiuTsx5AMULRO_ -shared -c=<span class="number">4</span> -nolocalimports -importcfg $WORK/b008/importcfg -pack /usr/local/<span class="keyword">go</span>/src/runtime/internal/sys/arch.<span class="keyword">go</span> /usr/local/<span class="keyword">go</span>/src/runtime/internal/sys/arch_arm64.<span class="keyword">go</span> /usr/local/<span class="keyword">go</span>/src/runtime/internal/sys/intrinsics.<span class="keyword">go</span> /usr/local/<span class="keyword">go</span>/src/runtime/internal/sys/intrinsics_common.<span class="keyword">go</span> /usr/local/<span class="keyword">go</span>/src/runtime/internal/sys/stubs.<span class="keyword">go</span> /usr/local/<span class="keyword">go</span>/src/runtime/internal/sys/sys.<span class="keyword">go</span> /usr/local/<span class="keyword">go</span>/src/runtime/internal/sys/zgoarch_arm64.<span class="keyword">go</span> /usr/local/<span class="keyword">go</span>/src/runtime/internal/sys/zgoos_darwin.<span class="keyword">go</span> /usr/local/<span class="keyword">go</span>/src/runtime/internal/sys/zversion.<span class="keyword">go</span>]</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line">fliter debug source code</span><br><span class="line"># internal/cpu</span><br><span class="line">compile: cannot use concurrent backend compilation with provided flags; invoked as [/usr/local/<span class="keyword">go</span>/pkg/tool/darwin_arm64/compile -o $WORK/b004/_pkg_.a -trimpath $WORK/b004=&gt; -p internal/cpu -std -+ -buildid bZn0-nG2D-qVhCGWsVek/bZn0-nG2D-qVhCGWsVek -symabis $WORK/b004/symabis -shared -c=<span class="number">4</span> -nolocalimports -importcfg $WORK/b004/importcfg -pack -asmhdr $WORK/b004/go_asm.h /usr/local/<span class="keyword">go</span>/src/internal/cpu/cpu.<span class="keyword">go</span> /usr/local/<span class="keyword">go</span>/src/internal/cpu/cpu_arm64.<span class="keyword">go</span> /usr/local/<span class="keyword">go</span>/src/internal/cpu/cpu_arm64_darwin.<span class="keyword">go</span> /usr/local/<span class="keyword">go</span>/src/internal/cpu/cpu_no_name.<span class="keyword">go</span>]</span><br><span class="line"># runtime/internal/atomic</span><br><span class="line">compile: cannot use concurrent backend compilation with provided flags; invoked as [/usr/local/<span class="keyword">go</span>/pkg/tool/darwin_arm64/compile -o $WORK/b006/_pkg_.a -trimpath $WORK/b006=&gt; -p runtime/internal/atomic -std -+ -buildid Wh4PYLD6KyWgsgy5uHLX/Wh4PYLD6KyWgsgy5uHLX -symabis $WORK/b006/symabis -shared -c=<span class="number">4</span> -nolocalimports -importcfg $WORK/b006/importcfg -pack -asmhdr $WORK/b006/go_asm.h /usr/local/<span class="keyword">go</span>/src/runtime/internal/atomic/atomic_arm64.<span class="keyword">go</span> /usr/local/<span class="keyword">go</span>/src/runtime/internal/atomic/stubs.<span class="keyword">go</span> /usr/local/<span class="keyword">go</span>/src/runtime/internal/atomic/unaligned.<span class="keyword">go</span>]</span><br></pre></td></tr></table></figure><p>可见某个步骤发生了问题</p><p><br></p><hr><p><br></p><p>参考：</p><p><a href="https://github.com/zpoint/go-Internals/blob/1.14/debug/setup/setup_cn.md" target="_blank" rel="noopener">go 源码分析 调试安装</a></p><p><a href="https://draveness.me/golang/docs/part1-prerequisite/ch01-prepare/golang-debug/" target="_blank" rel="noopener">调试源代码</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;编译源码方式安装新版本Go&quot;&gt;&lt;a href=&quot;#编译源码方式安装新版本Go&quot; class=&quot;headerlink&quot; title=&quot;编译源码方式安装新版本Go&quot;&gt;&lt;/a&gt;编译源码方式安装新版本Go&lt;/h3&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;通过源代码编译安装&lt;em&gt;&lt;
      
    
    </summary>
    
    
      <category term="Go" scheme="http://www.dashen.tech/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>代码搜索技巧</title>
    <link href="http://www.dashen.tech/2021/10/08/%E4%BB%A3%E7%A0%81%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/"/>
    <id>http://www.dashen.tech/2021/10/08/代码搜索技巧/</id>
    <published>2021-10-08T13:56:53.000Z</published>
    <updated>2021-10-08T11:55:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>在IDE中搜索代码时，经常会被相近的无关代码干扰，如筛选所有使用协程的代码段，</p><p><img src="/2021/10/08/代码搜索技巧/0.png" width="100%" height="100%"></p><p>可见有大量“噪音”。</p><p>可使用IDE提供的正则表达式功能</p><p><img src="/2021/10/08/代码搜索技巧/1.png" width="100%" height="100%"></p><p>如 使用 <code>\bgo</code>,即匹配go开头的，且之后为空格的所有选项</p><p><img src="/2021/10/08/代码搜索技巧/2.png" width="100%" height="100%"></p><p><br></p><p>使用 <code>\bgo func</code>,即匹配到了所有使用协程的代码段</p><p><img src="/2021/10/08/代码搜索技巧/3.png" width="100%" height="100%"></p><p><br></p><p>IDE还提供了常用正则表达式语法：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Summary of regular-expression constructs</span><br><span class="line"></span><br><span class="line">Construct                    Matches</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">           Characters</span><br><span class="line"></span><br><span class="line">x                       The character x</span><br><span class="line">\\                      The backslash character</span><br><span class="line">\<span class="number">0</span>n                     The character with octal value <span class="number">0</span>n (<span class="number">0</span> &lt;= n &lt;= <span class="number">7</span>)</span><br><span class="line">\<span class="number">0</span>nn                    The character with octal value <span class="number">0</span>nn (<span class="number">0</span> &lt;= n &lt;= <span class="number">7</span>)</span><br><span class="line">\<span class="number">0</span>mnn                   The character with octal value <span class="number">0</span>mnn (<span class="number">0</span> &lt;= m &lt;= <span class="number">3</span>, <span class="number">0</span> &lt;= n &lt;= <span class="number">7</span>)</span><br><span class="line">\xhh                    The character with hexadecimal value <span class="number">0</span>xhh</span><br><span class="line">\uhhhh                  The character with hexadecimal value <span class="number">0</span>xhhhh</span><br><span class="line">\t                      The tab character (<span class="string">'\u0009'</span>)</span><br><span class="line">\n                      The newline (line feed) character (<span class="string">'\u000A'</span>)</span><br><span class="line">\r                      The carriage-<span class="keyword">return</span> character (<span class="string">'\u000D'</span>)</span><br><span class="line">\f                      The form-feed character (<span class="string">'\u000C'</span>)</span><br><span class="line">\a                      The alert (bell) character (<span class="string">'\u0007'</span>)</span><br><span class="line">\e                      The escape character (<span class="string">'\u001B'</span>)</span><br><span class="line">\cx                     The control character corresponding to x</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            Character classes</span><br><span class="line"></span><br><span class="line">[abc]                   a, b, or c (simple class)</span><br><span class="line">[^abc]                  Any character except a, b, or c (negation)</span><br><span class="line">[a-zA-Z]                a through z or A through Z, inclusive (<span class="keyword">range</span>)</span><br><span class="line">[a-d[m-p]]              a through d, or m through p: [a-dm-p] (union)</span><br><span class="line">[a-z&amp;&amp;[def]]            d, e, or f (intersection)</span><br><span class="line">[a-z&amp;&amp;[^bc]]            a through z, except <span class="keyword">for</span> b and c: [ad-z] (subtraction)</span><br><span class="line">[a-z&amp;&amp;[^m-p]]           a through z, and not m through p: [a-lq-z(subtraction)</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">            Predefined character classes</span><br><span class="line"></span><br><span class="line">.                       Any character (may or may not match line terminators)</span><br><span class="line">\d                      A digit: [<span class="number">0</span><span class="number">-9</span>]</span><br><span class="line">\D                      A non-digit: [^<span class="number">0</span><span class="number">-9</span>]</span><br><span class="line">\s                      A whitespace character: [ \t\n\x0B\f\r]</span><br><span class="line">\S                      A non-whitespace character: [^\s]</span><br><span class="line">\w                      A word character: [a-zA-Z_0<span class="number">-9</span>]</span><br><span class="line">\W                      A non-word character: [^\w]</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            POSIX character classes (US-ASCII only)</span><br><span class="line"></span><br><span class="line">\p&#123;Lower&#125;               A lower-<span class="keyword">case</span> alphabetic character: [a-z]</span><br><span class="line">\p&#123;Upper&#125;               An upper-<span class="keyword">case</span> alphabetic character:[A-Z]</span><br><span class="line">\p&#123;ASCII&#125;               All ASCII:[\x00-\x7F]</span><br><span class="line">\p&#123;Alpha&#125;               An alphabetic character:[\p&#123;Lower&#125;\p&#123;Upper&#125;]</span><br><span class="line">\p&#123;Digit&#125;               A decimal digit: [<span class="number">0</span><span class="number">-9</span>]</span><br><span class="line">\p&#123;Alnum&#125;               An alphanumeric character:[\p&#123;Alpha&#125;\p&#123;Digit&#125;]</span><br><span class="line">\p&#123;Punct&#125;               Punctuation: One of !<span class="string">"#$%&amp;'()*+,-./:;=&gt;?@[\]^_`&#123;|&#125;~</span></span><br><span class="line"><span class="string">\p&#123;Graph&#125;               A visible character: [\p&#123;Alnum&#125;\p&#123;Punct&#125;]</span></span><br><span class="line"><span class="string">\p&#123;Print&#125;               A printable character: [\p&#123;Graph&#125;\x20]</span></span><br><span class="line"><span class="string">\p&#123;Blank&#125;               A space or a tab: [ \t]</span></span><br><span class="line"><span class="string">\p&#123;Cntrl&#125;               A control character: [\x00-\x1F\x7F]</span></span><br><span class="line"><span class="string">\p&#123;XDigit&#125;              A hexadecimal digit: [0-9a-fA-F]</span></span><br><span class="line"><span class="string">\p&#123;Space&#125;               A whitespace character: [ \t\n\x0B\f\r]</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            java.lang.Character classes (simple java character type)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\p&#123;javaLowerCase&#125;       Equivalent to java.lang.Character.isLowerCase()</span></span><br><span class="line"><span class="string">\p&#123;javaUpperCase&#125;       Equivalent to java.lang.Character.isUpperCase()</span></span><br><span class="line"><span class="string">\p&#123;javaWhitespace&#125;      Equivalent to java.lang.Character.isWhitespace()</span></span><br><span class="line"><span class="string">\p&#123;javaMirrored&#125;        Equivalent to java.lang.Character.isMirrored()</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            Classes for Unicode blocks and categories</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\p&#123;InGreek&#125;             A character in the Greek block (simple block)</span></span><br><span class="line"><span class="string">\p&#123;Lu&#125;                  An uppercase letter (simple category)</span></span><br><span class="line"><span class="string">\p&#123;Sc&#125;                  A currency symbol</span></span><br><span class="line"><span class="string">\P&#123;InGreek&#125;             Any character except one in the Greek block (negation)</span></span><br><span class="line"><span class="string">[\p&#123;L&#125;&amp;&amp;[^\p&#123;Lu&#125;]]      Any letter except an uppercase letter (subtraction)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                  Boundary matchers</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">^                       The beginning of a line</span></span><br><span class="line"><span class="string">$                       The end of a line</span></span><br><span class="line"><span class="string">\b                      A word boundary</span></span><br><span class="line"><span class="string">\B                      A non-word boundary</span></span><br><span class="line"><span class="string">\A                      The beginning of the input</span></span><br><span class="line"><span class="string">\G                      The end of the previous match</span></span><br><span class="line"><span class="string">\Z                      The end of the input but for the final terminator, if any</span></span><br><span class="line"><span class="string">\z                      The end of the input</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                Greedy quantifiers</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">X?                      X, once or not at all</span></span><br><span class="line"><span class="string">X*                      X, zero or more times</span></span><br><span class="line"><span class="string">X+                      X, one or more times</span></span><br><span class="line"><span class="string">X&#123;n&#125;                    X, exactly n times</span></span><br><span class="line"><span class="string">X&#123;n,&#125;                   X, at least n times</span></span><br><span class="line"><span class="string">X&#123;n,m&#125;                  X, at least n but not more than m times</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                Reluctant quantifiers</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">X??                     X, once or not at all</span></span><br><span class="line"><span class="string">X*?                     X, zero or more times</span></span><br><span class="line"><span class="string">X+?                     X, one or more times</span></span><br><span class="line"><span class="string">X&#123;n&#125;?                   X, exactly n times</span></span><br><span class="line"><span class="string">X&#123;n,&#125;?                  X, at least n times</span></span><br><span class="line"><span class="string">X&#123;n,m&#125;?                 X, at least n but not more than m times</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                 Possessive quantifiers</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">X?+                     X, once or not at all</span></span><br><span class="line"><span class="string">X*+                     X, zero or more times</span></span><br><span class="line"><span class="string">X++                     X, one or more times</span></span><br><span class="line"><span class="string">X&#123;n&#125;+                   X, exactly n times</span></span><br><span class="line"><span class="string">X&#123;n,&#125;+                  X, at least n times</span></span><br><span class="line"><span class="string">X&#123;n,m&#125;+                 X, at least n but not more than m times</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                Logical operators</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">XY                      X followed by Y</span></span><br><span class="line"><span class="string">X|Y                     Either X or Y</span></span><br><span class="line"><span class="string">(X)                     X, as a capturing group</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                Back references</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\n                      Whatever the nth capturing group matched</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                Quotation</span></span><br><span class="line"><span class="string">                  </span></span><br><span class="line"><span class="string">\                       Nothing, but quotes the following character</span></span><br><span class="line"><span class="string">\Q                      Nothing, but quotes all characters until \E</span></span><br><span class="line"><span class="string">\E                      Nothing, but ends quoting started by \Q</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">                Special constructs (non-capturing)</span></span><br><span class="line"><span class="string">                </span></span><br><span class="line"><span class="string">(?:X)                   X, as a non-capturing group</span></span><br><span class="line"><span class="string">(?idmsux-idmsux)        Nothing, but turns match flags on - off</span></span><br><span class="line"><span class="string">(?idmsux-idmsux:X)      X, as a non-capturing group with the given flags on - off</span></span><br><span class="line"><span class="string">(?=X)                   X, via zero-width positive lookahead</span></span><br><span class="line"><span class="string">(?!X)                   X, via zero-width negative lookahead</span></span><br><span class="line"><span class="string">(?&lt;=X)                  X, via zero-width positive lookbehind</span></span><br><span class="line"><span class="string">(?&lt;!X)                  X, via zero-width negative lookbehind</span></span><br><span class="line"><span class="string">(?&gt;X)                   X, as an independent, non-capturing group</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">More on Regular Expressions: Full Java Regular Expressions syntax description, Using Regular Expressions in Java.</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在IDE中搜索代码时，经常会被相近的无关代码干扰，如筛选所有使用协程的代码段，&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2021/10/08/代码搜索技巧/0.png&quot; width=&quot;100%&quot; height=&quot;100%&quot;&gt;&lt;/p&gt;
&lt;p&gt;可见有大量“噪音”。&lt;/p&gt;
&lt;p&gt;可
      
    
    </summary>
    
    
      <category term="Tools" scheme="http://www.dashen.tech/tags/Tools/"/>
    
  </entry>
  
  <entry>
    <title>SubQuery入门指南II</title>
    <link href="http://www.dashen.tech/2021/09/25/SubQuery%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97II/"/>
    <id>http://www.dashen.tech/2021/09/25/SubQuery入门指南II/</id>
    <published>2021-09-25T13:56:23.000Z</published>
    <updated>2021-09-26T07:20:56.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://mp.weixin.qq.com/s/Nyy3ogj0-ySOTczJBvpQxw" target="_blank" rel="noopener">SubQuery开发者指南丨Hello World (由SubQuery 托管)</a></p><p><br></p><h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3><p><br></p><blockquote><p>subql init –starter Cui_subql</p></blockquote><p><img src="/2021/09/25/SubQuery入门指南II/0.png" width="100%" height="50%"></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> Cui_subql</span><br><span class="line">npm install</span><br><span class="line">npm run-script codegen</span><br><span class="line">npm run-script build</span><br></pre></td></tr></table></figure><p><img src="/2021/09/25/SubQuery入门指南II/1.png" width="100%" height="50%"></p><p><br></p><h3 id="创建-GitHub-存储库"><a href="#创建-GitHub-存储库" class="headerlink" title="创建 GitHub 存储库"></a>创建 GitHub 存储库</h3><p><br></p><p><a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:cuishuang/subql_demo.git</p><p><br></p><h3 id="推送到-GitHub"><a href="#推送到-GitHub" class="headerlink" title="推送到 GitHub"></a>推送到 GitHub</h3><p><br></p><p><br></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> Cui_subql</span><br><span class="line">git init</span><br><span class="line">git remote add origin git@github.com:cuishuang/subql_demo.git  //将远程存储库设置为 git@github.com:cuishuang/subql_demo.git</span><br><span class="line"></span><br><span class="line">git add .</span><br><span class="line">git commit -m<span class="string">"first commit"</span></span><br><span class="line">git push --<span class="built_in">set</span>-upstream origin master</span><br></pre></td></tr></table></figure><p><img src="/2021/09/25/SubQuery入门指南II/2.png" width="100%" height="50%"></p><p><img src="/2021/09/25/SubQuery入门指南II/3.png" width="100%" height="50%"></p><p><br></p><h3 id="创建项目-1"><a href="#创建项目-1" class="headerlink" title="创建项目"></a>创建项目</h3><p><br></p><p>点击<a href="https://project.subquery.network" target="_blank" rel="noopener">project.subquery.network</a>并使用github登录</p><ul><li><p>GitHub 帐户：如果有多个 GitHub 帐户，请选择将在哪个帐户下创建此项目。 在 GitHub 组织帐户中创建的项目在该组织的成员之间共享。</p></li><li><p>项目名称：在此处为项目命名。</p></li><li><p>副标题：为项目提供副标题。</p></li><li><p>描述：解释 SubQuery 项目的用途。</p></li><li><p>GitHub 存储库 URL：这必须是包含 SubQuery 项目的公共存储库的有效 GitHub URL。schema.graphql 文件必须位于目录的根目录中。</p></li><li><p>隐藏项目：如果选中，这将在公共 SubQuery 浏览器中隐藏项目。 如果想与社区共享您的 SubQuery 项目，请不要选择此项！</p></li></ul><p><img src="/2021/09/25/SubQuery入门指南II/4.png" width="100%" height="50%"></p><p><br></p><p>单击创建后，将跳转到控制面板。这上面包含许多有用信息，如它使用的网络、它运行的源代码的 GitHub 存储库 URL、它的创建时间和上次更新时间，尤其是部署的详细信息</p><p><img src="/2021/09/25/SubQuery入门指南II/5.png" width="100%" height="50%"></p><p><br></p><h3 id="部署项目"><a href="#部署项目" class="headerlink" title="部署项目"></a>部署项目</h3><p><br></p><p>现在已在 SubQuery Projects 中创建了项目，下一步是部署项目使其可操作。 </p><p>部署一个版本会触发新的 SubQuery 索引操作启动，并设置所需的查询服务以开始接受 GraphQL 请求。 还可以在此处将新版本部署到现有项目。</p><p>可以选择部署到各种环境，例如生产槽或暂存槽。 在这里，将部署到生产槽。 单击“部署”按钮会显示如下：</p><p><img src="/2021/09/25/SubQuery入门指南II/6.png" width="100%" height="50%"></p><ul><li><p>新版本的 Commit Hash：从 GitHub 中选择您要部署的 SubQuery 项目代码库的正确交付 (因为只有一个交付/提交，所以下拉菜单中只有一个选项)</p></li><li><p>索引器版本：这是要在其上运行此SubQuery项目的SubQuery节点服务的版本。 可登录<a href="https://www.npmjs.com/package/@subql/node" target="_blank" rel="noopener">此网址参考</a></p></li><li><p>查询版本：这是要在其上运行此 SubQuery 项目的 SubQuery 查询服务的版本。 可登录<a href="https://www.npmjs.com/package/@subql/query" target="_blank" rel="noopener">此网址参考</a></p></li></ul><p>将使用最新版本的索引器和查询版本，因此此处接受默认值，然后单击“部署更新”</p><p>然后，将看到部署处于“正在处理”状态。 在这里，代码正在部署到 SubQuery 的托管基础架构上。 服务器正在按需启动并准备提供服务，这将需要几分钟的时间。</p><p><img src="/2021/09/25/SubQuery入门指南II/7.png" width="100%" height="50%"></p><p><br></p><h3 id="测试项目"><a href="#测试项目" class="headerlink" title="测试项目"></a>测试项目</h3><p><br></p><p><img src="/2021/09/25/SubQuery入门指南II/8.png" width="100%" height="50%"></p><p><img src="/2021/09/25/SubQuery入门指南II/9.png" width="100%" height="50%"></p><p><br></p><h3 id="运行一个简单的-GET-查询"><a href="#运行一个简单的-GET-查询" class="headerlink" title="运行一个简单的 GET 查询"></a>运行一个简单的 GET 查询</h3><p><br></p><p>Query Endpoint:    <a href="https://api.subquery.network/sq/cuishuang/blockchain" target="_blank" rel="noopener">https://api.subquery.network/sq/cuishuang/blockchain</a></p><p><img src="/2021/09/25/SubQuery入门指南II/10.png" width="100%" height="50%"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/Nyy3ogj0-ySOTczJBvpQxw&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;SubQuery开发者指南丨Hello World (由SubQuery 托管)&lt;/a&gt;&lt;/
      
    
    </summary>
    
    
      <category term="微服务" scheme="http://www.dashen.tech/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"/>
    
  </entry>
  
  <entry>
    <title>SubQuery入门指南</title>
    <link href="http://www.dashen.tech/2021/09/25/SubQuery%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/"/>
    <id>http://www.dashen.tech/2021/09/25/SubQuery入门指南/</id>
    <published>2021-09-25T13:20:46.000Z</published>
    <updated>2021-09-26T02:59:49.000Z</updated>
    
    <content type="html"><![CDATA[<p>SubQuery是波卡生态的 The Graph(以太坊生态的数据服务提供者)</p><p>SubQuery可以让开发者专注于其核心用例和前端，而无需浪费时间来构建用于数据处理的后端。</p><p><br></p><h3 id="下载SubQuery-CLI"><a href="#下载SubQuery-CLI" class="headerlink" title="下载SubQuery CLI"></a>下载SubQuery CLI</h3><p><br></p><blockquote><p>npm install -g @subql/cli</p></blockquote><blockquote><p>subql help </p></blockquote><p><img src="/2021/09/25/SubQuery入门指南/0.png" width="100%" height="50%"></p><p><br></p><h3 id="初始化-Starter-SubQuery-项目"><a href="#初始化-Starter-SubQuery-项目" class="headerlink" title="初始化 Starter SubQuery 项目"></a>初始化 Starter SubQuery 项目</h3><p><br></p><blockquote><p>subql init –starter Shuang_subql</p></blockquote><ul><li><p>Git 存储库（可选）：提供指向此 SubQuery 项目的，并将在其中托管的存储库的 Git URL（当托管在 SubQuery Explorer 中时）。</p></li><li><p>RPC 端点（必需）：提供一个 wss URL给一个正在运行的 RPC 端点，该端点将默认用于此项目。 您可以快速访问不同 Polkadot 网络的公共端点，甚至可以使用 OnFinality，或仅使用默认的 Polkadot 端点创建您自己的私有专用节点。</p></li><li><p>作者（必填）：在此处输入此 SubQuery 项目的所有者。</p></li><li><p>描述（可选）：您可以提供关于您项目的简短段落，描述项目包含哪些数据以及用户可以使用它做什么。</p></li><li><p>版本（必填）：输入自定义版本号或使用默认版本 (1.0.0)。</p></li><li><p>许可证（必需）：提供此项目的软件许可证或接受默认（Apache-2.0）。</p></li></ul><blockquote><p>cd Shuang_test</p></blockquote><blockquote><p>npm install</p></blockquote><p><img src="/2021/09/25/SubQuery入门指南/1.png" width="100%" height="50%"></p><p><br></p><h3 id="配置和构建入门项目"><a href="#配置和构建入门项目" class="headerlink" title="配置和构建入门项目"></a>配置和构建入门项目</h3><p><br></p><p><img src="/2021/09/25/SubQuery入门指南/2.png" width="100%" height="50%"></p><p>之后的开发将主要处理以下文件：</p><ul><li><p>project.yaml 中的清单</p></li><li><p>schema.graphql 中的 GraphQL 架构</p></li><li><p>src/mappings/ 目录中的映射函数</p></li></ul><p><br></p><h3 id="GraphQL-模型生成"><a href="#GraphQL-模型生成" class="headerlink" title="GraphQL 模型生成"></a>GraphQL 模型生成</h3><p><br></p><blockquote><p>npm run-script codegen</p></blockquote><p><img src="/2021/09/25/SubQuery入门指南/3.png" width="100%" height="50%"></p><p>此时会自动新建/src/types/models文件夹，里面是自动生成的文件</p><p><br></p><h3 id="构建项目"><a href="#构建项目" class="headerlink" title="构建项目"></a>构建项目</h3><p><br></p><blockquote><p>npm run-script build</p></blockquote><p><br></p><h3 id="运行-SubQuery-项目"><a href="#运行-SubQuery-项目" class="headerlink" title="运行 SubQuery 项目"></a>运行 SubQuery 项目</h3><p><br></p><p>打开本地的Docker，然后执行</p><blockquote><p>docker-compose pull &amp;&amp; docker-compose up</p></blockquote><p><img src="/2021/09/25/SubQuery入门指南/4.png" width="100%" height="50%"></p><p><br></p><h3 id="查询新建的项目"><a href="#查询新建的项目" class="headerlink" title="查询新建的项目"></a>查询新建的项目</h3><p><br></p><p>打开浏览器并前往 <a href="http://localhost:3000" target="_blank" rel="noopener">http://localhost:3000</a></p><p>这时会看到 GraphQL playground 显示在资源管理器中，其模式是准备查询。 在 Playground 的右上角，会找到一个 Docs 按钮，该按钮将打开文档绘图。 该文档是自动生成的，能帮助找到可以查询的实体和方法。</p><p>对于新的 SubQuery 入门项目，可以尝试以下查询以了解其工作原理或了解有关 GraphQL 查询语言的更多信息。</p><p><img src="/2021/09/25/SubQuery入门指南/5.png" width="100%" height="50%"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  query&#123;</span><br><span class="line">    starterEntities(first:10)&#123;</span><br><span class="line">      nodes&#123;</span><br><span class="line">        field1</span><br><span class="line">        field2</span><br><span class="line">        field3</span><br><span class="line">        id</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/09/25/SubQuery入门指南/6.png" width="100%" height="50%"></p><p><br></p><p>现在有一个本地运行的 SubQuery 项目，该项目接受 GraphQL API 对示例数据的请求~</p><p>下一篇将向展示如何将新项目发布到 SubQuery Projects, 并使用ta们的资源管理器去查询</p><p><br></p><p>参考 </p><p><a href="https://mp.weixin.qq.com/s/ymuziBgS9qr1R2_EXxdwHw" target="_blank" rel="noopener">SubQuery丨开发者快速入门指南</a></p><p><a href="https://mp.weixin.qq.com/s/6y9tHW1YPUWqjdYgnUte7Q" target="_blank" rel="noopener">SubQuery丨Hello world 入门简介</a></p><p><a href="https://mp.weixin.qq.com/s/hX-xncFOkDTG8dC9HP9VSg" target="_blank" rel="noopener">SubQuery开发者指南丨Hello World Explained</a></p><p><a href="https://mp.weixin.qq.com/s/ZIAJ1HKipaI6ZRkQ9pHIGA" target="_blank" rel="noopener">!!!SubQuery开发者指南丨清单文件（Manifest File）</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;SubQuery是波卡生态的 The Graph(以太坊生态的数据服务提供者)&lt;/p&gt;
&lt;p&gt;SubQuery可以让开发者专注于其核心用例和前端，而无需浪费时间来构建用于数据处理的后端。&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;h3 id=&quot;下载SubQuery-CLI&quot;&gt;&lt;a 
      
    
    </summary>
    
    
      <category term="微服务" scheme="http://www.dashen.tech/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"/>
    
  </entry>
  
  <entry>
    <title>搭建substrate开发环境</title>
    <link href="http://www.dashen.tech/2021/09/19/%E6%90%AD%E5%BB%BAsubstrate%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
    <id>http://www.dashen.tech/2021/09/19/搭建substrate开发环境/</id>
    <published>2021-09-19T13:46:30.000Z</published>
    <updated>2021-09-21T08:45:29.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2021/09/19/搭建substrate开发环境/-1.png" width="100%" height="100%"></p><p><br></p><h3 id="安装Substrate依赖"><a href="#安装Substrate依赖" class="headerlink" title="安装Substrate依赖"></a>安装Substrate依赖</h3><p><br></p><blockquote><p>curl <a href="https://getsubstrate.io/-o-" target="_blank" rel="noopener">https://getsubstrate.io/-o-</a> <a href="https://raw.githubusercontent.com/creationix/nvm/v0.33.8/install.sh" target="_blank" rel="noopener">https://raw.githubusercontent.com/creationix/nvm/v0.33.8/install.sh</a> | bash</p></blockquote><details><br><summary><b>实际的shell为:</b></summary><br><br><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># Copyright 2015-2020 Parity Technologies (UK) Ltd.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="string">"<span class="variable">$OSTYPE</span>"</span> == <span class="string">"linux-gnu"</span> ]]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line"><span class="keyword">if</span> [[ $(whoami) == <span class="string">"root"</span> ]]; <span class="keyword">then</span></span><br><span class="line">MAKE_ME_ROOT=</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">MAKE_ME_ROOT=sudo</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -f /etc/redhat-release ]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Redhat Linux detected."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"This OS is not supported with this script at present. Sorry."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Please refer to https://github.com/paritytech/substrate for setup information."</span></span><br><span class="line"><span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">elif</span> [ -f /etc/SuSE-release ]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Suse Linux detected."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"This OS is not supported with this script at present. Sorry."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Please refer to https://github.com/paritytech/substrate for setup information."</span></span><br><span class="line"><span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">elif</span> [ -f /etc/arch-release ]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Arch Linux detected."</span></span><br><span class="line"><span class="variable">$MAKE_ME_ROOT</span> pacman -Syu --needed --noconfirm cmake gcc openssl-1.0 pkgconf git clang</span><br><span class="line"><span class="built_in">export</span> OPENSSL_LIB_DIR=<span class="string">"/usr/lib/openssl-1.0"</span>;</span><br><span class="line"><span class="built_in">export</span> OPENSSL_INCLUDE_DIR=<span class="string">"/usr/include/openssl-1.0"</span></span><br><span class="line"><span class="keyword">elif</span> [ -f /etc/mandrake-release ]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Mandrake Linux detected."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"This OS is not supported with this script at present. Sorry."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Please refer to https://github.com/paritytech/substrate for setup information."</span></span><br><span class="line"><span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">elif</span> [ -f /etc/debian_version ]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Ubuntu/Debian Linux detected."</span></span><br><span class="line"><span class="variable">$MAKE_ME_ROOT</span> apt update</span><br><span class="line"><span class="variable">$MAKE_ME_ROOT</span> apt install -y cmake pkg-config libssl-dev git gcc build-essential git clang libclang-dev</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Unknown Linux distribution."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"This OS is not supported with this script at present. Sorry."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Please refer to https://github.com/paritytech/substrate for setup information."</span></span><br><span class="line"><span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">elif</span> [[ <span class="string">"<span class="variable">$OSTYPE</span>"</span> == <span class="string">"darwin"</span>* ]]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Mac OS (Darwin) detected."</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ! <span class="built_in">which</span> brew &gt;/dev/null 2&gt;&amp;1; <span class="keyword">then</span></span><br><span class="line">/bin/bash -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">brew update</span><br><span class="line">brew install openssl cmake llvm</span><br><span class="line"><span class="keyword">elif</span> [[ <span class="string">"<span class="variable">$OSTYPE</span>"</span> == <span class="string">"freebsd"</span>* ]]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"FreeBSD detected."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"This OS is not supported with this script at present. Sorry."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Please refer to https://github.com/paritytech/substrate for setup information."</span></span><br><span class="line"><span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Unknown operating system."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"This OS is not supported with this script at present. Sorry."</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Please refer to https://github.com/paritytech/substrate for setup information."</span></span><br><span class="line"><span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ! <span class="built_in">which</span> rustup &gt;/dev/null 2&gt;&amp;1; <span class="keyword">then</span></span><br><span class="line">curl https://sh.rustup.rs -sSf | sh -s -- -y</span><br><span class="line"><span class="built_in">source</span> ~/.cargo/env</span><br><span class="line">rustup default stable</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">rustup update</span><br><span class="line">rustup default stable</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">rustup update nightly</span><br><span class="line">rustup target add wasm32-unknown-unknown --toolchain nightly</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="string">"<span class="variable">$1</span>"</span> == <span class="string">"--fast"</span> ]]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Skipped cargo install of 'substrate' and 'subkey'"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"You can install manually by cloning the https://github.com/paritytech/substrate repo,"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"and using cargo to install 'substrate' and 'subkey' from the repo path."</span></span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">g=$(mktemp -d)</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/paritytech/substrate <span class="string">"<span class="variable">$g</span>"</span></span><br><span class="line"><span class="built_in">pushd</span> <span class="string">"<span class="variable">$g</span>"</span></span><br><span class="line">cargo install --force --path ./bin/node/cli <span class="comment">#substrate</span></span><br><span class="line">cargo install --force --path ./bin/utils/subkey subkey</span><br><span class="line"><span class="built_in">popd</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Run source ~/.cargo/env now to update environment"</span></span><br></pre></td></tr></table></figure><br><br></details><p><img src="/2021/09/19/搭建substrate开发环境/0.png" width="100%" height="100%"></p><p>(wasm-gc，可以压缩wasm二进制文件的大小)</p><p><img src="/2021/09/19/搭建substrate开发环境/1.png" width="100%" height="100%"></p><p><br></p><hr><p><br></p><h3 id="使用node-template"><a href="#使用node-template" class="headerlink" title="使用node template"></a>使用node template</h3><p><br></p><p><img src="/2021/09/19/搭建substrate开发环境/2.png" width="100%" height="100%"></p><blockquote><p>git clone <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:substrate-developer-hub/substrate-node-template.git</p></blockquote><p>（cd substrate-node-template）</p><blockquote><p>cargo build –release</p></blockquote><p>(编译确实非常慢)</p><p><img src="/2021/09/19/搭建substrate开发环境/3.png" width="100%" height="100%"></p><blockquote><p>./target/release/node-template purge-chain –dev</p></blockquote><p><img src="/2021/09/19/搭建substrate开发环境/4.png" width="100%" height="100%"></p><blockquote><p>./target/release/node-template –dev  </p></blockquote><p><img src="/2021/09/19/搭建substrate开发环境/5.png" width="100%" height="100%"></p><p><br></p><p>可使用 <strong>./target/release/node-template -h </strong> 查看所有命令：</p><details><br><summary><b>./target/release/node-template -h:</b></summary><br><br><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><span class="line">node-template 3.0.0-monthly-2021-09+1-3b547c9-aarch64-macos</span><br><span class="line"></span><br><span class="line">Substrate DevHub &lt;https://github.com/substrate-developer-hub&gt;</span><br><span class="line">A fresh FRAME-based Substrate node, ready <span class="keyword">for</span> hacking.</span><br><span class="line"></span><br><span class="line">USAGE:</span><br><span class="line">    node-template [FLAGS] [OPTIONS]</span><br><span class="line">    node-template &lt;SUBCOMMAND&gt;</span><br><span class="line"></span><br><span class="line">FLAGS:</span><br><span class="line">        --alice                            Shortcut <span class="keyword">for</span> `--name Alice --validator` with session keys <span class="keyword">for</span> `Alice` added</span><br><span class="line">                                           to keystore</span><br><span class="line">        --allow-private-ipv4               Always accept connecting to private IPv4 addresses (as specified <span class="keyword">in</span></span><br><span class="line">                                           [RFC1918](https://tools.ietf.org/html/rfc1918)). Enabled by default <span class="keyword">for</span></span><br><span class="line">                                           chains marked as <span class="string">"local"</span> <span class="keyword">in</span> their chain specifications, or when `--dev` is</span><br><span class="line">                                           passed</span><br><span class="line">        --bob                              Shortcut <span class="keyword">for</span> `--name Bob --validator` with session keys <span class="keyword">for</span> `Bob` added to</span><br><span class="line">                                           keystore</span><br><span class="line">        --charlie                          Shortcut <span class="keyword">for</span> `--name Charlie --validator` with session keys <span class="keyword">for</span> `Charlie`</span><br><span class="line">                                           added to keystore</span><br><span class="line">        --dave                             Shortcut <span class="keyword">for</span> `--name Dave --validator` with session keys <span class="keyword">for</span> `Dave` added to</span><br><span class="line">                                           keystore</span><br><span class="line">        --dev                              Specify the development chain</span><br><span class="line">        --<span class="built_in">disable</span>-log-color                Disable <span class="built_in">log</span> color output</span><br><span class="line">        --<span class="built_in">disable</span>-log-reloading            Disable feature to dynamically update and reload the <span class="built_in">log</span> filter</span><br><span class="line">        --discover-local                   Enable peer discovery on <span class="built_in">local</span> networks</span><br><span class="line">        --eve                              Shortcut <span class="keyword">for</span> `--name Eve --validator` with session keys <span class="keyword">for</span> `Eve` added to</span><br><span class="line">                                           keystore</span><br><span class="line">        --ferdie                           Shortcut <span class="keyword">for</span> `--name Ferdie --validator` with session keys <span class="keyword">for</span> `Ferdie` added</span><br><span class="line">                                           to keystore</span><br><span class="line">        --force-authoring                  Enable authoring even when offline</span><br><span class="line">    -h, --<span class="built_in">help</span>                             Prints <span class="built_in">help</span> information</span><br><span class="line">        --ipfs-server                      Join the IPFS network and serve transactions over bitswap protocol</span><br><span class="line">        --kademlia-disjoint-query-paths    Require iterative Kademlia DHT queries to use disjoint paths <span class="keyword">for</span> increased</span><br><span class="line">                                           resiliency <span class="keyword">in</span> the presence of potentially adversarial nodes</span><br><span class="line">        --light                            Experimental: Run <span class="keyword">in</span> light client mode</span><br><span class="line">        --no-grandpa                       Disable GRANDPA voter when running <span class="keyword">in</span> validator mode, otherwise <span class="built_in">disable</span> the</span><br><span class="line">                                           GRANDPA observer</span><br><span class="line">        --no-mdns                          Disable mDNS discovery</span><br><span class="line">        --no-private-ipv4                  Always forbid connecting to private IPv4 addresses (as specified <span class="keyword">in</span></span><br><span class="line">                                           [RFC1918](https://tools.ietf.org/html/rfc1918)), unless the address was</span><br><span class="line">                                           passed with `--reserved-nodes` or `--bootnodes`. Enabled by default <span class="keyword">for</span></span><br><span class="line">                                           chains marked as <span class="string">"live"</span> <span class="keyword">in</span> their chain specifications</span><br><span class="line">        --no-prometheus                    Do not expose a Prometheus exporter endpoint</span><br><span class="line">        --no-telemetry                     Disable connecting to the Substrate telemetry server</span><br><span class="line">        --one                              Shortcut <span class="keyword">for</span> `--name One --validator` with session keys <span class="keyword">for</span> `One` added to</span><br><span class="line">                                           keystore</span><br><span class="line">        --password-interactive             Use interactive shell <span class="keyword">for</span> entering the password used by the keystore</span><br><span class="line">        --prometheus-external              Expose Prometheus exporter on all interfaces</span><br><span class="line">        --reserved-only                    Whether to only synchronize the chain with reserved nodes</span><br><span class="line">        --rpc-external                     Listen to all RPC interfaces</span><br><span class="line">        --storage-chain                    Enable storage chain mode</span><br><span class="line">        --tmp                              Run a temporary node</span><br><span class="line">        --two                              Shortcut <span class="keyword">for</span> `--name Two --validator` with session keys <span class="keyword">for</span> `Two` added to</span><br><span class="line">                                           keystore</span><br><span class="line">        --unsafe-pruning                   Force start with unsafe pruning settings</span><br><span class="line">        --unsafe-rpc-external              Listen to all RPC interfaces</span><br><span class="line">        --unsafe-ws-external               Listen to all Websocket interfaces</span><br><span class="line">        --validator                        Enable validator mode</span><br><span class="line">    -V, --version                          Prints version information</span><br><span class="line">        --ws-external                      Listen to all Websocket interfaces</span><br><span class="line"></span><br><span class="line">OPTIONS:</span><br><span class="line">    -d, --base-path &lt;PATH&gt;                                       Specify custom base path</span><br><span class="line">        --bootnodes &lt;ADDR&gt;...                                    Specify a list of bootnodes</span><br><span class="line">        --chain &lt;CHAIN_SPEC&gt;                                     Specify the chain specification</span><br><span class="line">        --database &lt;DB&gt;</span><br><span class="line">            Select database backend to use [possible values: rocksdb, paritydb-experimental, auto]</span><br><span class="line"></span><br><span class="line">        --db-cache &lt;MiB&gt;                                         Limit the memory the database cache can use</span><br><span class="line">        --offchain-worker &lt;ENABLED&gt;</span><br><span class="line">            Should execute offchain workers on every block [default: WhenValidating]  [possible values:</span><br><span class="line">            Always, Never, WhenValidating]</span><br><span class="line">        --execution &lt;STRATEGY&gt;</span><br><span class="line">            The execution strategy that should be used by all execution contexts [possible values: Native,</span><br><span class="line">            Wasm, Both, NativeElseWasm]</span><br><span class="line">        --execution-block-construction &lt;STRATEGY&gt;</span><br><span class="line">            The means of execution used when calling into the runtime <span class="keyword">while</span> constructing blocks [possible values:</span><br><span class="line">            Native, Wasm, Both, NativeElseWasm]</span><br><span class="line">        --execution-import-block &lt;STRATEGY&gt;</span><br><span class="line">            The means of execution used when calling into the runtime <span class="keyword">for</span> general block import (including locally</span><br><span class="line">            authored blocks) [possible values: Native, Wasm, Both, NativeElseWasm]</span><br><span class="line">        --execution-offchain-worker &lt;STRATEGY&gt;</span><br><span class="line">            The means of execution used when calling into the runtime <span class="keyword">while</span> using an off-chain worker [possible values:</span><br><span class="line">            Native, Wasm, Both, NativeElseWasm]</span><br><span class="line">        --execution-other &lt;STRATEGY&gt;</span><br><span class="line">            The means of execution used when calling into the runtime <span class="keyword">while</span> not syncing, importing or constructing</span><br><span class="line">            blocks [possible values: Native, Wasm, Both, NativeElseWasm]</span><br><span class="line">        --execution-syncing &lt;STRATEGY&gt;</span><br><span class="line">            The means of execution used when calling into the runtime <span class="keyword">for</span> importing blocks as part of an initial sync</span><br><span class="line">            [possible values: Native, Wasm, Both, NativeElseWasm]</span><br><span class="line">        --<span class="keyword">in</span>-peers &lt;COUNT&gt;</span><br><span class="line">            Specify the maximum number of incoming connections we<span class="string">'re accepting [default: 25]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        --enable-offchain-indexing &lt;ENABLE_OFFCHAIN_INDEXING&gt;</span></span><br><span class="line"><span class="string">            Enable Offchain Indexing API, which allows block import to write to Offchain DB</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        --ipc-path &lt;PATH&gt;                                        Specify IPC RPC server path</span></span><br><span class="line"><span class="string">        --keep-blocks &lt;COUNT&gt;</span></span><br><span class="line"><span class="string">            Specify the number of finalized blocks to keep in the database</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        --keystore-path &lt;PATH&gt;                                   Specify custom keystore path</span></span><br><span class="line"><span class="string">        --keystore-uri &lt;keystore-uri&gt;                            Specify custom URIs to connect to for keystore-services</span></span><br><span class="line"><span class="string">        --listen-addr &lt;LISTEN_ADDR&gt;...                           Listen on this multiaddress</span></span><br><span class="line"><span class="string">    -l, --log &lt;LOG_PATTERN&gt;...</span></span><br><span class="line"><span class="string">            Sets a custom logging filter. Syntax is &lt;target&gt;=&lt;level&gt;, e.g. -lsync=debug</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        --max-parallel-downloads &lt;COUNT&gt;</span></span><br><span class="line"><span class="string">            Maximum number of peers from which to ask for the same blocks in parallel [default: 5]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        --max-runtime-instances &lt;max-runtime-instances&gt;          The size of the instances cache for each runtime</span></span><br><span class="line"><span class="string">        --name &lt;NAME&gt;                                            The human-readable name for this node</span></span><br><span class="line"><span class="string">        --node-key &lt;KEY&gt;                                         The secret key to use for libp2p networking</span></span><br><span class="line"><span class="string">        --node-key-file &lt;FILE&gt;</span></span><br><span class="line"><span class="string">            The file from which to read the node'</span>s secret key to use <span class="keyword">for</span> libp2p networking</span><br><span class="line"></span><br><span class="line">        --node-key-type &lt;TYPE&gt;</span><br><span class="line">            The <span class="built_in">type</span> of secret key to use <span class="keyword">for</span> libp2p networking [default: Ed25519]  [possible values:</span><br><span class="line">            Ed25519]</span><br><span class="line">        --out-peers &lt;COUNT&gt;</span><br><span class="line">            Specify the number of outgoing connections we<span class="string">'re trying to maintain [default: 25]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        --password &lt;password&gt;</span></span><br><span class="line"><span class="string">            Password used by the keystore. This allows appending an extra user-defined secret to the seed</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        --password-filename &lt;PATH&gt;                               File that contains the password used by the keystore</span></span><br><span class="line"><span class="string">        --pool-kbytes &lt;COUNT&gt;</span></span><br><span class="line"><span class="string">            Maximum number of kilobytes of all transactions stored in the pool [default: 20480]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        --pool-limit &lt;COUNT&gt;</span></span><br><span class="line"><span class="string">            Maximum number of transactions in the transaction pool [default: 8192]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        --port &lt;PORT&gt;                                            Specify p2p protocol TCP port</span></span><br><span class="line"><span class="string">        --prometheus-port &lt;PORT&gt;                                 Specify Prometheus exporter TCP Port</span></span><br><span class="line"><span class="string">        --pruning &lt;PRUNING_MODE&gt;</span></span><br><span class="line"><span class="string">            Specify the state pruning mode, a number of blocks to keep or '</span>archive<span class="string">'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        --public-addr &lt;PUBLIC_ADDR&gt;...</span></span><br><span class="line"><span class="string">            The public address that other nodes will use to connect to it. This can be used if there'</span>s a proxy <span class="keyword">in</span> front</span><br><span class="line">            of this node</span><br><span class="line">        --reserved-nodes &lt;ADDR&gt;...                               Specify a list of reserved node addresses</span><br><span class="line">        --rpc-cors &lt;ORIGINS&gt;</span><br><span class="line">            Specify browser Origins allowed to access the HTTP &amp; WS RPC servers</span><br><span class="line"></span><br><span class="line">        --rpc-http-threads &lt;COUNT&gt;                               Size of the RPC HTTP server thread pool</span><br><span class="line">        --rpc-max-payload &lt;rpc-max-payload&gt;</span><br><span class="line">            Set the the maximum RPC payload size <span class="keyword">for</span> both requests and responses (both http and ws), <span class="keyword">in</span> megabytes.</span><br><span class="line">            Default is 15MiB</span><br><span class="line">        --rpc-methods &lt;METHOD SET&gt;</span><br><span class="line">            RPC methods to expose. [default: Auto]  [possible values: Auto, Safe, Unsafe]</span><br><span class="line"></span><br><span class="line">        --rpc-port &lt;PORT&gt;                                        Specify HTTP RPC server TCP port</span><br><span class="line">        --state-cache-size &lt;Bytes&gt;                               Specify the state cache size [default: 67108864]</span><br><span class="line">        --sync &lt;SYNC_MODE&gt;                                       Blockchain syncing mode [default: Full]</span><br><span class="line">        --telemetry-url &lt;URL VERBOSITY&gt;...                       The URL of the telemetry server to connect to</span><br><span class="line">        --tracing-receiver &lt;RECEIVER&gt;</span><br><span class="line">            Receiver to process tracing messages [default: Log]  [possible values: Log]</span><br><span class="line"></span><br><span class="line">        --tracing-targets &lt;TARGETS&gt;</span><br><span class="line">            Sets a custom profiling filter. Syntax is the same as <span class="keyword">for</span> logging: &lt;target&gt;=&lt;level&gt;</span><br><span class="line"></span><br><span class="line">        --wasm-execution &lt;METHOD&gt;</span><br><span class="line">            Method <span class="keyword">for</span> executing Wasm runtime code [default: Compiled]  [possible values: interpreted-i-know-</span><br><span class="line">            what-i-do, compiled]</span><br><span class="line">        --wasm-runtime-overrides &lt;PATH&gt;                          Specify the path <span class="built_in">where</span> <span class="built_in">local</span> WASM runtimes are stored</span><br><span class="line">        --ws-max-connections &lt;COUNT&gt;                             Maximum number of WS RPC server connections</span><br><span class="line">        --ws-port &lt;PORT&gt;                                         Specify WebSockets RPC server TCP port</span><br><span class="line"></span><br><span class="line">SUBCOMMANDS:</span><br><span class="line">    benchmark        Benchmark runtime pallets.</span><br><span class="line">    build-spec       Build a chain specification</span><br><span class="line">    check-block      Validate blocks</span><br><span class="line">    <span class="built_in">export</span>-blocks    Export blocks</span><br><span class="line">    <span class="built_in">export</span>-state     Export the state of a given block into a chain spec</span><br><span class="line">    <span class="built_in">help</span>             Prints this message or the <span class="built_in">help</span> of the given subcommand(s)</span><br><span class="line">    import-blocks    Import blocks</span><br><span class="line">    key              Key management cli utilities</span><br><span class="line">    purge-chain      Remove the whole chain</span><br><span class="line">    revert           Revert the chain to a previous state</span><br></pre></td></tr></table></figure><br><br></details><p><br></p><h3 id="使用交互工具-apps"><a href="#使用交互工具-apps" class="headerlink" title="使用交互工具 apps"></a>使用交互工具 apps</h3><p><br></p><h4 id="方法一，使用官方的apps："><a href="#方法一，使用官方的apps：" class="headerlink" title="方法一，使用官方的apps："></a>方法一，使用官方的apps：</h4><p><a href="https://polkadot.js.org/apps/#/accounts" target="_blank" rel="noopener">https://polkadot.js.org/apps/#/accounts</a></p><p><a href="https://polkadot.js.org/apps/#/explorer" target="_blank" rel="noopener">https://polkadot.js.org/apps/#/explorer</a></p><p><img src="/2021/09/19/搭建substrate开发环境/6.png" width="100%" height="100%"></p><h4 id="方法二，-编译-安装本地的apps，安装步骤参考项目的readme文档"><a href="#方法二，-编译-安装本地的apps，安装步骤参考项目的readme文档" class="headerlink" title="方法二，(编译)安装本地的apps，安装步骤参考项目的readme文档"></a>方法二，(编译)安装本地的apps，安装步骤参考项目的readme文档</h4><p>其实是一个react的项目</p><p><a href="https://github.com/polkadot-js/apps#development" target="_blank" rel="noopener">https://github.com/polkadot-js/apps#development</a></p><p><br></p><h3 id="配置IDE"><a href="#配置IDE" class="headerlink" title="配置IDE"></a>配置IDE</h3><p><br></p><h4 id="VSCode-插件"><a href="#VSCode-插件" class="headerlink" title="VSCode 插件"></a>VSCode 插件</h4><ul><li><p>Better toml</p></li><li><p>Rust-analyzer：<a href="https://github.com/rust-analyzer/rust-analyzer" target="_blank" rel="noopener">https://github.com/rust-analyzer/rust-analyzer</a></p></li><li><p>Intellij IDEA Keybindings</p></li><li><p>Settings Sync(将配置保存到github，换机器时好同步)</p></li></ul><p><br></p><h4 id="IntelliJ-IDEA-插件："><a href="#IntelliJ-IDEA-插件：" class="headerlink" title="IntelliJ IDEA 插件："></a>IntelliJ IDEA 插件：</h4><ul><li>Rust</li></ul><p><br></p><h3 id="国内资源加速-crates-io"><a href="#国内资源加速-crates-io" class="headerlink" title="国内资源加速 crates.io"></a>国内资源加速 crates.io</h3><p><br></p><p><a href="https://mirrors.ustc.edu.cn/help/crates.io-index.html" target="_blank" rel="noopener">中科大Rust crates源</a>，修改 ~/.cargo/config;</p><p>（之前没有设置过，则需新建config文件）</p><p>修改如下：</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[source.crates-io]</span><br><span class="line">registry = <span class="string">"https://github.com/rust-lang/crates.io-index"</span></span><br><span class="line">replace-with = <span class="symbol">'ustc</span>'</span><br><span class="line"></span><br><span class="line">[source.ustc]</span><br><span class="line">registry = <span class="string">"git://mirrors.ustc.edu.cn/crates.io-index"</span></span><br></pre></td></tr></table></figure><p><br></p><h3 id="国内资源加速Github"><a href="#国内资源加速Github" class="headerlink" title="国内资源加速Github"></a>国内资源加速Github</h3><p><br></p><p>方法一： 使用代理</p><ul><li>Shadowsocks，通过https协议拉取最新代码</li></ul><p>方法二： 将Github的代码仓库映射到国内的代码托管网站</p><ul><li>如gitee.com</li></ul><p><br></p><p><a href="https://substrate.dev/docs/zh-CN/" target="_blank" rel="noopener">文档参见</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/2021/09/19/搭建substrate开发环境/-1.png&quot; width=&quot;100%&quot; height=&quot;100%&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;h3 id=&quot;安装Substrate依赖&quot;&gt;&lt;a href=&quot;#安装Substrate依赖&quot;
      
    
    </summary>
    
    
      <category term="Rust" scheme="http://www.dashen.tech/tags/Rust/"/>
    
  </entry>
  
  <entry>
    <title>使用Selenium获取网站信息</title>
    <link href="http://www.dashen.tech/2021/09/18/%E4%BD%BF%E7%94%A8Selenium%E8%8E%B7%E5%8F%96%E7%BD%91%E7%AB%99%E4%BF%A1%E6%81%AF/"/>
    <id>http://www.dashen.tech/2021/09/18/使用Selenium获取网站信息/</id>
    <published>2021-09-18T13:36:16.000Z</published>
    <updated>2021-09-19T10:13:17.000Z</updated>
    
    <content type="html"><![CDATA[<p>想要爬取<a href="https://www.mingyantong.com/" target="_blank" rel="noopener">这个网站</a>的内容，先使用了Chrome<a href="https://sspai.com/post/55496" target="_blank" rel="noopener">Web Scraper插件</a> 的Element Click功能<a href="https://sspai.com/post/56718" target="_blank" rel="noopener">来获取分页数据</a>,但发现几次请求后就出现错误。</p><p>使用Go实现了该功能，获取每一页html内容，而后通过字符串匹配得到想要的信息，但发现这个网站会封禁IP&amp;对内容加盐…</p><p>不想折腾IP代理池，而直接使用 WEB自动化工具 <em>Selenium</em>,早前就见到过测试同学有使用，正好借此契机，也体验一下。</p><p>Selenium对Firefox支持较好。</p><p>另需要安装所用系统对应的<a href="https://github.com/mozilla/geckodriver/releases" target="_blank" rel="noopener">geckodriver</a>来驱动Firefox。将解压后的二进制文件所在的位置加到系统路径下。</p><p><code>juzi.py</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># !/usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_content</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line">        url = <span class="string">"https://www.mingyantong.com/writer/%E5%BC%A0%E7%88%B1%E7%8E%B2?page=&#123;&#125;"</span>.format(i)</span><br><span class="line"></span><br><span class="line">        browser = webdriver.Firefox()</span><br><span class="line">        browser.get(url)</span><br><span class="line"></span><br><span class="line">        html = browser.page_source</span><br><span class="line">        html = etree.HTML(html, etree.HTMLParser())</span><br><span class="line">        juzi_list = html.xpath(<span class="string">'//div[@class="view-content"]//div'</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> juzi <span class="keyword">in</span> juzi_list:</span><br><span class="line">            content = juzi.xpath(<span class="string">'./div/div/a[@class = "xlistju"]/text()'</span>)</span><br><span class="line"></span><br><span class="line">            author = juzi.xpath(<span class="string">'./div/div[@class="xqjulistwafo"]/a/text()'</span>)</span><br><span class="line"></span><br><span class="line">            book = juzi.xpath(<span class="string">'./div/div[@class="xqjulistwafo"]/span/a/text()'</span>)</span><br><span class="line"></span><br><span class="line">            all_content = &#123;</span><br><span class="line">                <span class="string">"content"</span>: content,</span><br><span class="line">                <span class="string">"author"</span>: author,</span><br><span class="line">                <span class="string">"book"</span>: book,</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (content == [] <span class="keyword">and</span> author == [] <span class="keyword">and</span> book == []):</span><br><span class="line">            <span class="comment">#print(content,author,book)</span></span><br><span class="line">            <span class="comment">#print(all_content)</span></span><br><span class="line">            <span class="keyword">if</span> len(book) == <span class="number">0</span> :</span><br><span class="line">                print(content[<span class="number">0</span>])</span><br><span class="line">                print()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(content[<span class="number">0</span>] + <span class="string">"---&lt;"</span> + book[<span class="number">0</span>] + <span class="string">"&gt;"</span>)</span><br><span class="line">                print()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    get_content()</span><br></pre></td></tr></table></figure></p><p>调整页码，执行<code>python3 juzi.py &gt; result.txt</code>即可~</p><p><br></p><p><img src="/2021/09/18/使用Selenium获取网站信息/0.png" width="100%" height="100%"></p><p>注: 请求频率太快，也会被该网站的防爬策略识别并封禁。建议增加适当的time.Sleep</p><p><br></p><hr><p><br></p><p>若使用<code>browser = webdriver.Chrome()</code>，需安装Chrome的驱动，<br>方法如下：</p><p><a href="https://blog.csdn.net/weixin_44318830/article/details/103339273" target="_blank" rel="noopener">解决selenium.common.exceptions.WebDriverException: Message: ‘chromedriver‘</a></p><p><img src="/2021/09/18/使用Selenium获取网站信息/1.png" width="100%" height="100%"></p><p><img src="/2021/09/18/使用Selenium获取网站信息/2.png" width="100%" height="100%"></p><p><br></p><p>关于selenium，更多操作可参考</p><p><a href="https://www.cnblogs.com/saryli/p/5182811.html" target="_blank" rel="noopener">python selenium –browser 操作</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;想要爬取&lt;a href=&quot;https://www.mingyantong.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;这个网站&lt;/a&gt;的内容，先使用了Chrome&lt;a href=&quot;https://sspai.com/post/55496&quot; ta
      
    
    </summary>
    
    
      <category term="Tools" scheme="http://www.dashen.tech/tags/Tools/"/>
    
  </entry>
  
</feed>
